Array.prototype.remove=function(c,b){var a=this.slice((b||c)+1||this.length);this.length=c<0?this.length+c:c;return this.push.apply(this,a)};if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}if(!String.prototype.endsWith){String.prototype.endsWith=function(a){return this.indexOf(a,this.length-a.length)!==-1}}function GenericObject(){this.classname="GenericObject"}GenericObject.prototype.SEMICOLON=";";GenericObject.prototype.COLON=":";GenericObject.prototype.COMMA=",";GenericObject.prototype.SLASH="/";GenericObject.prototype.SP=" ";GenericObject.prototype.EQUALS="=";GenericObject.prototype.STAR="*";GenericObject.prototype.NEWLINE="\r\n";GenericObject.prototype.RETURN="\n";GenericObject.prototype.LESS_THAN="<";GenericObject.prototype.GREATER_THAN=">";GenericObject.prototype.AT="@";GenericObject.prototype.DOT=".";GenericObject.prototype.QUESTION="?";GenericObject.prototype.POUND="#";GenericObject.prototype.AND="&";GenericObject.prototype.LPAREN="(";GenericObject.prototype.RPAREN=")";GenericObject.prototype.DOUBLE_QUOTE='"';GenericObject.prototype.QUOTE="'";GenericObject.prototype.HT="\t";GenericObject.prototype.PERCENT="%";GenericObject.prototype.getClassFromName=function(b){function c(d){return new Function("return new "+d)()}var a=c(b);return a};GenericObject.prototype.isMySubclass=function(a){if((typeof a)!="object"||a instanceof Array){return false}else{var b=0;if(Object.getPrototypeOf(a).classname=="GenericObject"){return true}else{O=Object.getPrototypeOf(a);for(;O.classname!=undefined;){if(Object.getPrototypeOf(O).classname=="GenericObject"){b=1;O=Object.getPrototypeOf(O)}else{O=Object.getPrototypeOf(O)}}if(b==1){return true}else{return false}}}};GenericObject.prototype.encode=function(a){return a+this.encode()};GenericObject.prototype.equals=function(a){};GenericObject.prototype.match=function(a){};GenericObject.prototype.merge=function(a){};GenericObject.prototype.clone=function(){var b;if(this.constructor==Object){b=new this.constructor()}else{b=new this.constructor(this.valueOf())}for(var a in this){if(b[a]!=this[a]){if(typeof(this[a])=="object"){b[a]=this[a].clone()}else{b[a]=this[a]}}}b.toString=this.toString;b.valueOf=this.valueOf;return b};function GenericObjectList(){this.classname="GenericObjectList"}GenericObjectList.prototype.isMySubclass=function(a){if((typeof a)!="object"||a instanceof Array){return false}else{var b=0;if(Object.getPrototypeOf(a).classname=="GenericObjectList"){return true}else{O=Object.getPrototypeOf(a);for(;O.classname!=undefined;){if(Object.getPrototypeOf(O).classname=="GenericObjectList"){b=1;O=Object.getPrototypeOf(O)}else{O=Object.getPrototypeOf(O)}}if(b==1){return true}else{return false}}}};function NameValue(c,b,a){this.classname="NameValue";this.isQuotedString=null;this.isFlagParameter=a;this.separator=this.EQUALS;this.quotes="";this.name=c;this.value=b;if(c==null){this.name=null}if(b==null){this.value=null}if(a==null){this.isFlagParameter=false}}NameValue.prototype=new GenericObject();NameValue.prototype.constructor=NameValue;NameValue.prototype.EQUALS="=";NameValue.prototype.DOUBLE_QUOTE='"';NameValue.prototype.setSeparator=function(a){this.separator=a};NameValue.prototype.setQuotedValue=function(){this.isQuotedString=true;this.quotes=this.DOUBLE_QUOTE};NameValue.prototype.isValueQuoted=function(){return this.isQuotedString};NameValue.prototype.getName=function(){return this.name};NameValue.prototype.getValueAsObject=function(){return this.isFlagParameter?"":this.value};NameValue.prototype.setName=function(a){this.name=a};NameValue.prototype.setValueAsObject=function(a){this.value=a};NameValue.prototype.encode=function(){return this.encodeBuffer("").toString()};NameValue.prototype.encodeBuffer=function(a){var b=new GenericObject();var c=new GenericObjectList();if(this.name!=null&&this.value!=null&&!this.isFlagParameter){if(b.isMySubclass(this.value)){a=a+this.name+this.separator+this.quotes;a=this.value.encodeBuffer(a);a=a+this.quotes;return a}else{if(c.isMySubclass(this.value)){a=a+this.name+this.separator+this.value.encode();return a}else{if(this.value.toString().length==0){if(this.isQuotedString){a=a+this.name+this.separator+this.quotes+this.quotes;return a}else{if(this.name=="lr"){a=a+this.name;return a}else{a=a+this.name+this.separator;return a}}}else{a=a+this.name+this.separator+this.quotes+this.value.toString()+this.quotes;return a}}}}else{if(this.name==null&&this.value!=null){if(b.isMySubclass(this.value)){this.value.encodeBuffer(a);return a}else{if(c.isMySubclass(this.value)){a=a+this.value.encode();return a}else{a=a+this.quotes+this.value.toString()+this.quotes;return a}}}else{if(this.name!=null&&(this.value==null||this.isFlagParameter)){a=a+this.name;return a}else{return a}}}};NameValue.prototype.equals=function(a){if(a==null){return false}if(a.classname!=this.classname){return false}var b=a;if(this==b){return true}if(this.name==null&&b.name!=null||this.name!=null&&b.name==null){return false}if(this.name!=null&&b.name!=null&&this.name.compareToIgnoreCase(b.name)!=0){return false}if(this.value!=null&&b.value==null||this.value==null&&b.value!=null){return false}if(this.value==b.value){return true}if(this.value instanceof String){if(this.isQuotedString){if(this.value==b.value){return true}else{return false}}var d=this.value;var c=b.value;if(d.toLowerCase()==c.toLowerCase()){return true}else{return false}}else{if(this.value==b.value){return true}else{return false}}};NameValue.prototype.getKey=function(){return this.name};NameValue.prototype.getValue=function(){return this.value==null?null:this.value.toString()};NameValue.prototype.setValue=function(b){var a=this.value==null?null:b;this.value=b;return a};NameValue.prototype.hashCode=function(){var d=0;var a=this.encode().toLowerCase();if(!(a==null||a.value=="")){for(var b=0;b<a.length;b++){d=d*31+a.charCodeAt(b);var c=2147483647;var e=-2147483648;if(d>c||d<e){d&=4294967295}}}return d};function NameValueList(a){this.classname="NameValueList";this.hmap=new Array();this.separator=";"}NameValueList.prototype.setSeparator=function(a){this.separator=a};NameValueList.prototype.encode=function(){return this.encodeBuffer("").toString()};NameValueList.prototype.encodeBuffer=function(a){if(this.hmap.length!=0){for(var b=0;b<this.hmap.length;b++){var d=this.hmap[b][1];if(d instanceof GenericObject){var c=d;a=c.encodeBuffer(a)}else{a=a+d.toString()}if(b!=this.hmap.length-1){a=a+this.separator}}}return a};NameValueList.prototype.toString=function(){return this.encode()};NameValueList.prototype.set_nv=function(b){var g=0;for(var e=0;e<this.hmap.length;e++){var d=this.hmap[e][0];if(d==b.getName().toLowerCase()){g=1;var a=new Array();a[0]=d;a[1]=b;this.hmap[e]=a}}if(g==0){var f=this.hmap.length;a=new Array();a[0]=b.getName().toLowerCase();a[1]=b;this.hmap[f]=a}};NameValueList.prototype.set_name_value=function(d,g){var b=new NameValue(d,g);d=d.toLowerCase();g=b;var j=0;for(var f=0;f<this.hmap.length;f++){var e=this.hmap[f][0];if(e==d.toLowerCase()){j=1;var a=new Array();a[0]=e;a[1]=g;this.hmap[f]=a}}if(j==0){var h=this.hmap.length;a=new Array();a[0]=d.toLowerCase();a[1]=g;this.hmap[h]=a}};NameValueList.prototype.equals=function(e){if(e==null){return false}if(e.classname!=this.classname){return false}var a=e;if(this.hmap.length!=a.hmap.length){return false}var d=new Array();var h=0;for(var b=0;b<this.hmap.length;b++){d[h]=this.hmap[b][0];h++}for(b=0;b<d.length;b++){var g=new NameValue();var f=new NameValue();g=this.getNameValue(d[b]);f=a.getNameValue(d[b]);if(f==null){return false}else{if(!f.equals(g)){return false}}}return true};NameValueList.prototype.getValue=function(b){var a=new NameValue();a=this.getNameValue(b.toLowerCase());if(a!=null){return a.getValueAsObject()}else{return null}};NameValueList.prototype.getNameValue=function(b){var a=null;for(var c=0;c<this.hmap.length;c++){if(b.toLowerCase()==this.hmap[c][0]){a=this.hmap[c][1]}}return a};NameValueList.prototype.hasNameValue=function(a){var d=0;for(var b=0;b<this.hmap.length;b++){if(a.toLowerCase()==this.hmap[b][0]){d=1}}if(d==1){return true}else{return false}};NameValueList.prototype.delet=function(a){var e=0;var d=0;for(var b=0;b<this.hmap.length;b++){if(a.toLowerCase()==this.hmap[b][0]){e=1;d=b}}if(e==1){this.hmap.splice(d,1);return true}else{return false}};NameValueList.prototype.size=function(){return this.hmap.length};NameValueList.prototype.isEmpty=function(){if(this.hmap.length==0){return true}else{return false}};NameValueList.prototype.iterator=function(){return this.hmap};NameValueList.prototype.getNames=function(){var b=new Array();var d=0;for(var a=0;a<this.hmap.length;a++){b[d]=this.hmap[a][0];d++}if(b.length!=0){return b}else{return null}};NameValueList.prototype.getParameter=function(a){var b=this.getValue(a);if(b==null){return null}if(b instanceof GenericObject){return b.encode()}else{return b.toString()}};NameValueList.prototype.clear=function(){this.hmap=null};NameValueList.prototype.containsKey=function(b){var d=0;for(var a=0;a<this.hmap.length;a++){if(this.hmap[a][0]==b.toString().toLowerCase()){d=1}}if(d==1){return true}else{return false}};NameValueList.prototype.containsValue=function(b){var d=0;for(var a=0;a<this.hmap.length;a++){if(this.hmap[a][1]==b){d=1}}if(d==1){return true}else{return false}};NameValueList.prototype.entrySet=function(){return this.hmap};NameValueList.prototype.get=function(b){var a=new NameValue();a=this.getNameValue(b.toString().toLowerCase());if(a!=null){return a.getValueAsObject()}else{return null}};NameValueList.prototype.keySet=function(){var b=new Array();var d=0;for(var a=0;a<this.hmap.length;a++){b[d]=this.hmap[a][0];d++}return b};NameValueList.prototype.put=function(d,b){var c=new NameValue();var g=0;for(var f=0;f<this.hmap.length;f++){var e=this.hmap[f][0];if(e==d){g=1;c=this.hmap[f][1];var a=new Array();a[0]=d;a[1]=b;this.hmap[f]=a}}if(g!=0){return c}else{return null}};NameValueList.prototype.putAll=function(b){for(var a=0;a<b.length;a++){this.put(b[a][0],b[a][1])}};NameValueList.prototype.remove=function(d){var f=0;var e=0;var a=new NameValue();for(var b=0;b<this.hmap.length;b++){if(d.toString().toLowerCase()==this.hmap[b][0]){f=1;e=b}}if(f==1){a=this.hmap[e][1];this.hmap.splice(e,1);return a}else{return null}};NameValueList.prototype.values=function(){var a=new Array();var d=0;for(var b=0;b<this.hmap.length;b++){a[d]=this.hmap[b][1];d++}return a};NameValueList.prototype.hashCode=function(){var d=0;var a=this.keySet();if(!(a==null||a.value=="")){for(var b=0;b<a.length;b++){d=d*31+a.charCodeAt(b);var c=2147483647;var e=-2147483648;if(d>c||d<e){d&=4294967295}}}return d};function DuplicateNameValueList(){this.classname="DuplicateNameValueList";this.nameValueMap=new Array();this.separator=";"}DuplicateNameValueList.prototype.setSeparator=function(a){this.separator=a};DuplicateNameValueList.prototype.encode=function(){return this.encodeBuffer("").toString()};DuplicateNameValueList.prototype.encodeBuffer=function(a){if(this.nameValueMap.length!=0){for(var c=0;c<this.nameValueMap.length;c++){var e=this.nameValueMap[c][1];for(var b=0;b<this.nameValueMap[c][1].length;b++){e=this.nameValueMap[c][1][b];if(e instanceof GenericObject){var d=e;a=d.encodeBuffer(a)}else{a=a+e.toString()}if(c!=this.nameValueMap.length-1){a=a+this.separator}}}}return a};DuplicateNameValueList.prototype.toString=function(){return this.encode()};DuplicateNameValueList.prototype.set_nv=function(f){var a=null;var b=0;for(var d=0;d<this.nameValueMap.length;d++){var j=this.nameValueMap[d][0];if(j==f.getName().toLowerCase()){a=this.nameValueMap[d][1];var k=a.length;b=1;var e=d}}if(a==null){if(b==1){a=new Array();a[0]=f;this.nameValueMap[e][1]=a}else{var g=this.nameValueMap.length;a=new Array();var h=new Array();h[0]=f.getName().toLowerCase();h[1]=a;this.nameValueMap[g]=h;k=0;e=g}}a[k]=f;this.nameValueMap[e][1]=a};DuplicateNameValueList.prototype.set_name_value=function(a,k){var g=new NameValue(a,k);var b=null;var d=0;for(var e=0;e<this.nameValueMap.length;e++){var l=this.nameValueMap[e][0];if(l==g.getName().toLowerCase()){b=this.nameValueMap[e][1];var m=b.length;d=1;var f=e}}if(b==null){if(d==1){b=new Array();b[0]=g;this.nameValueMap[f][1]=b}else{var h=this.nameValueMap.length;b=new Array();var j=new Array();j[0]=g.getName().toLowerCase();j[1]=b;this.nameValueMap[h]=j;m=0;f=h}}b[m]=g;this.nameValueMap[f][1]=b};DuplicateNameValueList.prototype.equals=function(d){if(d==null){return false}if(d.classname==this.classname){return false}var a=d;if(this.nameValueMap.length!=a.nameValueMap.length){return false}for(var c;c<this.nameValueMap.length;c++){var b=this.nameValueMap[c][0];var f=this.getNameValue(b);var e=a.nameValueMap.get(b);if(e==null){return false}else{if(e!=f){return false}}}return true};DuplicateNameValueList.prototype.getValue=function(b){var a=this.getNameValue(b.toLowerCase());if(a!=null){return a}else{return null}};DuplicateNameValueList.prototype.getNameValue=function(b){var a=new Array();for(var d=0;d<this.nameValueMap.length;d++){var c=this.nameValueMap[d][0];if(c==b){a=this.nameValueMap[d][1]}}return a};DuplicateNameValueList.prototype.hasNameValue=function(a){var d=0;for(var c=0;c<this.nameValueMap.length;c++){var b=this.nameValueMap[c][0];if(b==a.toLowerCase()){d=1}}if(d==1){return true}else{return false}};DuplicateNameValueList.prototype.delet=function(a){var e=a.toLowerCase();var d=0;var f=0;for(var c=0;c<this.nameValueMap.length;c++){var b=this.nameValueMap[c][0];if(b==e){d=1;f=c}}if(d==1){this.nameValueMap.splice(f,1);return true}else{return false}};DuplicateNameValueList.prototype.iterator=function(){return this.nameValueMap};DuplicateNameValueList.prototype.getNames=function(){var b=new Array();var d=0;for(var a=0;a<this.nameValueMap.length;a++){b[d]=this.nameValueMap[a][0];d++}if(b.length!=0){return b}else{return null}};DuplicateNameValueList.prototype.getParameter=function(b){var d=this.getValue(b);if(d==null){return null}var a="";for(var c=0;c<d.length;c++){if(d[c] instanceof GenericObject){a=a+d[c].encode()}else{a=a+d[c].toString()}if(c!=d.length-1){a=a+";  "}}return a};DuplicateNameValueList.prototype.clear=function(){this.nameValueMap=new Array()};DuplicateNameValueList.prototype.isEmpty=function(){if(this.nameValueMap.length!=0){return true}else{return false}};DuplicateNameValueList.prototype.put=function(e,f){var c=new NameValue();var g=0;for(var d=0;d<this.nameValueMap.length;d++){var b=this.nameValueMap[d][0];if(b==e){g=1;c=this.nameValueMap[d][1];var a=new Array();a[0]=e;a[1]=f;this.nameValueMap[d]=a}}if(g!=0){return c}else{return null}};DuplicateNameValueList.prototype.remove=function(d){var f=0;var e=0;var a=new NameValue();for(var b=0;b<this.nameValueMap.length;b++){if(d.toString().toLowerCase()==this.nameValueMap[b][0]){f=1;e=b}}if(f==1){a=this.nameValueMap[e][1];this.nameValueMap.splice(e,1);return a}else{return null}};DuplicateNameValueList.prototype.size=function(){var b=0;for(var a=0;a<this.nameValueMap.length;a++){b=b+this.nameValueMap[a][1].length}return b};DuplicateNameValueList.prototype.values=function(){var a=new Array();var d=0;for(var b=0;b<this.nameValueMap.length;b++){a[d]=this.nameValueMap[b][1];d++}return a};DuplicateNameValueList.prototype.hashCode=function(){var f=0;var d=new Array();var h=0;for(var b=0;b<this.nameValueMap.length;b++){d[h]=this.nameValueMap[b][0];h++}var a=d;if(!(a==null||a.value=="")){for(b=0;b<a.length;b++){f=f*31+a.charCodeAt(b);var e=2147483647;var g=-2147483648;if(f>e||f<g){f&=4294967295}}}return f};function HostPort(){this.classname="HostPort";this.port=-1;this.host=new Host()}HostPort.prototype=new GenericObject();HostPort.prototype.constructor=HostPort;HostPort.prototype.COLON=":";HostPort.prototype.encode=function(){return this.encodeBuffer("")};HostPort.prototype.encodeBuffer=function(a){a=this.host.encodeBuffer(a);if(this.port!=-1){a=a+this.COLON+this.port}return a};HostPort.prototype.equals=function(a){if(a==null){return false}if(this.classname!=a.classname){return false}var b=a;if(this.port==b.port&&this.host.equals(b.host)){return true}else{return false}};HostPort.prototype.getHost=function(){return this.host};HostPort.prototype.getPort=function(){return this.port};HostPort.prototype.hasPort=function(){if(this.port!=-1){return true}else{return false}};HostPort.prototype.removePort=function(){this.port=-1};HostPort.prototype.setHost=function(a){this.host=a};HostPort.prototype.setPort=function(a){this.port=a};HostPort.prototype.getInetAddress=function(){if(this.host==null){return null}else{return this.host.getInetAddress()}};HostPort.prototype.merge=function(a){var b=new GenericObject();b.merge(a);if(this.port==-1){this.port=a.port}};HostPort.prototype.toString=function(){return this.encode()};HostPort.prototype.hashCode=function(){return this.host.hashCode()+this.port};function Host(b,a){this.stripAddressScopeZones=false;this.hostname=null;this.addressType=null;this.inetAddress=null;this.classname="Host";if(b==null&&a==null){this.addressType=this.HOSTNAME}else{if(a==null&&b!=null){this.setHost(b,this.IPV4ADDRESS)}else{this.setHost(b,a)}}}Host.prototype=new GenericObject();Host.prototype.constructor=Host;Host.prototype.HOSTNAME=1;Host.prototype.IPV4ADDRESS=2;Host.prototype.IPV6ADDRESS=3;Host.prototype.encode=function(){return this.encodeBuffer("").toString()};Host.prototype.encodeBuffer=function(a){var b=null;if(this.addressType==this.IPV6ADDRESS&&!this.isIPv6Reference(this.hostname)){b=a+"["+this.hostname+"]"}else{b=a+this.hostname}return b};Host.prototype.equals=function(a){if(a==null){return false}if(this.classname!=a.classname){return false}if(a.hostname==this.hostname){return true}else{return false}};Host.prototype.getHostname=function(){return this.hostname};Host.prototype.getAddress=function(){return this.hostname};Host.prototype.getIpAddress=function(){var a=null;if(this.hostname==null){return null}if(this.addressType==this.HOSTNAME){if(this.inetAddress==null){}}else{a=this.hostname}return a};Host.prototype.setHostname=function(a){this.setHost(a,this.HOSTNAME)};Host.prototype.setHostAddress=function(a){this.setHost(a,this.IPV4ADDRESS)};Host.prototype.setHost=function(c,b){this.inetAddress=null;if(b==null){b=2}if(this.isIPv6Address(c)){this.addressType=this.IPV6ADDRESS}else{this.addressType=b}if(c!=null){this.hostname=c.trim();if(this.addressType==this.HOSTNAME){this.hostname=this.hostname.toLowerCase()}var a=-1;if(this.addressType==this.IPV6ADDRESS&&this.stripAddressScopeZones&&(a=this.hostname.indexOf("%"))!=-1){this.hostname=this.hostname.substring(0,a)}}};Host.prototype.setAddress=function(a){this.setHostAddress(a)};Host.prototype.isHostname=function(){if(this.addressType==this.HOSTNAME){return true}else{return false}};Host.prototype.isIPAddress=function(){if(this.addressType!=this.HOSTNAME){return true}else{return false}};Host.prototype.getInetAddress=function(){if(this.hostname==null){return null}if(this.inetAddress!=null){return this.inetAddress}return this.inetAddress};Host.prototype.isIPv6Address=function(a){if(a!=null&&a.indexOf(":")!=-1){return true}else{return false}};Host.prototype.isIPv6Reference=function(a){if(a.charAt(0)=="["&&a.charAt(a.length()-1)=="]"){return true}else{return false}};Host.prototype.hashCode=function(){var d=0;var a=this.getHostname();if(!(a==null||a.value=="")){for(var b=0;b<a.length;b++){d=d*31+a.charCodeAt(b);var c=2147483647;var e=-2147483648;if(d>c||d<e){d&=4294967295}}}return d};function Token(){this.classname="Token";this.tokenValue=null;this.tokenType=null}Token.prototype.getTokenValue=function(){return this.tokenValue};Token.prototype.getTokenType=function(){return this.tokenType};Token.prototype.toString=function(){return"tokenValue = "+this.tokenValue+"/tokenType = "+this.tokenType};function StringTokenizer(a){this.classname="StringTokenizer";this.buffer=null;this.bufferLen=null;this.ptr=null;this.savedPtr=null;if(a!=null){this.buffer=a;this.bufferLen=a.length;this.ptr=0}}StringTokenizer.prototype.nextToken=function(){var a=this.ptr;while(this.ptr<this.bufferLen){var b=this.buffer.charAt(this.ptr);this.ptr++;if(b=="\n"){break}}return this.buffer.substring(a,this.ptr)};StringTokenizer.prototype.hasMoreChars=function(){if(this.ptr<this.bufferLen&&this.buffer.charAt(this.ptr)!="\r"){return true}else{return false}};StringTokenizer.prototype.isHexDigit=function(a){if((a>="A"&&a<="F")||(a>="a"&&a<="f")||this.isDigit(a)){return true}else{return false}};StringTokenizer.prototype.isAlpha=function(a){if(a.charCodeAt(0)<=127){if((a>="a"&&a<="z")||(a>="A"&&a<="Z")){return true}else{return false}}else{if(a==a.toLowerCase()||a==a.toUpperCase()){return true}else{return false}}};StringTokenizer.prototype.isDigit=function(a){if(a.charCodeAt(0)<=127){if(a<="9"&&a>="0"){return true}else{return false}}else{if(typeof a=="number"){return true}else{return false}}};StringTokenizer.prototype.isAlphaDigit=function(a){if(a.charCodeAt(0)<=127){if((a>="a"&&a<="z")||(a>="A"&&a<="Z")||(a<="9"&&a>="0")){return true}else{return false}}else{if((a==a.toLowerCase())||(a==a.toUpperCase())||(typeof a=="number")){return true}else{return false}}};StringTokenizer.prototype.getLine=function(){var a=this.ptr;while(this.ptr<this.bufferLen&&this.buffer.charAt(this.ptr)!="\n"){this.ptr++}if(this.ptr<this.bufferLen&&this.buffer.charAt(this.ptr)=="\n"){this.ptr++}return this.buffer.substring(a,this.ptr)};StringTokenizer.prototype.peekLine=function(){var b=this.ptr;var a=this.getLine();this.ptr=b;return a};StringTokenizer.prototype.lookAhead=function(a){if(a==null){a=0}return this.buffer.charAt(this.ptr+a)};StringTokenizer.prototype.getNextChar=function(){if(this.ptr>=this.bufferLen){console.error("StringTokenizer:getNextChar(): end of buffer:"+this.ptr);throw"StringTokenizer:getNextChar(): end of buffer"}else{return this.buffer.charAt(this.ptr++)}};StringTokenizer.prototype.consume=function(a){if(a==null){this.ptr=this.savedPtr}else{this.ptr+=a}};StringTokenizer.prototype.getLines=function(){var a=new Array();while(this.hasMoreChars()){var b=this.getLine();a.push(b)}return a};StringTokenizer.prototype.getNextToken=function(c){var a=this.ptr;while(true){var b=this.lookAhead(0);if(b==c){break}else{if(b==""){console.error("StringTokenizer:getNextToken(): EOL reached");throw"StringTokenizer:getNextToken(): EOL reached"}}this.consume(1)}return this.buffer.substring(a,this.ptr)};StringTokenizer.prototype.getSDPFieldName=function(a){if(a==null){return null}var c=null;var b=a.indexOf("=");c=a.substring(0,b);return c};function LexerCore(){this.classname="LexerCore";this.globalSymbolTable=new Array();this.lexerTables=new Array();this.currentLexer=null;this.currentLexerName=null;this.currentMatch=new Token();if(arguments.length==0){this.currentLexer=new Array();this.currentLexerName="charLexer"}else{var b=arguments[0];var a=arguments[1];this.buffer=a;this.bufferLen=a.length;this.ptr=0;this.currentLexer=new Array();this.currentLexerName=b}}LexerCore.prototype=new StringTokenizer();LexerCore.prototype.constructor=LexerCore;LexerCore.prototype.START=2048;LexerCore.prototype.END=LexerCore.prototype.START+2048;LexerCore.prototype.ID=LexerCore.prototype.END-1;LexerCore.prototype.SAFE=LexerCore.prototype.END-2;LexerCore.prototype.ID_NO_WHITESPACE=LexerCore.prototype.END-3;LexerCore.prototype.WHITESPACE=LexerCore.prototype.END+1;LexerCore.prototype.DIGIT=LexerCore.prototype.END+2;LexerCore.prototype.ALPHA=LexerCore.prototype.END+3;LexerCore.prototype.BACKSLASH="\\".charCodeAt(0);LexerCore.prototype.QUOTE="'".charCodeAt(0);LexerCore.prototype.AT="@".charCodeAt(0);LexerCore.prototype.SP=" ".charCodeAt(0);LexerCore.prototype.HT="\t".charCodeAt(0);LexerCore.prototype.COLON=":".charCodeAt(0);LexerCore.prototype.STAR="*".charCodeAt(0);LexerCore.prototype.DOLLAR="$".charCodeAt(0);LexerCore.prototype.PLUS="+".charCodeAt(0);LexerCore.prototype.POUND="#".charCodeAt(0);LexerCore.prototype.MINUS="-".charCodeAt(0);LexerCore.prototype.DOUBLEQUOTE='"'.charCodeAt(0);LexerCore.prototype.TILDE="~".charCodeAt(0);LexerCore.prototype.BACK_QUOTE="`".charCodeAt(0);LexerCore.prototype.NULL="\0".charCodeAt(0);LexerCore.prototype.EQUALS="=".charCodeAt(0);LexerCore.prototype.SEMICOLON=";".charCodeAt(0);LexerCore.prototype.SLASH="/".charCodeAt(0);LexerCore.prototype.L_SQUARE_BRACKET="[".charCodeAt(0);LexerCore.prototype.R_SQUARE_BRACKET="]".charCodeAt(0);LexerCore.prototype.R_CURLY="}".charCodeAt(0);LexerCore.prototype.L_CURLY="{".charCodeAt(0);LexerCore.prototype.HAT="^".charCodeAt(0);LexerCore.prototype.BAR="|".charCodeAt(0);LexerCore.prototype.DOT=".".charCodeAt(0);LexerCore.prototype.EXCLAMATION="!".charCodeAt(0);LexerCore.prototype.LPAREN="(".charCodeAt(0);LexerCore.prototype.RPAREN=")".charCodeAt(0);LexerCore.prototype.GREATER_THAN=">".charCodeAt(0);LexerCore.prototype.LESS_THAN="<".charCodeAt(0);LexerCore.prototype.PERCENT="%".charCodeAt(0);LexerCore.prototype.QUESTION="?".charCodeAt(0);LexerCore.prototype.AND="&".charCodeAt(0);LexerCore.prototype.UNDERSCORE="_".charCodeAt(0);LexerCore.prototype.ALPHA_VALID_CHARS=String.fromCharCode(65535);LexerCore.prototype.DIGIT_VALID_CHARS=String.fromCharCode(65534);LexerCore.prototype.ALPHADIGIT_VALID_CHARS=String.fromCharCode(65533);LexerCore.prototype.addKeyword=function(b,d){var e=d;this.currentLexer=this.put(this.currentLexer,b,e);var a=null;for(var c=0;c<this.globalSymbolTable.length;c++){if(this.globalSymbolTable[c]==e){a=0}}if(a==null){this.globalSymbolTable=this.put(this.globalSymbolTable,e,b)}};LexerCore.prototype.lookupToken=function(c){var a=null;if(c>this.START){for(var b=0;b<this.globalSymbolTable.length;b++){if(this.globalSymbolTable[b][0]==c){a=this.globalSymbolTable[b][1]}}return a}else{return c}};LexerCore.prototype.addLexer=function(c){var a=null;for(var b=0;b<this.lexerTables.length;b++){if(this.lexerTables[b][0]==c){a=this.lexerTables[b][1]}}this.currentLexer=a;if(this.currentLexer==null){this.currentLexer=new Array();this.lexerTables=this.put(this.lexerTables,c,this.currentLexer)}return this.currentLexer};LexerCore.prototype.selectLexer=function(a){this.currentLexerName=a};LexerCore.prototype.peekNextId=function(){var b=this.ptr;var a=this.ttoken();this.savedPtr=this.ptr;this.ptr=b;return a};LexerCore.prototype.getNextId=function(){return this.ttoken()};LexerCore.prototype.getNextToken=function(){if(arguments.length!=0){var c=arguments[0];var a=this.ptr;while(this.hasMoreChars()){var b=this.lookAhead(0);if(b==c){break}else{if(b==""){console.error("LexerCore:getNextToken(): EOL reached");throw"LexerCore:getNextToken(): EOL reached"}}this.consume(1)}return this.buffer.substring(a,this.ptr)}else{return this.currentMatch}};LexerCore.prototype.peekNextToken=function(k){if(k==null){k=1;return this.peekNextToken(k)[0]}else{var e=this.ptr;var c=new Array();for(var h=0;h<k;h++){var n=new Token();if(this.startsId()){var b=this.ttoken();n.tokenValue=b;var a=b.toUpperCase();var g=null;for(var f=0;f<this.currentLexer.length;f++){if(this.currentLexer[f][0]==a){g=f}}if(g!=null){var m=this.currentLexer[g][1];n.tokenType=m}else{n.tokenType=this.ID}}else{var d=this.getNextChar();n.tokenValue=d;if(this.isAlpha(d)){n.tokenType=this.ALPHA}else{if(this.isDigit(d)){n.tokenType=this.DIGIT}else{n.tokenType=d}}}c[h]=n}this.savedPtr=this.ptr;this.ptr=e;return c}};LexerCore.prototype.match=function(b){if(b>this.START&&b<this.END){if(b==this.ID){if(!this.startsId()){console.error("LexerCore:match(): "+this.buffer+"\nID expected",this.ptr);throw"LexerCore:match(): ID expected"}var h=this.getNextId();this.currentMatch=new Token();this.currentMatch.tokenValue=h;this.currentMatch.tokenType=this.ID}else{if(b==this.SAFE){if(!this.startsSafeToken()){console.error("LexerCore:match(): "+this.buffer+"\nID expected",this.ptr);throw"LexerCore:match(): ID expected"}h=this.ttokenSafe();this.currentMatch=new Token();this.currentMatch.tokenValue=h;this.currentMatch.tokenType=this.SAFE}else{var a=this.getNextId();var g=null;for(var c=0;c<this.currentLexer.length;c++){if(this.currentLexer[c][0]==a.toUpperCase()){g=c}}if(g==null){var f=null}else{f=this.currentLexer[g][1]}if(f==null||f!=b){console.error("LexerCore:match(): "+this.buffer+"\nUnexpected Token : "+a);throw"LexerCore:match(): unexpected Token"}this.currentMatch=new Token();this.currentMatch.tokenValue=a;this.currentMatch.tokenType=b}}}else{if(b>this.END){var e=this.lookAhead(0);if(b==this.DIGIT){if(!this.isDigit(e)){console.error("LexerCore:match(): "+this.buffer+"\nExpecting DIGIT",this.ptr);throw"LexerCore:match(): Expecting DIGIT"}this.currentMatch=new Token();this.currentMatch.tokenValue=e;this.currentMatch.tokenType=b;this.consume(1)}else{if(b==this.ALPHA){if(!this.isAlpha(e)){console.error("LexerCore:match(): "+this.buffer+"\nExpecting ALPHA",this.ptr);throw"LexerCore:match(): Expecting ALPHA"}this.currentMatch=new Token();this.currentMatch.tokenValue=e;this.currentMatch.tokenType=b;this.consume(1)}}}else{var d=b;e=this.lookAhead(0);if(e==d){this.consume(1)}else{console.error("LexerCore:match(): "+this.buffer+"\nExpecting  >>>"+d+"<<< got >>>"+e+"<<<");throw"LexerCore:match(): expecting  >>>"+d+"<<< got >>>"+e+"<<<"}}}return this.currentMatch};LexerCore.prototype.SPorHT=function(){var a=this.lookAhead(0);while(a==" "||a=="\t"){this.consume(1);a=this.lookAhead(0)}};LexerCore.prototype.isTokenChar=function(a){if(this.isAlphaDigit(a)){return true}else{switch(a){case"-":case".":case"!":case"%":case"*":case"_":case"+":case"`":case"'":case"~":return true;default:return false}}};LexerCore.prototype.startsId=function(){var a=this.lookAhead(0);return this.isTokenChar(a)};LexerCore.prototype.startsSafeToken=function(){var a=lookAhead(0);if(this.isAlphaDigit(a)){return true}else{switch(a){case"_":case"+":case"-":case"!":case"`":case"'":case".":case"/":case"}":case"{":case"]":case"[":case"^":case"|":case"~":case"%":case"#":case"@":case"$":case":":case";":case"?":case'"':case"*":case"=":return true;default:return false}}};LexerCore.prototype.ttoken=function(){var a=this.ptr;while(this.hasMoreChars()){var b=this.lookAhead(0);if(this.isTokenChar(b)){this.consume(1)}else{break}}return this.buffer.substring(a,this.ptr)};LexerCore.prototype.ttokenSafe=function(){var a=this.ptr;while(this.hasMoreChars()){var c=this.lookAhead(0);if(this.isAlphaDigit(c)){this.consume(1)}else{var b=false;switch(c){case"_":case"+":case"-":case"!":case"`":case"'":case".":case"/":case"}":case"{":case"]":case"[":case"^":case"|":case"~":case"%":case"#":case"@":case"$":case":":case";":case"?":case'"':case"*":b=true}if(b){this.consume(1)}else{break}}}return this.buffer.substring(a,this.ptr)};LexerCore.prototype.consumeValidChars=function(a){var d=a.length;while(this.hasMoreChars()){var f=this.lookAhead(0);var e=false;for(var c=0;c<d;c++){var b=a[c];switch(b){case this.ALPHA_VALID_CHARS:e=this.isAlpha(f);break;case this.DIGIT_VALID_CHARS:e=this.isDigit(f);break;case this.ALPHADIGIT_VALID_CHARS:e=this.isAlphaDigit(f);break;default:e=f==b}if(e){break}}if(e){this.consume(1)}else{break}}};LexerCore.prototype.quotedString=function(){var a=this.ptr+1;if(this.lookAhead(0)!='"'){return null}this.consume(1);while(this.hasMoreChars()){var b=this.getNextChar();if(b=='"'){break}else{if(b==""){console.error("LexerCore:quotedString(): "+this.buffer+" :unexpected EOL",this.ptr);throw"LexerCore:quotedString(): unexpected EOL"}else{if(b=="\\"){this.consume(1)}}}}return this.buffer.substring(a,this.ptr-1)};LexerCore.prototype.comment=function(){var a="";if(this.lookAhead(0)!="("){return null}this.consume(1);while(this.hasMoreChars()){var b=this.getNextChar();if(b==")"){break}else{if(b==""){console.error("LexerCore:comment(): "+this.buffer+" :unexpected EOL",this.ptr);throw"LexerCore:comment(): unexpected EOL"}else{if(b=="\\"){a=a+b;b=this.getNextChar();if(b==""){console.error("LexerCore:comment(): "+this.buffer+" :unexpected EOL",this.ptr);throw"LexerCore:comment(): unexpected EOL"}a=a+b}else{a=a+b}}}}return a.toString()};LexerCore.prototype.byteStringNoSemicolon=function(){var a="";while(this.hasMoreChars()){var b=this.lookAhead(0);if(b==""||b=="\n"||b==";"||b==","){break}else{this.consume(1);a=a+b}}return a.toString()};LexerCore.prototype.byteStringNoWhiteSpace=function(){var a="";while(this.hasMoreChars()){var b=this.lookAhead(0);if(b==""||b=="\n"||b==" "){break}else{this.consume(1);a=a+b}}return a.toString()};LexerCore.prototype.byteStringNoSlash=function(){var a="";while(this.hasMoreChars()){var b=this.lookAhead(0);if(b==""||b=="\n"||b=="/"){break}else{this.consume(1);a=a+b}}return a.toString()};LexerCore.prototype.byteStringNoComma=function(){var a="";while(this.hasMoreChars()){var b=this.lookAhead(0);if(b=="\n"||b==","){break}else{this.consume(1);a=a+b}}return a.toString()};LexerCore.prototype.charAsString=function(){if(typeof arguments[0]=="string"){var a=arguments[0];return a}else{if(typeof arguments[0]=="number"){var b=arguments[0];return this.buffer.substring(this.ptr,this.ptr+b)}}};LexerCore.prototype.number=function(){var a=this.ptr;if(!this.isDigit(this.lookAhead(0))){console.error(this.buffer+"LexerCore:number(): Unexpected token at "+this.lookAhead(0),this.ptr);throw"LexerCore:number(): Unexpected token at "+this.lookAhead(0)}this.consume(1);while(this.hasMoreChars()){var b=this.lookAhead(0);if(this.isDigit(b)){this.consume(1)}else{break}}return this.buffer.substring(a,this.ptr)};LexerCore.prototype.markInputPosition=function(){return this.ptr};LexerCore.prototype.rewindInputPosition=function(a){this.ptr=a};LexerCore.prototype.getRest=function(){if(this.ptr>=this.buffer.length){return null}else{return this.buffer.substring(this.ptr)}};LexerCore.prototype.getString=function(e){var b="";while(this.hasMoreChars()){var d=this.lookAhead(0);if(d==""){console.error(this.buffer+"LexerCore:getString(): unexpected EOL",this.ptr);throw"LexerCore:getString(): unexpected EOL"}else{if(d==e){this.consume(1);break}else{if(d=="\\"){this.consume(1);var a=this.lookAhead(0);if(a==""){console.error(this.buffer+"LexerCore:getString(): unexpected EOL",this.ptr);throw"LexerCore:getString(): unexpected EOL"}else{this.consume(1);b=b+a}}else{this.consume(1);b=b+d}}}}return b.toString()};LexerCore.prototype.getPtr=function(){return this.ptr};LexerCore.prototype.getBuffer=function(){return this.buffer};LexerCore.prototype.put=function(e,b,f){var g=0;for(var d=0;d<e.length;d++){var c=e[d][0];if(c==b){g=1;var a=new Array();a[0]=c;a[1]=f;e[d]=a}}if(g==0){a=new Array();a[0]=b;a[1]=f;e.push(a)}return e};function ParserCore(){this.classname="ParserCore";this.nesting_level=null;this.lexer=null}ParserCore.prototype.nameValue=function(e){if(e==null){var f=this.nameValue("=");return f}else{this.lexer.match(LexerCore.prototype.ID);var a=this.lexer.getNextToken();this.lexer.SPorHT();try{var d=false;var b=this.lexer.lookAhead(0);if(b==e){this.lexer.consume(1);this.lexer.SPorHT();var h=null;var c=false;if(this.lexer.lookAhead(0)=='"'){h=this.lexer.quotedString();d=true}else{this.lexer.match(LexerCore.prototype.ID);var i=this.lexer.getNextToken();h=i.tokenValue;if(h==null){h="";c=true}}var f=new NameValue(a.tokenValue,h,c);if(d){f.setQuotedValue()}return f}else{f=new NameValue(a.tokenValue,"",true);return f}}catch(g){console.error("ParserCore:nameValue(): catched exception:"+g);f=new NameValue(a.tokenValue,null,false);return f}}return f};function HostNameParser(){this.classname="HostNameParser";this.lexer=null;this.stripAddressScopeZones=false;if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new LexerCore("charLexer",a)}else{if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("charLexer")}}}HostNameParser.prototype=new ParserCore();HostNameParser.prototype.constructor=HostNameParser;HostNameParser.prototype.VALID_DOMAIN_LABEL_CHAR=[LexerCore.prototype.ALPHADIGIT_VALID_CHARS,"-","."];HostNameParser.prototype.consumeDomainLabel=function(){this.lexer.consumeValidChars(this.VALID_DOMAIN_LABEL_CHAR)};HostNameParser.prototype.ipv6Reference=function(){};HostNameParser.prototype.host=function(){var a;if(this.lexer.lookAhead(0)=="["){a=this.ipv6Reference()}else{var b=this.lexer.getPtr();this.consumeDomainLabel();a=this.lexer.getBuffer().substring(b,this.lexer.getPtr())}if(a.length==0){console.error("Parser:host():"+this.lexer.getBuffer()+" missing host name",this.lexer.getPtr());throw"Parser:host(): Missing host name"}else{return new Host(a)}};HostNameParser.prototype.isIPv6Address=function(){};HostNameParser.prototype.hostPort=function(f){var c=this.host();var d=new HostPort();d.setHost(c);if(f){this.lexer.SPorHT()}if(this.lexer.hasMoreChars()){var e=this.lexer.lookAhead(0);switch(e){case":":this.lexer.consume(1);if(f){this.lexer.SPorHT()}try{var a=this.lexer.number();d.setPort(a)}catch(b){console.error("Parser:hostPort():"+this.lexer.getBuffer()+" : error parsing port ",this.lexer.getPtr());throw"Parser:hostPort(): error parsing port"}break;case",":case";":case"?":case">":case" ":case"\t":case"\r":case"\n":case"/":break;case"%":if(this.stripAddressScopeZones){break}default:if(!f){console.error("Parser:hostPort(): "+this.lexer.getBuffer()+" illegal character in hostname:"+this.lexer.lookAhead(0),this.lexer.getPtr());throw"Parser:hostPort(): error parsing port"}}}return d};function MessageDigestAlgorithm(){this.classname="MessageDigestAlgorithm";this.toHex=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];this.hexcase=0}MessageDigestAlgorithm.prototype.calculateResponse=function(f,e,b,g,k,m,a,j,h,i){var d=null;d=f+":"+e+":"+b;var c=null;if(i==null||i.length==0||i=="auth"){c=a+":"+j}else{if(h==null){h=""}c=a+":"+j+":"+this.H(h)}var l=null;if(m!=null&&i!=null&&k!=null&&(i=="auth"||i=="auth-int")){l=this.KD(this.H(d),g+":"+k+":"+m+":"+i+":"+this.H(c))}else{l=this.KD(this.H(d),g+":"+this.H(c))}return l};MessageDigestAlgorithm.prototype.H=function(a){return this.md5(a)};MessageDigestAlgorithm.prototype.KD=function(a,b){return this.H(a+":"+b)};MessageDigestAlgorithm.prototype.toHexString=function(d){var g=0;var a="";var f=new Array();for(var e=0;e<d.length;e++){f[g++]=this.toHex[(d[e]>>4)&15];a=a+f[g];f[g++]=this.toHex[d[e]&15];a=a+f[g]}return a};MessageDigestAlgorithm.prototype.md5=function(a){return this.hex_md5(a)};MessageDigestAlgorithm.prototype.hex_md5=function(a){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(a)))};MessageDigestAlgorithm.prototype.rstr_md5=function(a){return this.binl2rstr(this.binl_md5(this.rstr2binl(a),a.length*8))};MessageDigestAlgorithm.prototype.rstr2hex=function(c){var e=this.hexcase?"0123456789ABCDEF":"0123456789abcdef";var b="";var a;for(var d=0;d<c.length;d++){a=c.charCodeAt(d);b+=e.charAt((a>>>4)&15)+e.charAt(a&15)}return b};MessageDigestAlgorithm.prototype.str2rstr_utf8=function(c){var b="";var d=-1;var a,e;while(++d<c.length){a=c.charCodeAt(d);e=d+1<c.length?c.charCodeAt(d+1):0;if(55296<=a&&a<=56319&&56320<=e&&e<=57343){a=65536+((a&1023)<<10)+(e&1023);d++}if(a<=127){b+=String.fromCharCode(a)}else{if(a<=2047){b+=String.fromCharCode(192|((a>>>6)&31),128|(a&63))}else{if(a<=65535){b+=String.fromCharCode(224|((a>>>12)&15),128|((a>>>6)&63),128|(a&63))}else{if(a<=2097151){b+=String.fromCharCode(240|((a>>>18)&7),128|((a>>>12)&63),128|((a>>>6)&63),128|(a&63))}}}}}return b};MessageDigestAlgorithm.prototype.rstr2binl=function(b){var a=Array(b.length>>2);for(var c=0;c<a.length;c++){a[c]=0}for(c=0;c<b.length*8;c+=8){a[c>>5]|=(b.charCodeAt(c/8)&255)<<(c%32)}return a};MessageDigestAlgorithm.prototype.binl2rstr=function(b){var a="";for(var c=0;c<b.length*32;c+=8){a+=String.fromCharCode((b[c>>5]>>>(c%32))&255)}return a};MessageDigestAlgorithm.prototype.binl_md5=function(q,k){q[k>>5]|=128<<((k)%32);q[(((k+64)>>>9)<<4)+14]=k;var p=1732584193;var n=-271733879;var m=-1732584194;var l=271733878;for(var g=0;g<q.length;g+=16){var j=p;var h=n;var f=m;var e=l;p=this.md5_ff(p,n,m,l,q[g+0],7,-680876936);l=this.md5_ff(l,p,n,m,q[g+1],12,-389564586);m=this.md5_ff(m,l,p,n,q[g+2],17,606105819);n=this.md5_ff(n,m,l,p,q[g+3],22,-1044525330);p=this.md5_ff(p,n,m,l,q[g+4],7,-176418897);l=this.md5_ff(l,p,n,m,q[g+5],12,1200080426);m=this.md5_ff(m,l,p,n,q[g+6],17,-1473231341);n=this.md5_ff(n,m,l,p,q[g+7],22,-45705983);p=this.md5_ff(p,n,m,l,q[g+8],7,1770035416);l=this.md5_ff(l,p,n,m,q[g+9],12,-1958414417);m=this.md5_ff(m,l,p,n,q[g+10],17,-42063);n=this.md5_ff(n,m,l,p,q[g+11],22,-1990404162);p=this.md5_ff(p,n,m,l,q[g+12],7,1804603682);l=this.md5_ff(l,p,n,m,q[g+13],12,-40341101);m=this.md5_ff(m,l,p,n,q[g+14],17,-1502002290);n=this.md5_ff(n,m,l,p,q[g+15],22,1236535329);p=this.md5_gg(p,n,m,l,q[g+1],5,-165796510);l=this.md5_gg(l,p,n,m,q[g+6],9,-1069501632);m=this.md5_gg(m,l,p,n,q[g+11],14,643717713);n=this.md5_gg(n,m,l,p,q[g+0],20,-373897302);p=this.md5_gg(p,n,m,l,q[g+5],5,-701558691);l=this.md5_gg(l,p,n,m,q[g+10],9,38016083);m=this.md5_gg(m,l,p,n,q[g+15],14,-660478335);n=this.md5_gg(n,m,l,p,q[g+4],20,-405537848);p=this.md5_gg(p,n,m,l,q[g+9],5,568446438);l=this.md5_gg(l,p,n,m,q[g+14],9,-1019803690);m=this.md5_gg(m,l,p,n,q[g+3],14,-187363961);n=this.md5_gg(n,m,l,p,q[g+8],20,1163531501);p=this.md5_gg(p,n,m,l,q[g+13],5,-1444681467);l=this.md5_gg(l,p,n,m,q[g+2],9,-51403784);m=this.md5_gg(m,l,p,n,q[g+7],14,1735328473);n=this.md5_gg(n,m,l,p,q[g+12],20,-1926607734);p=this.md5_hh(p,n,m,l,q[g+5],4,-378558);l=this.md5_hh(l,p,n,m,q[g+8],11,-2022574463);m=this.md5_hh(m,l,p,n,q[g+11],16,1839030562);n=this.md5_hh(n,m,l,p,q[g+14],23,-35309556);p=this.md5_hh(p,n,m,l,q[g+1],4,-1530992060);l=this.md5_hh(l,p,n,m,q[g+4],11,1272893353);m=this.md5_hh(m,l,p,n,q[g+7],16,-155497632);n=this.md5_hh(n,m,l,p,q[g+10],23,-1094730640);p=this.md5_hh(p,n,m,l,q[g+13],4,681279174);l=this.md5_hh(l,p,n,m,q[g+0],11,-358537222);m=this.md5_hh(m,l,p,n,q[g+3],16,-722521979);n=this.md5_hh(n,m,l,p,q[g+6],23,76029189);p=this.md5_hh(p,n,m,l,q[g+9],4,-640364487);l=this.md5_hh(l,p,n,m,q[g+12],11,-421815835);m=this.md5_hh(m,l,p,n,q[g+15],16,530742520);n=this.md5_hh(n,m,l,p,q[g+2],23,-995338651);p=this.md5_ii(p,n,m,l,q[g+0],6,-198630844);l=this.md5_ii(l,p,n,m,q[g+7],10,1126891415);m=this.md5_ii(m,l,p,n,q[g+14],15,-1416354905);n=this.md5_ii(n,m,l,p,q[g+5],21,-57434055);p=this.md5_ii(p,n,m,l,q[g+12],6,1700485571);l=this.md5_ii(l,p,n,m,q[g+3],10,-1894986606);m=this.md5_ii(m,l,p,n,q[g+10],15,-1051523);n=this.md5_ii(n,m,l,p,q[g+1],21,-2054922799);p=this.md5_ii(p,n,m,l,q[g+8],6,1873313359);l=this.md5_ii(l,p,n,m,q[g+15],10,-30611744);m=this.md5_ii(m,l,p,n,q[g+6],15,-1560198380);n=this.md5_ii(n,m,l,p,q[g+13],21,1309151649);p=this.md5_ii(p,n,m,l,q[g+4],6,-145523070);l=this.md5_ii(l,p,n,m,q[g+11],10,-1120210379);m=this.md5_ii(m,l,p,n,q[g+2],15,718787259);n=this.md5_ii(n,m,l,p,q[g+9],21,-343485551);p=this.safe_add(p,j);n=this.safe_add(n,h);m=this.safe_add(m,f);l=this.safe_add(l,e)}return Array(p,n,m,l)};MessageDigestAlgorithm.prototype.md5_cmn=function(h,e,d,c,g,f){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,h),this.safe_add(c,f)),g),d)};MessageDigestAlgorithm.prototype.md5_ff=function(g,f,k,j,e,i,h){return this.md5_cmn((f&k)|((~f)&j),g,f,e,i,h)};MessageDigestAlgorithm.prototype.md5_gg=function(g,f,k,j,e,i,h){return this.md5_cmn((f&j)|(k&(~j)),g,f,e,i,h)};MessageDigestAlgorithm.prototype.md5_hh=function(g,f,k,j,e,i,h){return this.md5_cmn(f^k^j,g,f,e,i,h)};MessageDigestAlgorithm.prototype.md5_ii=function(g,f,k,j,e,i,h){return this.md5_cmn(k^(f|(~j)),g,f,e,i,h)};MessageDigestAlgorithm.prototype.safe_add=function(a,d){var c=(a&65535)+(d&65535);var b=(a>>16)+(d>>16)+(c>>16);return(b<<16)|(c&65535)};MessageDigestAlgorithm.prototype.bit_rol=function(a,b){return(a<<b)|(a>>>(32-b))};function Separators(){this.classname="Separators"}Separators.prototype.SEMICOLON=";";Separators.prototype.COLON=":";Separators.prototype.COMMA=",";Separators.prototype.SLASH="/";Separators.prototype.SP=" ";Separators.prototype.EQUALS="=";Separators.prototype.STAR="*";Separators.prototype.NEWLINE="\r\n";Separators.prototype.RETURN="\n";Separators.prototype.LESS_THAN="<";Separators.prototype.GREATER_THAN=">";Separators.prototype.AT="@";Separators.prototype.DOT=".";Separators.prototype.QUESTION="?";Separators.prototype.POUND="#";Separators.prototype.AND="&";Separators.prototype.LPAREN="(";Separators.prototype.RPAREN=")";Separators.prototype.DOUBLE_QUOTE='"';Separators.prototype.QUOTE="'";Separators.prototype.HT="\t";Separators.prototype.PERCENT="%";function SdpException(a){this.classname="SdpException";this.message="";if(arguments.length==1){if(typeof arguments[0]=="string"){this.message+=arguments[0]}}}SdpException.prototype.constructor=SdpException;SdpException.prototype.getMessage=function(){return this.message};function SDPObject(){this.classname="SDPObject"}SDPObject.prototype=new GenericObject();SDPObject.prototype.constructor=SDPObject;SDPObject.prototype.encode=function(){throw new SdpException("SDPObject:encode() not implemented")};SDPObject.prototype.toString=function(){return this.encode()};SDPObject.prototype.equals=function(a){throw new SdpException("SDPObject:equals() not implemented")};SDPObject.prototype.match=function(a){throw new SdpException("SDPObject:other() not implemented")};SDPObject.prototype.clone=function(a){var c;if(this.constructor==Object){c=new this.constructor()}else{c=new this.constructor(this.valueOf())}for(var b in this){if(c[b]!=this[b]){if(typeof(this[b])=="object"){c[b]=this[b].clone()}else{c[b]=this[b]}}}c.toString=this.toString;c.valueOf=this.valueOf;return c};function SDPField(){this.classname="SDPField";this.fieldName=null}SDPField.prototype=new SDPObject();SDPField.prototype.constructor=SDPField;SDPField.prototype.SESSION_NAME_FIELD="s=";SDPField.prototype.INFORMATION_FIELD="i=";SDPField.prototype.EMAIL_FIELD="e=";SDPField.prototype.PHONE_FIELD="p=";SDPField.prototype.CONNECTION_FIELD="c=";SDPField.prototype.BANDWIDTH_FIELD="b=";SDPField.prototype.ORIGIN_FIELD="o=";SDPField.prototype.TIME_FIELD="t=";SDPField.prototype.KEY_FIELD="k=";SDPField.prototype.ATTRIBUTE_FIELD="a=";SDPField.prototype.VERSION_FIELD="v=";SDPField.prototype.URI_FIELD="u=";SDPField.prototype.MEDIA_FIELD="m=";SDPField.prototype.REPEAT_FIELD="r=";SDPField.prototype.ZONE_FIELD="z=";SDPField.prototype.BASE64="base64";SDPField.prototype.PROMPT="prompt";SDPField.prototype.CLEAR="clear";SDPField.prototype.URI="URI";SDPField.prototype.IPV4="IP4";SDPField.prototype.IPV6="IP6";SDPField.prototype.IN="IN";SDPField.prototype.getFieldName=function(){return this.fieldName};SDPField.prototype.setFieldName=function(a){this.fieldName=a};SDPField.prototype.getTypeChar=function(){if(this.fieldName==null){return""}else{return this.fieldName.charAt(0)}};function AttributeField(){this.classname="AttributeField";this.fieldName=this.ATTRIBUTE_FIELD;this.attribute=null}AttributeField.prototype=new SDPField();AttributeField.prototype.constructor=AttributeField;AttributeField.prototype.getName=function(){if(this.attribute==null){return null}else{return this.attribute.getName()}};AttributeField.prototype.setName=function(a){if(typeof(a)=="string"){if(this.attribute==null){this.attribute=new NameValue()}this.attribute.setSeparator(Separators.prototype.COLON);this.attribute.setName(a)}else{throw new SdpException("AttributeField.setName() requires string object argument")}};AttributeField.prototype.hasValue=function(){if(this.attribute==null){return false}else{var a=this.attribute.getValueAsObject();if(a==null){return false}else{return true}}};AttributeField.prototype.getValue=function(){if(this.attribute==null){return null}else{var a=this.attribute.getValueAsObject();if(a==null){return null}else{if(a instanceof String){return a}else{return a.toString()}}}};AttributeField.prototype.setValue=function(a){if(this.attribute==null){this.attribute=new NameValue()}this.attribute.setValueAsObject(a)};AttributeField.prototype.encode=function(){if(this.attribute==null){throw new SdpException("AttributeField.encode() requires name/value")}var a=this.ATTRIBUTE_FIELD;a+=this.attribute.encode();a+=Separators.prototype.NEWLINE;return a};AttributeField.prototype.equals=function(b){if(!(b instanceof AttributeField)){return false}var a=b;return(a.attribute.getName().toLowerCase()==this.attribute.getName().toLowerCase())&&this.attribute.getValueAsObject().equals(a.attribute.getValueAsObject())};function VersionField(){this.classname="VersionField";this.fieldName=this.VERSION_FIELD;this.version=0}VersionField.prototype=new SDPField();VersionField.prototype.constructor=VersionField;VersionField.prototype.getVersion=function(){return this.version};VersionField.prototype.setVersion=function(a){if(typeof a=="number"){if(a>=0){this.version=a}else{throw new SdpException("VersionField.setVersion(): bad argument")}}else{throw new SdpException("VersionField.setVersion(): requires number type argument")}};VersionField.prototype.encode=function(){return this.VERSION_FIELD+this.version+Separators.prototype.NEWLINE};function OriginField(){this.classname="OriginField";this.fieldName=this.ORIGIN_FIELD;this.userName=null;this.networkType=SDPField.prototype.IN;this.addressType=SDPField.prototype.IPV4;this.host=null;this.sessionId=null;this.sessionVersion=null}OriginField.prototype=new SDPField();OriginField.prototype.constructor=OriginField;OriginField.prototype.getUserName=function(){return this.userName};OriginField.prototype.getSessionId=function(){return new Number(this.sessionId)};OriginField.prototype.getSessionVersion=function(){return new Number(this.sessionVersion)};OriginField.prototype.getNetworkType=function(){return this.networkType};OriginField.prototype.getAddressType=function(){return this.addressType};OriginField.prototype.getHost=function(){return this.host};OriginField.prototype.getAddress=function(){var a=this.getHost();if(a==null){return null}else{return a.getAddress()}};OriginField.prototype.setSessionId=function(a){if(typeof(a)=="string"||typeof(a)=="number"){this.sessionId="";this.sessionId+=a}else{throw new SdpException("OriginField.setSessionId() requires string or number object argument")}};OriginField.prototype.setSessionVersion=function(a){if(typeof(a)=="string"||typeof(a)=="number"){this.sessionVersion="";this.sessionVersion+=a}else{throw new SdpException("OriginField.setSessionVersion() requires string or number argument")}};OriginField.prototype.setNetworkType=function(a){if(typeof(a)=="string"){this.networkType=a}else{throw new SdpException("OriginField.setNetworkType() requires string argument")}};OriginField.prototype.setAddressType=function(a){if(typeof(a)=="string"){this.addressType=a}else{throw new SdpException("OriginField.setAddressType() requires string argument")}};OriginField.prototype.setHost=function(a){if(a instanceof Host){this.host=a}else{throw new SdpException("OriginField.setHost() requires Host object argument")}};OriginField.prototype.setAddress=function(a){if(typeof(a)=="string"){var b=this.getHost();if(b==null){b=new Host()}b.setAddress(a);this.setHost(b)}else{throw new SdpException("OriginField.setAddress() requires string argument")}};OriginField.prototype.setUserName=function(a){if(typeof(a)=="string"){this.userName=a}else{throw new SdpException("OriginField.setUserName() requires string argument")}};OriginField.prototype.encode=function(){if(this.host==null){throw new SdpException("OriginField.encode() requires host")}if(this.userName==null){throw new SdpException("OriginField.encode() requires userName")}if(this.sessionId==null){throw new SdpException("OriginField.encode() requires sessionId")}if(this.sessionVersion==null){throw new SdpException("OriginField.encode() requires sessionVersion")}var b="";if(this.host!=null){b=this.host.encode();if(Host.prototype.isIPv6Address(b)){b=b.substring(1,b.length()-1)}}var a=this.ORIGIN_FIELD;a+=this.userName;a+=Separators.prototype.SP;a+=this.sessionId;a+=Separators.prototype.SP;a+=this.sessionVersion;a+=Separators.prototype.SP;a+=this.networkType;a+=Separators.prototype.SP;a+=this.addressType;a+=Separators.prototype.SP;a+=b;a+=Separators.prototype.NEWLINE;return a};OriginField.prototype.clone=function(){var a=new OriginField();a.userName=this.userName;a.networkType=this.networkType;a.addressType=this.addressType;a.sessionId=this.sessionId;a.sessionVersion=this.sessionVersion;a.host=new Host(this.host.getAddress());return a};function SessionNameField(){this.classname="SessionNameField";this.fieldName=this.SESSION_NAME_FIELD;this.sessionName=null}SessionNameField.prototype=new SDPField();SessionNameField.prototype.constructor=SessionNameField;SessionNameField.prototype.getSessionName=function(){return this.sessionName};SessionNameField.prototype.setSessionName=function(a){if(typeof(a)=="string"){this.sessionName=a}else{throw new SdpException("SessionNameField.setSessionName() requires string object argument")}};SessionNameField.prototype.encode=function(){return this.SESSION_NAME_FIELD+this.sessionName+Separators.prototype.NEWLINE};function InformationField(){this.classname="InformationField";this.fieldName=this.INFORMATION_FIELD;this.information=""}InformationField.prototype=new SDPField();InformationField.prototype.constructor=InformationField;InformationField.prototype.getInformation=function(){return this.information};InformationField.prototype.setInformation=function(a){if(typeof(a)=="string"){this.information=a}else{throw new SdpException("InformationField.setInformation() requires string type argument")}};InformationField.prototype.encode=function(){if(this.information==null){throw new SdpException("InformationField.encode() requires information")}return this.INFORMATION_FIELD+this.information+Separators.prototype.NEWLINE};function URIField(){this.classname="URIField";this.fieldName=this.URI_FIELD;this.uri=""}URIField.prototype=new SDPField();URIField.prototype.constructor=URIField;URIField.prototype.getURI=function(){return this.uri};URIField.prototype.setURI=function(a){if(typeof a=="string"){this.uri=a}else{throw new SdpException("URIField.setURI() requires string object argument")}};URIField.prototype.encode=function(){if(this.uri==null){throw new SdpException("URIField.encode() requires uri")}return this.URI_FIELD+this.uri+Separators.prototype.NEWLINE};function EmailField(){this.classname="EmailField";this.fieldName=this.EMAIL_FIELD;this.displayName=null;this.email=null}EmailField.prototype=new SDPField();EmailField.prototype.constructor=EmailField;EmailField.prototype.getEmail=function(){return this.email};EmailField.prototype.getDisplayName=function(){return this.displayName};EmailField.prototype.setDisplayName=function(a){if(typeof(a)=="string"){this.displayName=a}else{throw new SdpException("EmailField.setDisplayName() requires string object argument")}};EmailField.prototype.setEmail=function(a){if(typeof(a)=="string"){this.email=a}else{throw new SdpException("EmailField.setEmail() requires string object argument")}};EmailField.prototype.encode=function(){if(this.email==null){throw new SdpException("PhoneField.encode() requires email")}var a=this.EMAIL_FIELD;if(this.displayName!=null){a=this.displayName+Separators.prototype.LESS_THAN}else{a=""}a+=this.email;if(this.displayName!=null){a+=Separators.prototype.GREATER_THAN}a+=Separators.prototype.NEWLINE;return a};function PhoneField(){this.classname="PhoneField";this.fieldName=this.VERSION_FIELD;this.name=null;this.phoneNumber=null}PhoneField.prototype=new SDPField();PhoneField.prototype.constructor=PhoneField;OriginField.prototype.getName=function(){return this.name};PhoneField.prototype.getPhoneNumber=function(){return this.phoneNumber};PhoneField.prototype.setName=function(a){if(typeof a=="string"){this.name=a}else{throw new SdpException("PhoneField.setName(): requires number type argument")}};PhoneField.prototype.setPhoneNumber=function(a){if(typeof a=="string"){this.phoneNumber=a}else{throw new SdpException("PhoneField.setPhoneNumber(): requires number type argument")}};PhoneField.prototype.encode=function(){if(this.phoneNumber==null){throw new SdpException("PhoneField.encode() requires phoneNumber")}var a=this.PHONE_FIELD;if(this.name!=null){a+=this.name}a+=Separators.prototype.LESS_THAN;a+=this.phoneNumber;a+=Separators.prototype.GREATER_THAN;a+=Separators.prototype.NEWLINE;return a};function TimeField(){this.classname="TimeField";this.fieldName=this.TIME_FIELD;this.startTime=0;this.stopTime=0}TimeField.prototype=new SDPField();TimeField.prototype.constructor=TimeField;TimeField.prototype.getStartTime=function(){return this.startTime};TimeField.prototype.getStopTime=function(){return this.stopTime};TimeField.prototype.setStartTime=function(a){if(typeof(a)=="number"){this.startTime=a}else{throw new SdpException("TimeField.setStartTime() requires string type argument")}};TimeField.prototype.setStopTime=function(a){if(typeof(a)=="number"){this.startTime=a}else{throw new SdpException("TimeField.setStopTime() requires string type argument")}};TimeField.prototype.getTypedTime=function(){return false};TimeField.prototype.setTypedTime=function(a){};TimeField.prototype.isZero=function(){return(this.getStartTime()==0&&this.getStopTime()==0)};TimeField.prototype.setZero=function(){this.setStopTime(0);this.setStartTime(0)};TimeField.prototype.encode=function(){var a=this.TIME_FIELD;a+=this.startTime;a+=Separators.prototype.SP;a+=this.stopTime;a+=Separators.prototype.NEWLINE;return a};function ConnectionAddress(){this.classname="ConnectionAddress";this.host=null;this.ttl=0;this.port=0}ConnectionAddress.prototype=new SDPObject();ConnectionAddress.prototype.constructor=ConnectionAddress;ConnectionAddress.prototype.getHost=function(){return this.host};ConnectionAddress.prototype.getTtl=function(){return this.ttl};ConnectionAddress.prototype.getPort=function(){return this.port};ConnectionAddress.prototype.setHost=function(a){if(a instanceof Host){this.host=a}else{throw new SdpException("ConnectionAddress.setHost() requires  Host object argument")}};ConnectionAddress.prototype.setTtl=function(a){if(typeof(a)=="number"){this.ttl=a}else{throw new SdpException("ConnectionAddress.setTtl() requires  number object argument")}};ConnectionAddress.prototype.setPort=function(a){if(typeof(a)=="number"){this.port=a}else{throw new SdpException("ConnectionAddress.setPort() requires  number object argument")}};ConnectionAddress.prototype.encode=function(){if(this.host==null){throw new SdpException("ConnectionAddress.encode() requires host")}var a=this.host.encode();if(Host.prototype.isIPv6Address(a)){a+=a.substring(1,a.length()-1)}if(this.ttl!=0&&this.port!=0){a+=Separators.prototype.SLASH+this.ttl+Separators.prototype.SLASH+this.port}else{if(this.ttl!=0){a+=Separators.prototype.SLASH+this.ttl}}return a};ConnectionAddress.prototype.clone=function(){var a=new ConnectionAddress();if(this.address!=null){a.address=this.address.clone()}a.ttl=this.ttl;a.port=this.port;return a};function ConnectionField(){this.classname="ConnectionField";this.fieldName=this.CONNECTION_FIELD;this.networkType=SDPField.prototype.IN;this.addressType=SDPField.prototype.IPV4;this.address=null}ConnectionField.prototype=new SDPField();ConnectionField.prototype.constructor=ConnectionField;ConnectionField.prototype.getNetworkType=function(){return this.networkType};ConnectionField.prototype.getAddressType=function(){return this.addressType};ConnectionField.prototype.getAddress=function(){if(this.address==null){return null}else{var a=this.address.getAddress();if(a==null){return null}else{return a.getAddress()}}};ConnectionField.prototype.setNetworkType=function(a){if(typeof a=="string"){this.networkType=a}else{throw new SdpException("ConnectionField.setNetworkType() requires string type argument")}};ConnectionField.prototype.setAddressType=function(a){if(typeof a=="string"){this.addressType=a}else{throw new SdpException("ConnectionField.setAddressType() requires string type argument")}};ConnectionField.prototype.setAddress=function(a){if(a instanceof ConnectionAddress){this.address=a}else{if(typeof a=="string"){if(this.address==null){this.address=new ConnectionAddress();var b=new Host(a);this.address.setHost(b)}else{var b=this.address.getHost();if(b==null){b=new Host(a);this.address.setAddress(b)}else{b.setAddress(a)}}}else{throw new SdpException("ConnectionField.setAddress() requires ConnectionAddress object or string argument")}}};ConnectionField.prototype.encode=function(){if(this.address==null){throw new SdpException("ConnectionField.encode() requires address")}var a=this.CONNECTION_FIELD;a+=this.networkType;a+=Separators.prototype.SP;a+=this.addressType;a+=Separators.prototype.SP;a+=this.address.encode();a+=Separators.prototype.NEWLINE;return a};ConnectionField.prototype.clone=function(){var a=new ConnectionField();if(this.address!=null){a.address=this.address.clone()}a.networkType=this.networkType;a.addressType=this.addressType;return a};function KeyField(){this.classname="KeyField";this.fieldName=this.KEY_FIELD;this.method=null;this.key=null}KeyField.prototype=new SDPField();KeyField.prototype.constructor=KeyField;KeyField.prototype.getMethod=function(){return this.method};KeyField.prototype.getKey=function(){return this.key};KeyField.prototype.setMethod=function(a){if(typeof a=="string"){this.method=a}else{throw new SdpException("KeyField.setMethod() requires string object argument")}};KeyField.prototype.setKey=function(a){if(typeof a=="string"){this.key=a}else{throw new SdpException("KeyField.setKey() requires string object argument")}};KeyField.prototype.encode=function(){if(this.method==null){throw new SdpException("KeyField.encode() requires method")}if(this.key==null){throw new SdpException("KeyField.encode() requires key")}var a=this.KEY_FIELD;a+=this.method;a+=Separators.prototype.COLON;a+=this.key;a+=Separators.prototype.NEWLINE;return a};function MediaField(){this.classname="MediaField";this.fieldName=this.MEDIA_FIELD;this.type=null;this.port=-1;this.nports=0;this.protocol=null;this.formatArray=new Array()}MediaField.prototype=new SDPField();MediaField.prototype.constructor=MediaField;MediaField.prototype.getType=function(){return this.type};MediaField.prototype.getPort=function(){return this.port};MediaField.prototype.getNports=function(){return this.nports};MediaField.prototype.getProtocol=function(){return this.protocol};MediaField.prototype.getFormats=function(){return this.formatArray};MediaField.prototype.setType=function(a){if(typeof(a)=="string"){this.type=a.toLowerCase()}else{throw new SdpException("MediaField.setMedia() requires string object argument")}};MediaField.prototype.setPort=function(a){if(typeof(a)=="number"){if(a<0){throw new SdpException("MediaField.setPort() requires number > 0 object argument")}this.port=a}else{throw new SdpException("MediaField.setPort() requires number object argument")}};MediaField.prototype.setNports=function(a){if(typeof(a)=="number"){if(a<0){throw new SdpException("MediaField.setNports() requires number > 0 object argument")}this.nports=a}else{throw new SdpException("MediaField.setNports() requires number object argument")}};MediaField.prototype.setProtocol=function(a){if(typeof(a)=="string"){this.protocol=a}else{throw new SdpException("MediaField.setProtocol() requires string object argument")}};MediaField.prototype.setFormats=function(a){if(a instanceof Array){this.formatArray=a}else{throw new SdpException("MediaField.setFormats() requires Array object argument")}};MediaField.prototype.getFormats=function(a){if(typeof(a)=="boolean"){if(a&&this.formatArray==null){this.formatArray=new Array()}return this.formatArray}else{throw new SdpException("MediaField.getFormats() requires boolean object argument")}};MediaField.prototype.encodeFormats=function(){var b="";for(var a=0;a<this.formatArray.length;a++){b+=this.formatArray[a];if(a<(this.formatArray.length-1)){b+=Separators.prototype.SP}}return b};MediaField.prototype.encode=function(){if(this.type==null){throw new SdpException("MediaField.encode() requires type")}if(this.protocol==null){throw new SdpException("MediaField.encode() requires protocol")}if(this.formatArray==null){throw new SdpException("MediaField.encode() requires format")}var a=this.MEDIA_FIELD;a+=this.type+Separators.prototype.SP+this.port;if(this.nports>1){a+=Separators.prototype.SLASH+this.nports}a+=Separators.prototype.SP+this.protocol;a+=Separators.prototype.SP+this.encodeFormats();a+=Separators.prototype.NEWLINE;return a};MediaField.prototype.clone=function(){var a=new MediaField();a.media=this.type;a.port=this.port;a.nports=this.nports;a.proto=this.protocol;a.formats=new Array();if(this.formatArray!=null){for(var b=0;b<this.formatArray.length;b++){a.formats[b]=this.formatArray[b]}}return a};function AttributeField(){this.classname="AttributeField";this.fieldName=this.ATTRIBUTE_FIELD;this.attribute=null}AttributeField.prototype=new SDPField();AttributeField.prototype.constructor=AttributeField;AttributeField.prototype.getName=function(){if(this.attribute==null){return null}else{return this.attribute.getName()}};AttributeField.prototype.setName=function(a){if(typeof(a)=="string"){if(this.attribute==null){this.attribute=new NameValue()}this.attribute.setSeparator(Separators.prototype.COLON);this.attribute.setName(a)}else{throw new SdpException("AttributeField.setName() requires string object argument")}};AttributeField.prototype.hasValue=function(){if(this.attribute==null){return false}else{var a=this.attribute.getValueAsObject();if(a==null){return false}else{return true}}};AttributeField.prototype.getValue=function(){if(this.attribute==null){return null}else{var a=this.attribute.getValueAsObject();if(a==null){return null}else{if(a instanceof String){return a}else{return a.toString()}}}};AttributeField.prototype.setValue=function(a){if(this.attribute==null){this.attribute=new NameValue()}this.attribute.setValueAsObject(a)};AttributeField.prototype.encode=function(){if(this.attribute==null){throw new SdpException("AttributeField.encode() requires name/value")}var a=this.ATTRIBUTE_FIELD;a+=this.attribute.encode();a+=Separators.prototype.NEWLINE;return a};AttributeField.prototype.equals=function(b){if(!(b instanceof AttributeField)){return false}var a=b;return(a.attribute.getName().toLowerCase()==this.attribute.getName().toLowerCase())&&this.attribute.getValueAsObject().equals(a.attribute.getValueAsObject())};function BandwidthField(){this.classname="BandwidthField";this.fieldName=this.BANDWDTH_FIELD;this.type="AS";this.bandwidth=null}BandwidthField.prototype=new SDPField();BandwidthField.prototype.constructor=BandwidthField;BandwidthField.prototype.getType=function(){return this.type};BandwidthField.prototype.getBandwidth=function(){return this.bandwidth};BandwidthField.prototype.setType=function(a){if(typeof(a)=="string"){this.type=a}else{throw new SdpException("BandwidthField.setType() requires string object argument")}};BandwidthField.prototype.setBandwidth=function(a){if(typeof(a)=="number"){this.bandwidth=a}else{throw new SdpException("BandwidthField.setBandwidth() requires number object argument")}};BandwidthField.prototype.encode=function(){if(this.bandwidth==null){throw new SdpException("BandwidthField.encode() requires valid bandwidth value")}var a=this.BANDWIDTH_FIELD;a+=this.type;a+=Separators.prototype.COLON;a+=this.bandwidth;a+=Separators.prototype.NEWLINE;return a};function TypedTime(){this.classname="TypedTime";this.unit="";this.time=0}TypedTime.prototype=new SDPObject();TypedTime.prototype.constructor=TypedTime;TypedTime.prototype.setTime=function(a){if(typeof(a)=="number"){this.time=a}else{throw new SdpException("TypedTime.prototype.setTime() requires a number argument")}};TypedTime.prototype.getTime=function(){return this.time};TypedTime.prototype.setUnit=function(a){if(typeof(a)=="string"){this.unit=a}else{throw new SdpException("TypedTime.prototype.setUnit() requires string argument ")}};TypedTime.prototype.getUnit=function(){return this.unit};TypedTime.prototype.encode=function(){var a="";a+=this.time;if(this.unit!=null){a+=this.unit}return a};function RepeatField(){this.classname="RepeatField";this.fieldName=this.REPEAT_FIELD;this.repeatInterval=null;this.activeDuration=null;this.offsets=new Array()}RepeatField.prototype=new SDPField();RepeatField.prototype.constructor=RepeatField;RepeatField.prototype.setRepeatInterval=function(a){if(a instanceof TypedTime){this.repeatInterval=a}else{if(typeof(a)=="number"){if(a<0){throw new SdpException("RepeatField.setRepeatInterval() requires positive number object argument")}else{if(this.repeatInterval==null){this.repeatInterval=new TypedTime()}this.repeatInterval.setTime(a)}}else{throw SdpException("RepeatField.setRepeatInterval() requires number or TypedTime object argument")}}};RepeatField.prototype.setActiveDuration=function(a){if(a instanceof TypedTime){this.activeDuration=a}else{if(typeof(a)=="number"){if(a<0){throw new SdpException("RepeatField.setActiveDuration() requires positive number object argument")}else{if(this.activeDuration==null){this.activeDuration=new TypedTime()}this.activeDuration.setTime(a)}}else{throw SdpException("RepeatField.setActiveDuration() requires number or TypedTime object argument")}}};RepeatField.prototype.addOffset=function(a){if(a instanceof TypedTime){this.offsets.push(a)}else{throw SdpException("RepeatField.addOffset() requires TypedTime object argument")}};RepeatField.prototype.getOffsets=function(){return this.offsets};RepeatField.prototype.getRepeatInterval=function(){if(this.repeatInterval==null){return -1}else{return this.repeatInterval.getTime()}};RepeatField.prototype.getActiveDuration=function(){if(this.activeDuration==null){return -1}else{return this.activeDuration.getTime()}};RepeatField.prototype.getOffsetArray=function(){var a=new Array();for(var b=0;b<this.offsets.length;b++){var c=this.offsets[b];a[b]=c.getTime()}return a};RepeatField.prototype.setOffsetArray=function(c){if(c instanceof Array){for(var a=0;a<this.offsets.length;a++){var b=new TypedTime();b.setTime(c[a]);this.addOffset(b)}}else{throw SdpException("RepeatField.setOffsetArray() requires Array object argument")}};RepeatField.prototype.getTypedTime=function(){return true};RepeatField.prototype.setTypedTime=function(a){};RepeatField.prototype.encode=function(c){var b=this.REPEAT_FIELD;b+=this.repeatInterval.encode();b+=Separators.prototype.SP;b+=this.activeDuration.encode();for(var a=0;a<this.offsets.length;a++){var d=this.offsets[a];b+=Separators.prototype.SP;b+=d.encode()}b+=Separators.prototype.NEWLINE;return b};RepeatField.prototype.clone=function(){var a=new RepeatField();if(this.repeatInterval!=null){a.repeatInterval=this.repeatInterval.clone()}if(this.activeDuration!=null){a.activeDuration=this.activeDuration.clone()}if(this.offsets!=null){a.offsets=this.offsets.clone()}return a};function MediaDescription(){this.classname="MediaDescription";this.mediaField=null;this.informationField=null;this.connectionField=null;this.keyField=null;this.bandwidthFieldArray=new Array();this.attributeFieldArray=new Array()}MediaDescription.prototype.constructor=MediaDescription;MediaDescription.prototype.encode=function(){var b="";if(this.mediaField!=null){b+=this.mediaField.encode()}if(this.informationField!=null){b+=this.informationField.encode()}if(this.connectionField!=null){b+=this.connectionField.encode()}if(this.bandwidthFieldArray!=null){for(var a=0;a<this.bandwidthFieldArray.length;a++){b+=this.bandwidthFieldArray[a].encode()}}if(this.keyField!=null){b+=this.keyField.encode()}if(this.attributeFieldArray!=null){for(var a=0;a<this.attributeFieldArray.length;a++){b+=this.attributeFieldArray[a].encode()}}return b};MediaDescription.prototype.toString=function(){return this.encode()};MediaDescription.prototype.getMedia=function(){return this.mediaField};MediaDescription.prototype.getInfo=function(){return this.informationField};MediaDescription.prototype.getConnection=function(){return this.connectionField};MediaDescription.prototype.getKey=function(){return this.keyField};MediaDescription.prototype.getAttributes=function(){return this.attributeFieldArray};MediaDescription.prototype.getAttribute=function(a){if(typeof a=="string"){for(var b=0;b<this.attributeFieldArray.length;b++){if(a==this.attributeFieldArray[b].getAttribute().getName()){return this.attributeFieldArray[b].getAttribute().getValueAsObject()}}return null}else{throw new SdpException("MediaDescription.getAttribute() requires string object argument")}};MediaDescription.prototype.setMedia=function(a){if(a instanceof MediaField){this.mediaField=a}else{throw new SdpException("MediaDescription.setMedia() requires Mediafield object argument")}};MediaDescription.prototype.setInfo=function(a){if(a instanceof InformationField){this.informationField=a}else{throw new SdpException("MediaDescription.setInfo() requires InformationField object argument")}};MediaDescription.prototype.setConnection=function(a){if(a instanceof ConnectionField){this.connectionField=a}else{throw new SdpException("MediaDescription.setConnection() requires ConnectionField object argument")}};MediaDescription.prototype.addBandwidth=function(a){if(a instanceof BandwidthField){this.bandwidthFieldArray.push(a)}else{throw new SdpException("MediaDescription.addBandwidth() requires BandwidthField object argument")}};MediaDescription.prototype.setKey=function(a){if(a instanceof KeyField){this.keyField=a}else{throw new SdpException("MediaDescription.setKey() requires KeyField object argument")}};MediaDescription.prototype.setAttributes=function(a){if(a instanceof Array){for(var b=0;b<a.length;b++){var c=a[b];if(!(c instanceof AttributeField)){throw new SdpException("MediaDescription.setAttributes() requires Array of AttributeField object argument")}}this.attributeFieldArray=a}else{throw new SdpException("MediaDescription.setAttributes() requires Array object argument")}};MediaDescription.prototype.addAttribute=function(a){if(a instanceof AttributeField){this.attributeFieldArray.push(a)}else{throw new SdpException("MediaDescription.addAttribute()requires AttributeField object argument")}};MediaDescription.prototype.hasAttribute=function(a){if(typeof a=="string"){for(var b=0;b<this.attributeFieldArray.length;b++){if(this.attributeFieldArray[b].getName()==a){return true}}return false}else{throw new SdpException("MediaDescription.hasAttribute()requires string object name argument")}};MediaDescription.prototype.setAttribute=function(b,c){if(typeof b=="string"){var a=new AttributeField();a.setName(b);a.setValue(c);this.attributeFieldArray.push(a)}else{throw new SdpException("MediaDescription.setAttribute()requires string object name argument")}};MediaDescription.prototype.getBandwidth=function(a){if(typeof a=="string"){if(this.bandwidthFieldArray==null){return -1}else{for(var b=0;b<this.bandwidthFieldArray.length;b++){if(this.bandwidthFieldArray[b].getType()==a){return this.bandwidthFieldArray.getBandwidth()}}return -1}}else{throw new SdpException("MediaDescription.getBandwidth() requires string object name argument")}};MediaDescription.prototype.setBandwidth=function(a,c){if(typeof a=="string"){if(typeof c=="number"){for(var b=0;b<this.bandwidthFieldArray.length;b++){if(this.bandwidthFieldArray[b].getType()==a){this.bandwidthFieldArray[b].setBandwidth(c);return}}var d=new BandwidthField();d.setType(a);d.setBandwidth(c);this.bandwidthFieldArray.push(d)}else{throw new SdpException("MediaDescription.setBandwidth() requires number object value argument")}}else{throw new SdpException("MediaDescription.setBandwidth() requires string object name argument")}};MediaDescription.prototype.removeBandwidth=function(a){if(typeof(a)=="string"){if(this.bandwidthFieldArray!=null){for(var b=0;b<this.bandwidthFieldArray.length;b++){if(this.bandwidthFieldArray[b].getType()==a){this.bandwidthFieldArray.splice(b,1);break}}}}};MediaDescription.prototype.getDuplexity=function(){for(var a=0;a<this.attributeFieldArray.length;a++){var b=this.attributeFieldArray[a].getAttribute().getName().toLowerCase();if((b=="sendrecv")||(b=="recvonly")||(b=="sendonly")||(b=="inactive")){return b}}return null};MediaDescription.prototype.setDuplexity=function(b){if(typeof b=="string"){for(var c=0;c<this.attributeFieldArray.length;c++){var d=this.attributeFieldArray[c].getName().toLowerCase();if((d=="sendrecv")||(d=="recvonly")||(d=="sendonly")||(d=="inactive")){return}}var a=new AttributeField();a.setName(b);a.setValue(null);this.attributeFieldArray.push(a)}else{throw new SdpException("MediaDescription.setDuplexity() requires string object duplexity argument")}};MediaDescription.prototype.removeAttribute=function(a){if(typeof(a)=="string"){if(this.attributeFieldArray!=null){for(var b=0;b<this.attributeFieldArray.length;b++){if(this.attributeFieldArray[b].getName()==a){this.attributeFieldArray.slice(b,1);break}}}}else{throw new SdpException("MediaDescription.removeAttribute() requires string object argument")}};MediaDescription.prototype.getMimeTypes=function(){var g=this.getMedia();if(g!=null){var d=g.getMediaType();var f=g.getProtocol();var b=g.getMediaFormats(false);var e=new Array();for(var c=0;c<b.length;c++){var a=null;if(f=="RTP/AVP"){if(this.getAttribute(SdpConstants.RTPMAP)!=null){a=d+"/"+f}else{}}else{a=d+"/"+f}e.push(a)}return e}else{return null}};MediaDescription.prototype.getMimeParameters=function(){var a=new Array();var c=this.getAttribute("rate");if(c!=null){a.push(c)}var e=this.getAttribute("ptime");if(e!=null){a.push(e)}var b=this.getAttribute("maxptime");if(b!=null){a.push(b)}var d=this.getAttribute("ftmp");if(d!=null){a.push(d)}return a};MediaDescription.prototype.addDynamicPayloads=function(b,a){if(b instanceof Array&&a instanceof Array){if((b.length==0)||(a.length==0)){throw new SdpException("MediaDescription:addDynamicPayloads(): no dynamic payload")}else{if(b.length!=a.length){throw new SdpException("MediaDescription:addDynamicPayloads(): missing payload parameters")}else{for(var d=0;d<b.length;d++){var c=b[d];var e=a[d];this.setAttribute(c,e)}}}}else{throw new SdpException("MediaDescription.addDynamicPayloads() requires Array object arguments")}};MediaDescription.prototype.setPreconditionFields=function(a){this.preconditionFields.setPreconditions(a)};MediaDescription.prototype.setPreconditions=function(a){this.preconditionFields=a};MediaDescription.prototype.getPreconditionFields=function(){return this.preconditionFields.getPreconditions()};function TimeDescription(){this.classname="TimeDescription";if(arguments.length==1){if(arguments[0] instanceof TimeField){this.timeField=arguments[0]}else{throw new SdpException("TimeDescription():TimeDescription() requires TimeField object in argument")}}else{this.timeField=new TimeField()}this.repeatList=new Array()}TimeDescription.prototype.getTime=function(){return this.timeField};TimeDescription.prototype.setTime=function(a){if(a instanceof TimeField){this.timeField=a}else{throw new SdpException("TimeDescription.setTime() requires TimeField object argument")}};TimeDescription.prototype.getRepeatTimes=function(a){if(a){this.repeatList=new Array()}return this.repeatList};TimeDescription.prototype.setRepeatTimes=function(a){this.repeatList=a};TimeDescription.prototype.addRepeat=function(a){if(a instanceof RepeatField){this.repeatList.push(a)}else{throw new SdpException("TimeDescription.addRepeat() requires RepeatField object argument")}};TimeDescription.prototype.encode=function(){var a=this.timeField.encode();for(var c=0;c<this.repeatList.length;c++){var b=this.repeatList[c];a+=b.encode()}return a};function SessionDescription(){this.classname="SessionDescription";this.currentTimeDescription=null;this.currentMediaDescription=null;this.versionField=null;this.originField=null;this.sessionNameField=null;this.informationField=null;this.uriField=null;this.connectionField=null;this.keyField=null;this.timeFieldArray=null;this.mediaDescriptionArray=null;this.zoneAdjustments=null;this.emailFieldArray=null;this.phoneFieldArray=null;this.bandwidthFieldArray=null;this.attributeFieldArray=null;if(arguments.length==1){if(arguments[0] instanceof SessionDescription){this.copy(arguments[0])}else{throw new SdpException("SessionDescription.SessionDescription() requires SessionDescription object arguments")}}}SessionDescription.prototype=new SDPObject();SessionDescription.prototype.constructor=SessionDescription;SessionDescription.prototype.copy=function(ag){if(ag==null){return}var X=ag.getVersion();if(X!=null){this.setVersion(X.clone())}var w=ag.getOrigin();if(w!=null){this.setOrigin(w.clone())}var B=ag.getSessionName();if(B!=null){this.setSessionName(B.clone())}var r=ag.getInfo();if(r!=null){this.setInfo(r.clone())}var s=ag.getURI();if(s!=null){var d=new URIField();d.setURI(s.toString());this.setURI(d)}var W=ag.getConnection();if(W!=null){this.setConnection(W.clone())}var ac=ag.getKey();if(ac!=null){this.setKey(ac.clone())}var U=ag.getTimeDescriptions(false);if(U!=null){var Y=new Array();for(var ad=0;ad<U.length;ad++){var u=U[ad];var y=u.getTime().clone();var x=new TimeDescription(y);var C=u.getRepeatTimes(false);if(C!=null){for(var aa=0;aa<C.length;aa++){var h=C[aa];var c=h.clone();x.addRepeatField(c)}}Y.push(x)}this.setTimes(Y)}var b=ag.getEmails(false);if(b!=null){var a=new Array();for(var ad=0;ad<b.length;ad++){var ae=b[ad];var q=ae.clone();a.push(q)}this.setEmails(a)}var F=ag.getPhones(false);if(F!=null){var D=new Array();for(var ad=0;ad<F.length;ad++){var H=F[ad];var T=H.clone();D.push(T)}this.setPhones(D)}var ah=ag.getZoneAdjustments(false);if(ah!=null){var g=new Array();for(var ad=0;ad<g.length;ad++){var A=g[ad];var z=A.clone();g.push(z)}this.setZoneAdjustments(g)}var I=ag.getBandwidths(false);if(I!=null){var E=new Array();for(var ad=0;ad<I.length;ad++){var ab=I[ad];var p=ab.clone();E.push(p)}this.setBandwidths(E)}var L=ag.getAttributes(false);if(L!=null){var G=new Array();for(var ad=0;ad<L.length;ad++){var M=L[ad];var p=M.clone();G.push(p)}this.setAttributes(G)}var t=ag.getMediaDescriptions(false);if(t!=null){var J=new Array();for(var ad=0;ad<t.length;ad++){var k=t[ad];var S=new MediaDescription();var P=k.getMedia();if(P!=null){var N=new MediaField();N.setType(P.getType());N.setPort(P.getPort());N.setNports(P.getNports());N.setProto(P.getProto());var R=P.getFormats();if(R!=null){var Z=new Array();for(var aa=0;aa<R.length;aa++){var f=R[aa];Z.push(String.valueOf(f))}N.setFormats(Z)}S.setMedia(N)}var n=k.getInformation();if(n!=null){S.setInformation(n.clone())}var af=k.getConnection();if(af!=null){S.setConnection(af.clone())}var e=k.getBandwidths(false);if(e!=null){var m=new Array();for(var aa=0;aa<e.length;aa++){var K=e[aa];m.push(K.clone())}S.setBandwidths(m)}var V=k.getKey();if(V!=null){S.setKey(V.clone())}var l=k.getAttributeFields();if(l!=null){var v=new Array();for(var aa=0;aa<l.length;aa++){var ai=l[aa];v.push(ai.clone())}S.setAttribute(v)}J.push(S)}this.setMediaDescriptions(J)}};SessionDescription.prototype.addField=function(a){if(a!=null&&SDPField.prototype.isPrototypeOf(a)==true){if(a instanceof VersionField){this.versionField=a}else{if(a instanceof OriginField){this.originField=a}else{if(a instanceof SessionNameField){this.sessionNameField=a}else{if(a instanceof InformationField){if(this.currentMediaDescription!=null){this.currentMediaDescription.setInformation(a)}else{this.informationField=a}}else{if(a instanceof URIField){this.uriField=a}else{if(a instanceof ConnectionField){if(this.currentMediaDescription!=null){this.currentMediaDescription.setConnection(a)}else{this.connectionField=a}}else{if(a instanceof KeyField){if(this.currentMediaDescription!=null){this.currentMediaDescription.setKey(a)}else{this.keyField=a}}else{if(a instanceof EmailField){this.getEmails(true).push(a)}else{if(a instanceof PhoneField){this.getPhones(true).push(a)}else{if(a instanceof TimeField){this.currentTimeDescription=new TimeDescription(a);this.getTimeDescriptions(true).push(this.currentTimeDescription)}else{if(a instanceof RepeatField){if(this.currentTimeDescription==null){throw new new SdpException("SessionDescription.addField(): parsing error, no time atttribut specified")}else{this.currentTimeDescription.addRepeat(a)}}else{if(a instanceof BandwidthField){if(this.currentMediaDescription!=null){this.currentMediaDescription.addBandwidth(a)}else{this.getBandwidths(true).push(a)}}else{if(a instanceof AttributeField){if(this.currentMediaDescription!=null){var b=a;var c=b.getName();this.currentMediaDescription.addAttribute(a)}else{this.getAttributes(true).push(a)}}else{if(a instanceof MediaField){this.currentMediaDescription=new MediaDescription();this.getMediaDescriptions(true).push(this.currentMediaDescription);this.currentMediaDescription.setMedia(a)}}}}}}}}}}}}}}}else{throw new SdpException("SessionDescription.addField() requires SDPField object arguments")}};SessionDescription.prototype.clone=function(){try{return new SessionDescription(this)}catch(a){throw new CloneNotSupportedException()}};SessionDescription.prototype.getVersion=function(){return this.versionField};SessionDescription.prototype.setVersion=function(a){if(a instanceof VersionField){this.versionField=a}else{throw new SdpException("SessionDescription.setVersion() requires VersionField object argument")}};SessionDescription.prototype.getOrigin=function(){return this.originField};SessionDescription.prototype.setOrigin=function(a){if(a instanceof OriginField){this.originField=a}else{throw new SdpException("SessionDescription.setOrigin() requires OriginField object argument")}};SessionDescription.prototype.getSessionName=function(){return this.sessionNameField};SessionDescription.prototype.setSessionName=function(a){if(a instanceof SessionNameField){this.sessionNameField=a}else{throw new SdpException("SessionDescription.setSessionName() requires SessionNameField object argument")}};SessionDescription.prototype.getInfo=function(){return this.informationField};SessionDescription.prototype.setInfo=function(a){if(a instanceof InformationField){this.informationField=a}else{throw new SdpException("SessionDescription.setInfo() requires InformationField object argument")}};SessionDescription.prototype.getURI=function(){return this.uriField};SessionDescription.prototype.setURI=function(a){if(a instanceof URIField){this.uriField=a}else{throw new SdpException("SessionDescription.setURI() requires URIField object argument")}};SessionDescription.prototype.getEmails=function(a){if(this.emailFieldArray==null&&a){this.emailFieldArray=new Array()}return this.emailFieldArray};SessionDescription.prototype.setEmails=function(b){if(b instanceof Array){for(var c=0;c<b.length;c++){var a=b[c];if(!(a instanceof EmailField)){throw new SdpException("SessionDescription.setEmails() requires Array of EmailField object argument")}}this.emailFieldArray=b}else{throw new SdpException("SessionDescription.setEmails() requires Array object argument")}};SessionDescription.prototype.getPhones=function(a){if(this.phoneFieldArray==null){if(a){this.phoneFieldArray=new Array()}}return this.phoneFieldArray};SessionDescription.prototype.setPhones=function(a){if(a instanceof Array){for(var b=0;b<a.length;b++){var c=a[b];if(!(c instanceof PhoneField)){throw new SdpException("SessionDescription.setPhones() requires Array of PhoneField object argument")}}this.phoneFieldArray=a}else{throw new SdpException("SessionDescription.setPhones() requires Array object argument")}};SessionDescription.prototype.getTimeDescriptions=function(a){if(this.timeFieldArray==null){if(a){this.timeFieldArray=new Array()}}return this.timeFieldArray};SessionDescription.prototype.setTimes=function(a){if(a instanceof Array){for(var b=0;b<a.length;b++){var c=a[b];if(!(c instanceof TimeField)){throw new SdpException("SessionDescription.setTimes() requires Array of TimeField object argument")}}this.timeFieldArray=a}else{throw new SdpException("SessionDescription.setTimes() requires Array object argument")}};SessionDescription.prototype.getZoneAdjustments=function(a){if(this.zoneAdjustments==null){if(a){this.zoneAdjustments=new Array()}}return this.zoneAdjustments};SessionDescription.prototype.setZoneAdjustments=function(a){if(a instanceof Array){for(var b=0;b<a.length;b++){var c=a[b];if(!(c instanceof ZoneAdjustmentField)){throw new SdpException("SessionDescription.setZoneAdjustments() requires Array of ZoneAdjustmentField object argument")}}this.zoneAdjustments=a}else{throw new SdpException("SessionDescription.setZoneAdjustments() requires Array object argument")}};SessionDescription.prototype.getConnection=function(){return this.connectionField};SessionDescription.prototype.setConnection=function(a){if(a instanceof ConnectionField){this.connectionField=a}else{throw new SdpException("SessionDescription.setConnection() requires ConnectionField object argument")}};SessionDescription.prototype.getBandwidths=function(a){if(this.bandwidthFieldArray==null){if(a){this.bandwidthFieldArray=new Array()}}return this.bandwidthFieldArray};SessionDescription.prototype.setBandwidths=function(c){if(c instanceof Array){for(var b=0;b<c.length;b++){var a=c[b];if(!(a instanceof BandwidthField)){throw new SdpException("SessionDescription.setBandwidths() requires Array of BandwidthField object argument")}}this.bandwidthFieldArray=c}else{throw new SdpException("SessionDescription.setBandwidths() requires Array object argument")}};SessionDescription.prototype.getBandwidth=function(a){if(typeof(a)=="string"){if(this.bandwidthFieldArray!=null){for(var b=0;b<this.bandwidthFieldArray.length;b++){if(this.bandwidthFieldArray[b].getType()==a){return this.bandwidthFieldArray[b].getValue()}}}}else{throw new SdpException("SessionDescription.getBandwidth() requires string object argument")}return -1};SessionDescription.prototype.setBandwidth=function(b,d){if((typeof(b)=="string")&&(typeof(d)=="number")){if(this.bandwidthFieldArray!=null){for(var c=0;c<this.bandwidthFieldArray.length;c++){if(this.bandwidthFieldArray[c].getType()==b){this.bandwidthFieldArray[c].setBandwidth(d);return}}}else{this.bandwidthFieldArray=new Array()}var a=new BandwidthField();a.setType(b);a.setBandwidth(d);this.bandwidthFieldArray.push(a)}else{throw new SdpException("SessionDescription:setBandwidth() requires string and number arguments")}};SessionDescription.prototype.removeBandwidth=function(a){if(typeof(a)=="string"){if(this.bandwidthFieldArray!=null){for(var b=0;b<this.bandwidthFieldArray.length;b++){if(this.bandwidthFieldArray[b].getType()==a){this.bandwidthFieldArray.splice(b,1);break}}}}else{throw new SdpException("SessionDescription:setBandwidth() removeBandwidth require string argument")}};SessionDescription.prototype.getKey=function(){return this.keyField};SessionDescription.prototype.setKey=function(a){if(a instanceof KeyField){this.keyField=a}else{throw new SdpException("SessionDescription.setKey() requires KeyField object argument")}};SessionDescription.prototype.getAttribute=function(a){if(typeof(a)=="string"){if(this.attributeFieldArray==null){return null}for(var b=0;b<this.attributeFieldArray.length;b++){if(this.attributeFieldArray[b].getName()==a){return this.attributeFieldArray[b].getValue()}}return null}else{throw new SdpException("SessionDescription.getAttribute() requires string object argument")}};SessionDescription.prototype.getAttributes=function(a){if(this.attributeFieldArray==null){if(a){this.attributeFieldArray=new Array()}}return this.attributeFieldArray};SessionDescription.prototype.removeAttribute=function(a){if(typeof(a)=="string"){if(this.attributeFieldArray!=null){for(var b=0;b<this.attributeFieldArray.length;b++){if(this.attributeFieldArray[b].getName()==a){this.attributeFieldArray.slice(b,1);break}}}}else{throw new SdpException("SessionDescription.removeAttribute() requires string object argument")}};SessionDescription.prototype.setAttribute=function(b,d){if(typeof(b)=="string"){if(d==null){throw new SdpException("SessionDescription.setAttribute() requires not null value object argument")}if(this.attributeFieldArray==null){this.attributeFieldArray=new Array()}for(var c=0;c<this.attributeFieldArray.length;c++){if(this.attributeFieldArray[c].getName()==b){this.attributeFieldArray[c].setValue(d);return}}var a=new AttributeField();a.setName(b);a.setValue(d);this.attributeFieldArray.push(a)}else{throw new SdpException("SessionDescription.setAttribute() requires string argument for name")}};SessionDescription.prototype.setAttributes=function(a){if(a instanceof Array){for(var b=0;b<a.length;b++){var c=a[b];if(!(c instanceof AttributeField)){throw new SdpException("SessionDescription.setAttributes() requires Array of AttributeField object argument")}}this.attributeFieldArray=a}else{throw new SdpException("SessionDescription.setAttributes() requires Array object argument")}};SessionDescription.prototype.getMediaDescriptions=function(a){if(this.mediaDescriptionArray==null){if(a){this.mediaDescriptionArray=new Array()}}return this.mediaDescriptionArray};SessionDescription.prototype.setMediaDescriptions=function(c){if(c instanceof Array){for(var a=0;a<c.length;a++){var b=c[a];if(!(b instanceof MediaDescription)){throw new SdpException("SessionDescription.setMediaDescriptions() requires Array of MediaDescription object argument")}}this.mediaDescriptionArray=c}else{throw new SdpException("SessionDescription.setAttributes() requires Array of MediaDescription object argument")}};SessionDescription.prototype.encodeSDPFieldArray=function(c){var b="";for(var a=0;a<c.length;a++){b+=c[a].encode()}return b};SessionDescription.prototype.encode=function(){var a="";a+=this.versionField==null?"":this.versionField.encode();a+=(this.originField==null)?"":this.originField.encode();a+=this.sessionNameField==null?"":this.sessionNameField.encode();a+=this.informationField==null?"":this.informationField.encode();a+=this.uriField==null?"":this.uriField.encode();a+=this.emailFieldArray==null?"":this.encodeSDPFieldArray(this.emailFieldArray);a+=this.phoneFieldArray==null?"":this.encodeSDPFieldArray(this.phoneFieldArray);a+=this.connectionField==null?"":this.connectionField.encode();a+=this.bandwidthFieldArray==null?"":this.encodeSDPFieldArray(this.bandwidthFieldArray);a+=this.timeFieldArray==null?"":this.encodeSDPFieldArray(this.timeFieldArray);a+=this.zoneAdjustments==null?"":this.encodeSDPFieldArray(this.zoneAdjustments);a+=this.keyField==null?"":this.keyField.encode();a+=this.attributeFieldArray==null?"":this.encodeSDPFieldArray(this.attributeFieldArray);a+=this.mediaDescriptionArray==null?"":this.encodeSDPFieldArray(this.mediaDescriptionArray);return a};function SDPParser(){this.classname="SDPParser"}SDPParser.prototype.constructor=SDPParser;SDPParser.prototype.parse=function(b){if(typeof b=="string"){var f=new SessionDescription();var a=0;var i=null;var d=b.trim()+"\r\n";while(a<d.length){var g=d.indexOf("\n",a);var c=d.indexOf("\r",a);if(g>0&&c<0){i=d.substring(a,g);a=g+1}else{if(g<0&&c>0){i=d.substring(a,c);a=c+1}else{if(g>0&&c>0){if(g>c){i=d.substring(a,c);if(g==c+1){a=g+1}else{a=c+1}}else{i=d.substring(a,g);if(c==g+1){a=c+1}else{a=g+1}}}else{if(g<0&&c<0){break}}}}var h=SDPParserFactory.prototype.createParser(i);var e=h.parse(i);f.addField(e)}return f}else{throw new SdpException("SDPParser.parse() requires string object argument")}};SDPParser.prototype.parseNameValue=function(f){if(f==null){var i=this.parseNameValue("=");return i}else{this.lexer.match(LexerCore.prototype.ID);var a=this.lexer.getNextToken();this.lexer.SPorHT();try{var e=false;var c=this.lexer.lookAhead(0);if(c==f){this.lexer.consume(1);this.lexer.SPorHT();var g=null;var d=false;if(this.lexer.lookAhead(0)=='"'){g=this.lexer.quotedString();e=true}else{this.lexer.match(LexerCore.prototype.ID);var h=this.lexer.getNextToken();g=h.tokenValue;if(g==null){g="";d=true}}var i=new NameValue(a.tokenValue,g,d);if(e){i.setQuotedValue()}return i}else{i=new NameValue(a.tokenValue,"",true);return i}}catch(b){console.error("SDPParser:parseNameValue(): catched exception:"+b);i=new NameValue(a.tokenValue,null,false);return i}}return i};function VersionFieldParser(){this.classname="VersionFieldParser"}VersionFieldParser.prototype=new SDPParser();VersionFieldParser.prototype.constructor=VersionFieldParser;VersionFieldParser.prototype.parse=function(b){if(typeof b=="string"){try{this.lexer=new LexerCore("charLexer",b);this.lexer.match("v");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var d=new VersionField();this.lexer.match(LexerCore.prototype.ID);var a=this.lexer.getNextToken();d.setVersion(parseInt(a.getTokenValue()));this.lexer.SPorHT();return d}catch(c){throw new SdpException("VersionFieldParser.parse(): parsing exception:"+this.lexer.getBuffer()+"at "+this.lexer.getPtr())}}else{throw new SdpException("VersionFieldParser.parse() requires string object argument")}};function SessionNameFieldParser(){this.classname="SessionNameFieldParser"}SessionNameFieldParser.prototype=new SDPParser();SessionNameFieldParser.prototype.constructor=SessionNameFieldParser;SessionNameFieldParser.prototype.parse=function(d){if(typeof d=="string"){try{this.lexer=new LexerCore("charLexer",d);this.lexer.match("s");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var a=new SessionNameField();var c=this.lexer.getRest();a.setSessionName(c==null?"":c.trim());return a}catch(b){throw new SdpException("SessionNameFieldParser.parse(): parsing exception:"+this.lexer.getBuffer()+"at "+this.lexer.getPtr())}}else{throw new SdpException("SessionNameFieldParser.parse() requires string object argument")}};function AttributeFieldParser(){this.classname="AttributeFieldParser"}AttributeFieldParser.prototype=new SDPParser();AttributeFieldParser.prototype.constructor=AttributeFieldParser;AttributeFieldParser.prototype.parse=function(c){if(typeof c=="string"){this.lexer=new LexerCore("charLexer",c);try{var d=new AttributeField();this.lexer.match("a");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var f=this.lexer.markInputPosition();try{var a=this.lexer.getNextToken(":");this.lexer.consume(1);var e=this.lexer.getRest();if(e!=null){e.trim()}d.setName(a);d.setValue(e)}catch(b){this.lexer.rewindInputPosition(f);var a=this.lexer.getRest();if(a==null){throw new ParseException(this.lexer.getBuffer(),this.lexer.getPtr())}d.setName(a);d.setValue(null)}this.lexer.SPorHT();return d}catch(b){throw new SdpException("AttributeFieldParser.parse(): parsing exception:"+this.lexer.getBuffer(),this.lexer.getPtr())}}else{throw new SdpException("AttributeFieldParser.parse() requires string object argument")}};function BandwidthFieldParser(){this.classname="BandwidthFieldParser"}BandwidthFieldParser.prototype=new SDPParser();BandwidthFieldParser.prototype.constructor=BandwidthFieldParser;BandwidthFieldParser.prototype.parse=function(d){if(typeof d=="string"){this.lexer=new LexerCore("charLexer",d);try{this.lexer.match("b");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var b=new BandwidthField();var a=this.parseNameValue(":");b.setBandwidth(parseInt(a.getValueAsObject()));b.setType(a.getName());this.lexer.SPorHT();return b}catch(c){throw new SdpException("BandwidthFieldParser.parse(): parsing exception:"+this.lexer.getBuffer(),this.lexer.getPtr())}}else{throw new SdpException("BandwidthFieldParser.parse() requires string object argument")}};function ConnectionFieldParser(){this.classname="ConnectionFieldParser"}ConnectionFieldParser.prototype=new SDPParser();ConnectionFieldParser.prototype.constructor=ConnectionFieldParser;ConnectionFieldParser.prototype.parse=function(f){if(typeof f=="string"){this.lexer=new LexerCore("charLexer",f);try{this.lexer.match("c");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var d=new ConnectionField();this.lexer.match(LexerCore.prototype.ID);this.lexer.SPorHT();var b=this.lexer.getNextToken();d.setNetworkType(b.getTokenValue());this.lexer.match(LexerCore.prototype.ID);this.lexer.SPorHT();b=this.lexer.getNextToken();d.setAddressType(b.getTokenValue());this.lexer.SPorHT();var c=this.lexer.getRest();var e=this.parseConnectionAddress(c.trim());d.setAddress(e);return d}catch(a){throw new SdpException("ConnectionFieldParser.parse(): parsing exception:"+this.lexer.getBuffer(),this.lexer.getPtr())}}else{throw new SdpException("ConnectionFieldParser.parse() requires string object argument")}};ConnectionFieldParser.prototype.parseConnectionAddress=function(e){var f=new ConnectionAddress();var d=e.indexOf("/");if(d!=-1){f.setAddress(new Host(e.substring(0,d)));var c=e.indexOf("/",d+1);if(c!=-1){var a=e.substring(d+1,c);f.setTtl(parseInt(a.trim()));var b=e.substring(c+1);f.setPort(parseInt(b.trim()))}else{var a=e.substring(d+1);f.setTtl(Integer.parseInt(a.trim()))}}else{f.setHost(new Host(e))}return f};function EmailFieldParser(){this.classname="EmailFieldParser"}EmailFieldParser.prototype=new SDPParser();EmailFieldParser.prototype.constructor=EmailFieldParser;EmailFieldParser.prototype.parse=function(c){if(typeof c=="string"){try{this.lexer=new LexerCore("charLexer",c);this.lexer.match("e");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var a=new EmailField();var e=this.lexer.getRest();var b=this.parseDisplayName(e.trim());if(b!=null){a.setDisplayName(b)}a.setEmail(this.parseEmail(e));return a}catch(d){throw new SdpException("EmailFieldParser.parse(): parsing exception:"+this.lexer.getBuffer(),this.lexer.getPtr())}}else{throw new SdpException("EmailFieldParser.parse() requires string object argument")}};EmailFieldParser.prototype.parseDisplayName=function(d){var b=d.indexOf("(");if(b!=-1){var a=d.indexOf(")");return d.substring(b+1,a)}else{var c=d.indexOf("<");if(c!=-1){return d.substring(0,c)}else{}}return null};EmailFieldParser.prototype.parseEmail=function(e){var c=e.indexOf("(");if(c!=-1){return e.substring(0,c)}else{var d=e.indexOf("<");if(d!=-1){var a=e.indexOf(">");return e.substring(d+1,a)}else{var b=e.indexOf("\n");if(b!=-1){return e.substring(0,b)}else{}}}return null};function InformationFieldParser(){this.classname="InformationFieldParser"}InformationFieldParser.prototype=new SDPParser();InformationFieldParser.prototype.constructor=InformationFieldParser;InformationFieldParser.prototype.parse=function(b){if(typeof b=="string"){try{this.lexer=new LexerCore("charLexer",b);this.lexer.match("i");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var c=new InformationField();c.setInformation(this.lexer.getRest().trim());return c}catch(a){throw new SdpException("InformationFieldParser.parse(): parsing exception:"+this.lexer.getBuffer(),this.lexer.getPtr())}}else{throw new SdpException("InformationFieldParser.parse() requires string object argument")}};function KeyFieldParser(){this.classname="KeyFieldParser"}KeyFieldParser.prototype=new SDPParser();KeyFieldParser.prototype.constructor=KeyFieldParser;KeyFieldParser.prototype.parse=function(d){if(typeof d=="string"){try{this.lexer=new LexerCore("charLexer",d);this.lexer.match("k");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var g=new KeyField();var a=new NameValue();var h=this.lexer.markInputPosition();try{var b=this.lexer.getNextToken(":");this.lexer.consume(1);var f=this.lexer.getRest();a=new NameValue(b.trim(),f.trim())}catch(c){this.lexer.rewindInputPosition(h);var e=this.lexer.getRest();if(e==null){throw SdpException("KeyFieldParser.parse(): parsing exception:"+this.lexer.getBuffer()+"at "+this.lexer.getPtr())}a=new NameValue(e.trim(),null)}g.setMethod(a.getName());g.setKey(a.getValueAsObject());this.lexer.SPorHT();return g}catch(c){throw new SdpException("KeyFieldParser.parse(): parsing exception:"+this.lexer.getBuffer()+"at "+this.lexer.getPtr())}}else{throw new SdpException("KeyFieldParser.parse() requires string object argument")}};function OriginFieldParser(){this.classname="OriginFieldParser"}OriginFieldParser.prototype=new SDPParser();OriginFieldParser.prototype.constructor=OriginFieldParser;OriginFieldParser.prototype.parse=function(j){if(typeof j=="string"){try{this.lexer=new LexerCore("charLexer",j);var k=new OriginField();this.lexer.match("o");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var g=this.lexer.getNextToken(" ");k.setUserName(g);this.lexer.SPorHT();this.lexer.match(LexerCore.prototype.ID);var b=this.lexer.getNextToken();var f=b.getTokenValue();if(f.length>18){f=f.substring(f.length-18)}k.setSessionId(f);this.lexer.SPorHT();this.lexer.match(LexerCore.prototype.ID);var h=this.lexer.getNextToken();var i=h.getTokenValue();if(i.length>18){i=i.substring(i.length-18)}k.setSessionVersion(i);this.lexer.SPorHT();this.lexer.match(LexerCore.prototype.ID);var c=this.lexer.getNextToken();k.setNetworkType(c.getTokenValue());this.lexer.SPorHT();this.lexer.match(LexerCore.prototype.ID);var d=this.lexer.getNextToken();k.setAddressType(d.getTokenValue());this.lexer.SPorHT();var e=this.lexer.getRest();var m=new HostNameParser(e);var l=m.host();k.setHost(l);return k}catch(a){throw new SdpException("OriginFieldParser.parse(): parsing exception:"+this.lexer.getBuffer()+"at "+this.lexer.getPtr())}}else{throw new SdpException("OriginFieldParser.parse() requires string object argument")}};function PhoneFieldParser(){this.classname="PhoneFieldParser"}PhoneFieldParser.prototype=new SDPParser();PhoneFieldParser.prototype.constructor=PhoneFieldParser;PhoneFieldParser.prototype.parse=function(b){if(typeof b=="string"){try{this.lexer=new LexerCore("charLexer",b);this.lexer.match("p");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var e=new PhoneField();var d=this.lexer.getRest();var a=this.parseDisplayName(d.trim());if(a!=null){e.setName(a)}e.setPhoneNumber(this.parsePhoneNumber(d));return e}catch(c){throw new SdpException("PhoneFieldParser.parse(): parsing exception:"+this.lexer.getBuffer()+"at "+this.lexer.getPtr())}}else{throw new SdpException("PhoneFieldParser.parse() requires string object argument")}};PhoneFieldParser.prototype.parseDisplayName=function(c){var b=c.indexOf("(");if(b!=-1){var a=c.indexOf(")");return c.substring(b+1,a)}else{var d=c.indexOf("<");if(d!=-1){return c.substring(0,d)}else{return null}}};PhoneFieldParser.prototype.parsePhoneNumber=function(d){var b=d.indexOf("(");if(b!=-1){return d.substring(0,b).trim()}else{var c=d.indexOf("<");if(c!=-1){var a=d.indexOf(">");return d.substring(c+1,a)}else{return d.trim()}}};function URIFieldParser(){this.classname="URIFieldParser"}URIFieldParser.prototype=new SDPParser();URIFieldParser.prototype.constructor=URIFieldParser;URIFieldParser.prototype.parse=function(c){if(typeof c=="string"){try{this.lexer=new LexerCore("charLexer",c);this.lexer.match("u");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var a=new URIField();a.setURI(this.lexer.getRest().trim());return a}catch(b){throw new SdpException("URIFieldParser.parse(): parsing exception:"+this.lexer.getBuffer()+"at "+this.lexer.getPtr())}}else{throw new SdpException("URIFieldParser.parse() requires string object argument")}};function TimeFieldParser(){this.classname="TimeFieldParser"}TimeFieldParser.prototype=new SDPParser();TimeFieldParser.prototype.constructor=TimeFieldParser;TimeFieldParser.prototype.parse=function(c){if(typeof c=="string"){try{this.lexer=new LexerCore("charLexer",c);this.lexer.match("t");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var b=new TimeField();b.setStartTime(this.parseTime());this.lexer.SPorHT();b.setStopTime(this.parseTime());return b}catch(a){throw new SdpException("TimeFieldParser.parse(): parsing exception:"+this.lexer.getBuffer()+"at "+this.lexer.getPtr())}}else{throw new SdpException("TimeFieldParser.parse() requires string object argument")}};TimeFieldParser.prototype.parseTime=function(){var a=this.lexer.number();if(a.length>18){a=a.substring(a.length-18)}return parseInt(a)};function RepeatFieldParser(){this.classname="RepeatFieldParser"}RepeatFieldParser.prototype=new SDPParser();RepeatFieldParser.prototype.constructor=RepeatFieldParser;RepeatFieldParser.prototype.parse=function(a){if(typeof a=="string"){try{this.lexer=new LexerCore("charLexer",a);this.lexer.match("r");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();var c=new RepeatField();this.lexer.match(LexerCore.prototype.ID);var f=this.lexer.getNextToken();this.lexer.SPorHT();var d=this.parseTypedTime(f.getTokenValue());c.setRepeatInterval(d);this.lexer.match(LexerCore.prototype.ID);var h=this.lexer.getNextToken();this.lexer.SPorHT();d=this.parseTypedTime(h.getTokenValue());c.setActiveDuration(d);while(this.lexer.hasMoreChars()){var g=this.lexer.lookAhead(0);if(g=="\n"||g=="\r"){break}this.lexer.match(LexerCore.prototype.ID);var e=this.lexer.getNextToken();this.lexer.SPorHT();d=this.parseTypedTime(e.getTokenValue());c.addOffset(d)}return c}catch(b){throw new SdpException("RepeatFieldParser.parse(): parsing exception:"+this.lexer.getBuffer()+"at "+this.lexer.getPtr())}}else{throw new SdpException("RepeatFieldParser.parse() requires string object argument")}};RepeatFieldParser.prototype.parseTypedTime=function(c){var b=new TypedTime();if(c.endsWith("d")){b.setUnit("d");var a=c.replace("d"," ");b.setTime(parseInt(a.trim()))}else{if(c.endsWith("h")){b.setUnit("h");var a=c.replace("h"," ");b.setTime(parseInt(a.trim()))}else{if(c.endsWith("m")){b.setUnit("m");var a=c.replace("m"," ");b.setTime(parseInt(a.trim()))}else{b.setUnit("s");if(c.endsWith("s")){var a=c.replace("s"," ");b.setTime(parseInt(a.trim()))}else{b.setTime(parseInt(c.trim()))}}}}return b};function MediaFieldParser(){this.classname="MediaFieldParser"}MediaFieldParser.prototype=new SDPParser();MediaFieldParser.prototype.constructor=MediaFieldParser;MediaFieldParser.prototype.parse=function(m){if(typeof m=="string"){try{this.lexer=new LexerCore("charLexer",m);var j=new MediaField();this.lexer.match("m");this.lexer.SPorHT();this.lexer.match("=");this.lexer.SPorHT();this.lexer.match(LexerCore.prototype.ID);var b=this.lexer.getNextToken();j.setType(b.getTokenValue());this.lexer.SPorHT();this.lexer.match(LexerCore.prototype.ID);var e=this.lexer.getNextToken();j.setPort(parseInt(e.getTokenValue()));this.lexer.SPorHT();if(this.lexer.hasMoreChars()&&this.lexer.lookAhead(1)=="\n"){return j}if(this.lexer.lookAhead(0)=="/"){this.lexer.consume(1);this.lexer.match(LexerCore.prototype.ID);var i=this.lexer.getNextToken();j.setNports(parseInt(i.getTokenValue()));this.lexer.SPorHT()}this.lexer.match(LexerCore.prototype.ID);var h=this.lexer.getNextToken();var g=h.getTokenValue();while(this.lexer.lookAhead(0)=="/"){this.lexer.consume(1);this.lexer.match(LexerCore.prototype.ID);var a=this.lexer.getNextToken();g=g+"/"+a.getTokenValue()}j.setProtocol(g);this.lexer.SPorHT();var f=new Array();while(this.lexer.hasMoreChars()){var d=this.lexer.lookAhead(0);if(d=="\n"||d=="\r"){break}this.lexer.SPorHT();this.lexer.match(LexerCore.prototype.ID);var l=this.lexer.getNextToken();this.lexer.SPorHT();var k=l.getTokenValue().trim();if(!k==""){f.push(k)}}j.setFormats(f);return j}catch(c){throw new SdpException("MediaFieldParser.parse(): parsing exception:"+this.lexer.getBuffer()+"at "+this.lexer.getPtr())}}else{throw new SdpException("MediaFieldParser.parse() requires string object argument")}};function SDPParserFactory(){this.classname="SDPParserFactory"}SDPParserFactory.prototype.constructor=SDPParserFactory;SDPParserFactory.prototype.parserTable=new Array();SDPParserFactory.prototype.parserTable.a=AttributeFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.b=BandwidthFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.c=ConnectionFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.e=EmailFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.i=InformationFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.k=KeyFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.m=MediaFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.o=OriginFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.p=PhoneFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.v=VersionFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.r=RepeatFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.s=SessionNameFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.t=TimeFieldParser.prototype.constructor;SDPParserFactory.prototype.parserTable.u=SDPParserFactory.prototype.constructor;SDPParserFactory.prototype.createParser=function(c){if(typeof c=="string"){try{var b=c.indexOf(Separators.prototype.EQUALS);if(b==-1){throw new SdpException("SDPParserFactory.createParser(): parsing exception")}else{var d=c.substring(0,b).trim()}if(this.parserTable[d[0]]!=null){return new this.parserTable[d[0]]}else{throw new SdpException("SDPParserFactory.createParse(): could not find parser for "+d)}}catch(a){throw new SdpException("SDPParserFactory.createParse(): could not find parser for "+d)}}else{throw new SdpException("SDPParserFactory.createParser() requires string object argument")}};function GenericURI(b){this.classname="GenericURI";this.uriString=null;this.scheme=null;if(b!=null){this.uriString=b;var a=b.indexOf(":");this.scheme=b.substring(0,a)}}GenericURI.prototype.SIP="sip";GenericURI.prototype.SIPS="sips";GenericURI.prototype.POSTDIAL="postdial";GenericURI.prototype.PHONE_CONTEXT_TAG="context-tag";GenericURI.prototype.ISUB="isub";GenericURI.prototype.PROVIDER_TAG="provider-tag";GenericURI.prototype.TEL="tel";GenericURI.prototype.encode=function(){return this.uriString};GenericURI.prototype.encodeBuffer=function(a){a=a+this.uriString;return a};GenericURI.prototype.toString=function(){return this.encode()};GenericURI.prototype.getScheme=function(){return this.scheme};GenericURI.prototype.isSipURI=function(){if(this instanceof SipUri){return true}else{return false}};GenericURI.prototype.equals=function(a){if(this==a){return true}else{if(a instanceof URI){var b=a;if(this.toString().toLowerCase()==b.toString().toLowerCase()){return true}else{return false}}}return false};GenericURI.prototype.hashCode=function(){var d=0;var a=this.toString();if(!(a==null||a.value=="")){for(var b=0;b<a.length;b++){d=d*31+a.charCodeAt(b);var c=2147483647;var e=-2147483648;if(d>c||d<e){d&=4294967295}}}return d};function UserInfo(){this.user=null;this.password=null;this.userType=null;this.classname="UserInfo"}UserInfo.prototype.TELEPHONE_SUBSCRIBER=1;UserInfo.prototype.USER=2;UserInfo.prototype.COLON=":";UserInfo.prototype.POUND="#";UserInfo.prototype.SEMICOLON=";";UserInfo.prototype.equals=function(b){if(b.classname!="UserInfo"){return false}var a=new UserInfo();a=b;if(this.userType!=a.userType){return false}if(this.user!=a.user){return false}if(this.password!=null&&a.password==null){return false}if(a.password!=null&&this.password==null){return false}return this.password==a.password};UserInfo.prototype.encode=function(){return this.encodeBuffer("").toString()};UserInfo.prototype.encodeBuffer=function(a){var b=null;if(this.password!=null){b=a+this.user+this.COLON+this.password}else{b=a+this.user}return b};UserInfo.prototype.clearPassword=function(){this.password=null};UserInfo.prototype.getUserType=function(){return this.userType};UserInfo.prototype.getUser=function(){return this.user};UserInfo.prototype.setUser=function(a){this.user=a;if(a!=null&&(a.indexOf(this.POUND)>=0||a.indexOf(this.SEMICOLON)>=0)){this.setUserType(this.TELEPHONE_SUBSCRIBER)}else{this.setUserType(this.USER)}};UserInfo.prototype.getPassword=function(){return this.password};UserInfo.prototype.setPassword=function(a){this.password=a};UserInfo.prototype.setUserType=function(a){if(a!=this.USER&&a!=this.TELEPHONE_SUBSCRIBER){console.error("UserInfo:setUserType(): parameter not in range");throw"UserInfo:setUserType(): parameter not in range"}this.userType=a};function Authority(){this.classname="Authority";this.userInfo=null;this.hostPort=new HostPort()}Authority.prototype.AT="@";Authority.prototype.encode=function(){return this.encodeBuffer("")};Authority.prototype.encodeBuffer=function(a){if(this.userInfo!=null){a=this.userInfo.encodeBuffer(a);a=a+this.AT;a=this.hostPort.encodeBuffer(a)}else{a=this.hostPort.encodeBuffer(a)}return a};Authority.prototype.equals=function(a){if(a==null){return false}if(a.classname!=this.classname){return false}var b=a;if(this.hostPort!=b.hostPort){return false}if(this.userInfo!=null&&b.userInfo!=null){if(this.userInfo!=b.userInfo){return false}}return true};Authority.prototype.getHostPort=function(){return this.hostPort};Authority.prototype.getUserInfo=function(){return this.userInfo};Authority.prototype.getPassword=function(){if(this.userInfo==null){return null}else{return this.userInfo.password}};Authority.prototype.getUser=function(){return this.userInfo!=null?this.userInfo.user:null};Authority.prototype.getHost=function(){if(this.hostPort==null){return null}else{return this.hostPort.getHost()}};Authority.prototype.getPort=function(){if(this.hostPort==null){return -1}else{return this.hostPort.getPort()}};Authority.prototype.removePort=function(){if(this.hostPort!=null){this.hostPort.removePort()}};Authority.prototype.setPassword=function(a){if(this.userInfo==null){this.userInfo=new UserInfo()}this.userInfo.setPassword(a)};Authority.prototype.setUser=function(a){if(this.userInfo==null){this.userInfo=new UserInfo()}this.userInfo.setUser(a)};Authority.prototype.setHost=function(a){if(this.hostPort==null){this.hostPort=new HostPort()}this.hostPort.setHost(a)};Authority.prototype.setPort=function(a){if(this.hostPort==null){this.hostPort=new HostPort()}this.hostPort.setPort(a)};Authority.prototype.setHostPort=function(a){this.hostPort=a};Authority.prototype.setUserInfo=function(a){this.userInfo=a};Authority.prototype.removeUserInfo=function(){this.userInfo=null};Authority.prototype.hashCode=function(){if(this.hostPort==null){console.error("Authority:hashCode(): null hostPort cannot compute hashcode");throw"Authority:hashCode(): null hostPort cannot compute hashcode"}return this.hostPort.encode().hashCode()};function TelephoneNumber(){this.classname="TelephoneNumber";this.isglobal=null;this.phoneNumber=null;this.parameters=new NameValueList()}TelephoneNumber.prototype.POSTDIAL="postdial";TelephoneNumber.prototype.PHONE_CONTEXT_TAG="context-tag";TelephoneNumber.prototype.ISUB="isub";TelephoneNumber.prototype.PROVIDER_TAG="provider-tag";TelephoneNumber.prototype.SEMICOLON=";";TelephoneNumber.prototype.deleteParm=function(a){this.parameters.delet(a)};TelephoneNumber.prototype.getPhoneNumber=function(){return this.phoneNumber};TelephoneNumber.prototype.getPostDial=function(){return this.parameters.getValue(this.POSTDIAL)};TelephoneNumber.prototype.getIsdnSubaddress=function(){return this.parameters.getValue(this.ISUB)};TelephoneNumber.prototype.hasPostDial=function(){if(this.parameters.getValue(this.POSTDIAL)!=null){return true}else{return false}};TelephoneNumber.prototype.hasParm=function(a){if(this.parameters.hasNameValue(a)){return true}else{return false}};TelephoneNumber.prototype.hasIsdnSubaddress=function(){if(this.hasParm(this.ISUB)){return true}else{return false}};TelephoneNumber.prototype.isGlobal=function(){return this.isglobal};TelephoneNumber.prototype.removePostDial=function(){this.parameters.delet(this.POSTDIAL)};TelephoneNumber.prototype.removeIsdnSubaddress=function(){this.deleteParm(this.ISUB)};TelephoneNumber.prototype.setParameters=function(a){this.parameters=a};TelephoneNumber.prototype.setGlobal=function(a){this.isglobal=a};TelephoneNumber.prototype.setPostDial=function(b){var a=new NameValue(this.POSTDIAL,b);this.parameters.set_nv(a)};TelephoneNumber.prototype.setParm=function(b,c){var a=new NameValue(b,c);this.parameters.set_nv(a)};TelephoneNumber.prototype.setIsdnSubaddress=function(a){this.setParm(this.ISUB,a)};TelephoneNumber.prototype.setPhoneNumber=function(a){this.phoneNumber=a};TelephoneNumber.prototype.encode=function(){return this.encodeBuffer("").toString()};TelephoneNumber.prototype.encodeBuffer=function(a){if(this.isglobal){a=a+"+"}a=a+this.phoneNumber;if(this.parameters.hmap.length!=0){a=a+this.SEMICOLON;a=this.parameters.encodeBuffer(a)}return a};TelephoneNumber.prototype.getParameter=function(a){var b=this.parameters.getValue(a);if(b==null){return null}if(b instanceof GenericObject){return b.encode()}else{return b.toString()}};TelephoneNumber.prototype.getParameterNames=function(){return this.parameters.getNames()};TelephoneNumber.prototype.removeParameter=function(a){this.parameters.delet(a)};TelephoneNumber.prototype.setParameter=function(b,c){var a=new NameValue(b,c);this.parameters.set_nv(a)};TelephoneNumber.prototype.getParameters=function(){return this.parameters};function SipUri(){this.classname="SipUri";this.authority=new Authority();this.uriParms=new NameValueList();this.qheaders=new NameValueList;this.telephoneSubscriber=new TelephoneNumber();this.scheme="sip";this.qheaders.setSeparator("&")}SipUri.prototype=new GenericURI();SipUri.prototype.constructor=SipUri;SipUri.prototype.SIP="sip";SipUri.prototype.SIPS="sips";SipUri.prototype.COLON=":";SipUri.prototype.SEMICOLON=";";SipUri.prototype.QUESTION="?";SipUri.prototype.AT="@";SipUri.prototype.METHOD="method";SipUri.prototype.USER="user";SipUri.prototype.PHONE="phone";SipUri.prototype.TTL="ttl";SipUri.prototype.MADDR="maddr";SipUri.prototype.TRANSPORT="transport";SipUri.prototype.LR="lr";SipUri.prototype.GRUU="gr";SipUri.prototype.setScheme=function(a){if(a.toLowerCase()!=this.SIP&&a.toLowerCase()!=this.SIPS){console.error("SipUri:setScheme(): bad scheme "+a);throw"SipUri:setScheme(): bad scheme "+a}this.scheme=a.toLowerCase()};SipUri.prototype.getScheme=function(){return this.scheme};SipUri.prototype.clearUriParms=function(){this.uriParms=new NameValueList()};SipUri.prototype.clearPassword=function(){if(this.authority!=null){var a=this.authority.getUserInfo();if(a!=null){a.clearPassword()}}};SipUri.prototype.getAuthority=function(){return this.authority};SipUri.prototype.clearQheaders=function(){this.qheaders=new NameValueList()};SipUri.prototype.equals=function(k){if(k==this){return true}if(k instanceof SipUri){var q=this;var p=k;if(q.isSecure()^p.isSecure()){return false}if(q.getUser()==null^p.getUser()==null){return false}if(q.getUserPassword()==null^p.getUserPassword()==null){return false}if(q.getUser()!=null&&(q.getUser()!=p.getUser())){return false}if(q.getUserPassword()!=null&&(q.getUserPassword()!=p.getUserPassword())){return false}if(q.getHost()==null^p.getHost()==null){return false}if(q.getHost()!=null&&!q.getHost().equalsIgnoreCase(p.getHost())){return false}if(q.getPort()!=p.getPort()){return false}var l=q.getParameterNames();for(var g=0;g<l.length;g++){var f=l[g];var u=q.getParameter(f);var s=p.getParameter(f);if(u!=null&&s!=null&&(u!=s)){return false}}if(q.getTransportParam()==null^p.getTransportParam()==null){return false}if(q.getUserParam()==null^p.getUserParam()==null){return false}if(q.getTTLParam()==-1^p.getTTLParam()==-1){return false}if(q.getMethodParam()==null^p.getMethodParam()==null){return false}if(q.getMAddrParam()==null^p.getMAddrParam()==null){return false}var t=q.getHeaderNames();var r=p.getHeaderNames();if(t[0]&&!r[0]){return false}if(!t[0]&&r[0]){return false}if(t[0]&&r[0]){var j=new SipFactory();var h=null;h=j.createHeaderFactory();for(g=0;g<t.length;g++){var d=t[g];var n=q.getHeader(d);var m=p.getHeader(d);if(n==null&&m!=null){return false}if(m==null&&n!=null){return false}if(n==null&&m==null){continue}var e=h.createHeader(d,RFC2396UrlDecoder.decode(n));var c=h.createHeader(d,RFC2396UrlDecoder.decode(m));if(e!=c){return false}}}return true}return false};SipUri.prototype.encode=function(){return this.encodeBuffer("")};SipUri.prototype.encodeBuffer=function(a){a=a+this.scheme+this.COLON;if(this.authority!=null){a=this.authority.encodeBuffer(a)}if(this.uriParms.hmap.length!=0){a=a+this.SEMICOLON;a=this.uriParms.encodeBuffer(a)}if(this.qheaders.hmap.length!=0){a=a+this.QUESTION;a=this.qheaders.encodeBuffer(a)}return a};SipUri.prototype.encodeWithoutScheme=function(){var a="";if(this.authority!=null){a=this.authority.encodeBuffer(a)}if(this.uriParms.hmap.length!=0){a=a+this.SEMICOLON;a=this.uriParms.encodeBuffer(a)}if(this.qheaders.hmap.length!=0){a=a+this.QUESTION;a=this.qheaders.encodeBuffer(a)}return a};SipUri.prototype.toString=function(){return this.encode()};SipUri.prototype.getUserAtHost=function(){var a="";if(this.authority.getUserInfo()!=null){a=this.authority.getUserInfo().getUser()}var c=this.authority.getHost().encode();var b=null;if(a==""){b=null}else{b=":"+this.AT}b=b+c;return b};SipUri.prototype.getUserAtHostPort=function(){var b="";if(this.authority.getUserInfo()!=null){b=this.authority.getUserInfo().getUser()}var d=this.authority.getHost().encode();var a=this.authority.getPort();var c=null;if(b==""){c=null}else{c=":"+this.AT}if(a!=-1){c=c+d+this.COLON+a;return c}else{c=c+d;return c}};SipUri.prototype.getParm=function(a){var b=this.uriParms.getValue(a);return b};SipUri.prototype.getMethod=function(){return this.getParm(this.METHOD)};SipUri.prototype.getParameters=function(){return this.uriParms};SipUri.prototype.removeParameters=function(){this.uriParms=new NameValueList()};SipUri.prototype.getQheaders=function(){return this.qheaders};SipUri.prototype.getUserType=function(){return this.uriParms.getValue(this.USER)};SipUri.prototype.getUserPassword=function(){if(this.authority==null){return null}return this.authority.getPassword()};SipUri.prototype.setUserPassword=function(a){if(this.authority==null){this.authority=new Authority()}this.authority.setPassword(a)};SipUri.prototype.getTelephoneSubscriber=function(){if(this.telephoneSubscriber==null){this.telephoneSubscriber=new TelephoneNumber()}return this.telephoneSubscriber};SipUri.prototype.getHostPort=function(){if(this.authority==null||this.authority.getHost()==null){return null}else{return this.authority.getHostPort()}};SipUri.prototype.getPort=function(){var a=this.getHostPort();if(a==null){return -1}return a.getPort()};SipUri.prototype.getHost=function(){if(this.authority==null){return null}else{if(this.authority.getHost()==null){return null}else{return this.authority.getHost().encode()}}};SipUri.prototype.isUserTelephoneSubscriber=function(){var a=this.uriParms.getValue(this.USER);if(a==null){return false}if(a.toLowerCase()==this.PHONE){return true}else{return false}};SipUri.prototype.removeTTL=function(){if(this.uriParms!=null){this.uriParms.delet(this.TTL)}};SipUri.prototype.removeMAddr=function(){if(this.uriParms!=null){this.uriParms.delet(this.MADDR)}};SipUri.prototype.removeTransport=function(){if(this.uriParms!=null){this.uriParms.delet(this.TRANSPORT)}};SipUri.prototype.removeHeader=function(a){if(this.uriParms!=null){this.uriParms.delet(a)}};SipUri.prototype.removeHeaders=function(){this.qheaders=new NameValueList()};SipUri.prototype.removeUserType=function(){if(this.uriParms!=null){this.uriParms.delet(this.USER)}};SipUri.prototype.removePort=function(){this.authority.removePort()};SipUri.prototype.removeMethod=function(){if(this.uriParms!=null){this.uriParms.delet(this.METHOD)}};SipUri.prototype.setUser=function(a){if(this.authority==null){this.authority=new Authority()}this.authority.setUser(a)};SipUri.prototype.removeUser=function(){this.authority.removeUserInfo()};SipUri.prototype.setDefaultParm=function(b,c){if(this.uriParms.getValue(b)==null){var a=new NameValue(b,c);this.uriParms.set_nv(a)}};SipUri.prototype.setAuthority=function(a){this.authority=a};SipUri.prototype.setHost_Host=function(a){if(this.authority==null){this.authority=new Authority()}this.authority.setHost(a)};SipUri.prototype.setUriParms=function(a){this.uriParms=a};SipUri.prototype.setUriParm=function(b,c){var a=new NameValue(b,c);this.uriParms.set_nv(a)};SipUri.prototype.setQheaders=function(a){this.qheaders=a};SipUri.prototype.setMAddr=function(b){var a=this.uriParms.getNameValue(this.MADDR);var c=new Host();c.setAddress(b);if(a!=null){a.setValueAsObject(c)}else{a=new NameValue(this.MADDR,c);this.uriParms.set_nv(a)}};SipUri.prototype.setUserParam=function(a){this.uriParms.set_name_value(this.USER,a)};SipUri.prototype.setMethod=function(a){this.uriParms.set_name_value(this.METHOD,a)};SipUri.prototype.setIsdnSubAddress=function(a){if(this.telephoneSubscriber==null){this.telephoneSubscriber=new TelephoneNumber()}this.telephoneSubscriber.setIsdnSubaddress(a)};SipUri.prototype.setTelephoneSubscriber=function(a){this.telephoneSubscriber=a};SipUri.prototype.setPort=function(a){if(this.authority==null){this.authority=new Authority()}this.authority.setPort(a)};SipUri.prototype.hasParameter=function(a){if(this.uriParms.getValue(a)!=null){return true}else{return false}};SipUri.prototype.setQHeader=function(a){this.qheaders.set_nv(a)};SipUri.prototype.setUriParameter=function(a){this.uriParms.set_nv(a)};SipUri.prototype.hasTransport=function(){if(this.hasParameter(this.TRANSPORT)){return true}else{return false}};SipUri.prototype.removeParameter=function(a){this.uriParms.delet(a)};SipUri.prototype.setHostPort=function(a){if(this.authority==null){this.authority=new Authority()}this.authority.setHostPort(a)};SipUri.prototype.getHeader=function(a){return this.qheaders.getValue(a)!=null?this.qheaders.getValue(a):null};SipUri.prototype.getHeaderNames=function(){return this.qheaders.getNames()};SipUri.prototype.getLrParam=function(){var a=this.hasParameter(this.LR);return a?"true":null};SipUri.prototype.getMAddrParam=function(){var a=this.uriParms.getNameValue(this.MADDR);if(a==null){return null}var b=a.getValueAsObject();if(typeof b=="object"){b=b.encode()}return b};SipUri.prototype.getMethodParam=function(){return this.getParameter(this.METHOD)};SipUri.prototype.getParameter=function(a){var b=this.uriParms.getValue(a);if(b==null){return null}if(b instanceof GenericObject){return b.encode()}else{return b}};SipUri.prototype.getParameterNames=function(){return this.uriParms.getNames()};SipUri.prototype.getTTLParam=function(){var a=this.uriParms.getValue("ttl");if(a!=null){a=a-0;return a}else{return -1}};SipUri.prototype.getTransportParam=function(){if(this.uriParms!=null){return this.uriParms.getValue(this.TRANSPORT)}else{return null}};SipUri.prototype.getUser=function(){return this.authority.getUser()};SipUri.prototype.isSecure=function(){if(this.getScheme().toLowerCase()==this.SIPS){return true}else{return false}};SipUri.prototype.isSipURI=function(){return true};SipUri.prototype.setHeader=function(b,c){var a=new NameValue(b,c);this.qheaders.set_nv(a)};SipUri.prototype.setHost_String=function(b){var a=new Host(b);this.setHost_Host(a)};SipUri.prototype.setLrParam=function(){this.uriParms.set_name_value("lr",null)};SipUri.prototype.setMAddrParam=function(a){if(a==null){console.error("SipUri:setMAddrParam(): bad maddr");throw"SipUri:setMAddrParam(): bad maddr"}this.setParameter("maddr",a)};SipUri.prototype.setMethodParam=function(a){this.setParameter("method",a)};SipUri.prototype.setParameter=function(a,b){if(a.toLowerCase()=="ttl"){b=b-0}this.uriParms.set_name_value(a,b)};SipUri.prototype.setSecure=function(a){if(a){this.scheme=this.SIPS}else{this.scheme=this.SIP}};SipUri.prototype.setTTLParam=function(a){if(a<=0){console.error("SipUri:setTTLParam(): Bad ttl value");throw"SipUri:setTTLParam(): Bad ttl value"}if(this.uriParms!=null){var b=new NameValue("ttl",a.valueOf());this.uriParms.set_nv(b)}};SipUri.prototype.setTransportParam=function(b){if(b==null){console.error("SipUri:setTransportParam():  null transport arg");throw"SipUri:setTransportParam(): null transport arg"}if(b=="UDP"==0||b=="TLS"==0||b=="TCP"==0||b=="SCTP"==0||b=="WS"==0||b=="WSS"==0){var a=new NameValue(this.TRANSPORT,b.toLowerCase());this.uriParms.set_nv(a)}else{console.error("SipUri:setTransportParam():  bad transport "+b);throw"SipUri:setTransportParam(): bad transport "+b}};SipUri.prototype.getUserParam=function(){return this.getParameter("user")};SipUri.prototype.hasLrParam=function(){if(this.uriParms.getNameValue("lr")!=null){return true}else{return false}};SipUri.prototype.hasGrParam=function(){if(this.uriParms.getNameValue(this.GRUU)!=null){return true}else{return false}};SipUri.prototype.setGrParam=function(a){this.uriParms.set_name_value(this.GRUU,a)};SipUri.prototype.getGrParam=function(){return this.uriParms.getValue(this.GRUU)};function AddressImpl(){this.classname="AddressImpl";this.addressType=1;this.displayName=null;this.address=new GenericURI()}AddressImpl.prototype.NAME_ADDR=1;AddressImpl.prototype.ADDRESS_SPEC=2;AddressImpl.prototype.WILD_CARD=3;AddressImpl.prototype.DOUBLE_QUOTE='"';AddressImpl.prototype.SP=" ";AddressImpl.prototype.LESS_THAN="<";AddressImpl.prototype.GREATER_THAN=">";AddressImpl.prototype.match=function(a){if(a==null){return true}if(!(a instanceof AddressImpl)){return false}else{var b=a;if(b.getMatcher()!=null){if(b.getMatcher().match(this.encode())){return true}else{return false}}else{if(b.displayName!=null&&this.displayName==null){return false}else{if(b.displayName==null){if(this.address.match(b.address)){return true}else{return false}}else{if(this.displayName.toLowerCase()==b.displayName&&this.address.match(b.address)){return true}else{return false}}}}}};AddressImpl.prototype.getHostPort=function(){if(!(this.address instanceof SipUri)){console.error("AddressImpl:getHostPort(): address is not a SipUri");throw"AddressImpl:getHostPort(): address is not a SipUri"}var a=this.address;return a.getHostPort()};AddressImpl.prototype.getPort=function(){if(!(this.address instanceof SipUri)){console.error("AddressImpl:getPort(): address is not a SipUri");throw"AddressImpl:getPort(): address is not a SipUri"}var a=this.address;return a.getHostPort().getPort()};AddressImpl.prototype.getUserAtHostPort=function(){if(this.address instanceof SipUri){var a=this.address;return a.getUserAtHostPort()}else{return this.address}};AddressImpl.prototype.getHost=function(){if(!(this.address instanceof SipUri)){console.error("AddressImpl:getHost(): address is not a SipUri");throw"AddressImpl:getHost(): address is not a SipUri"}var a=this.address;return a.getHostPort().getHost().getHostname()};AddressImpl.prototype.removeParameter=function(a){if(!(this.address instanceof SipUri)){console.error("AddressImpl:removeParameter(): address is not a SipUri");throw"AddressImpl:removeParameter(): address is not a SipUri"}var b=this.address;b.removeParameter(a)};AddressImpl.prototype.encode=function(){return this.encodeBuffer("")};AddressImpl.prototype.encodeBuffer=function(a){if(this.addressType==this.WILD_CARD){a=a+"*"}else{if(this.displayName!=null){a=a+this.DOUBLE_QUOTE+this.displayName+this.DOUBLE_QUOTE+this.SP}if(this.address!=null){if(this.addressType==this.NAME_ADDR||this.displayName!=null){a=a+this.LESS_THAN}a=this.address.encodeBuffer(a);if(this.addressType==this.NAME_ADDR||this.displayName!=null){a=a+this.GREATER_THAN}}}return a};AddressImpl.prototype.encodeWithoutScheme=function(){if(this.address instanceof SipUri){var a=this.address;return a.encodeWithoutScheme()}else{return encode()}};AddressImpl.prototype.getAddressType=function(){return this.addressType};AddressImpl.prototype.setAddressType=function(a){this.addressType=a};AddressImpl.prototype.getDisplayName=function(){return this.displayName};AddressImpl.prototype.setDisplayName=function(a){this.displayName=a;this.addressType=this.NAME_ADDR};AddressImpl.prototype.setAddress=function(a){this.address=a};AddressImpl.prototype.hashCode=function(){var d=0;var a=this.address;if(!(a==null||a.value=="")){for(var b=0;b<a.length;b++){d=d*31+a.charCodeAt(b);var c=2147483647;var e=-2147483648;if(d>c||d<e){d&=4294967295}}}return d};AddressImpl.prototype.equals=function(a){if(this==a){return true}if(a instanceof AddressImpl){var b=a;if(this.getURI()==b.getURI()){return true}else{return false}}return false};AddressImpl.prototype.hasDisplayName=function(){if(this.displayName!=null){return true}else{return false}};AddressImpl.prototype.removeDisplayName=function(){this.displayName=null};AddressImpl.prototype.isSIPAddress=function(){if(this.address instanceof SipUri){return true}else{return false}};AddressImpl.prototype.getURI=function(){return this.address};AddressImpl.prototype.isWildcard=function(){if(this.addressType==this.WILD_CARD){return true}else{return false}};AddressImpl.prototype.setURI=function(a){this.address=a};AddressImpl.prototype.setUser=function(a){if(this.address instanceof SipUri){this.address.setUser(a)}else{this.address=new SipUri();this.address.setUser(a)}};AddressImpl.prototype.setWildCardFlag=function(){this.addressType=this.WILD_CARD;this.address=new SipUri();this.address.setUser("*")};function AddressFactoryImpl(){this.classname="AddressFactoryImpl"}AddressFactoryImpl.prototype.createAddress=function(){if(arguments.length==0){var a=new AddressImpl();return a}else{if(arguments.length==1){if(typeof arguments[0]=="string"){var c=arguments[0];var e=this.createAddress_address(c);return e}else{if(typeof arguments[0]=="object"){var d=arguments[0];var a=this.createAddress_uri(d);return a}}}else{if(arguments.length==2){var b=arguments[0];d=arguments[1];a=this.createAddress_name_uri(b,d);return a}else{console.error("AddressFactoryImpl:createAddress():  too many arg");throw"AddressFactoryImpl:createAddress():  too many arg"}}}};AddressFactoryImpl.prototype.createAddress_name_uri=function(b,c){if(c==null){console.error("AddressFactoryImpl:createAddress_name_uri():  null uri arg");throw"AddressFactoryImpl:createAddress_name_uri():  null uri arg"}var a=new AddressImpl();if(b!=null){a.setDisplayName(b)}a.setURI(c);return a};AddressFactoryImpl.prototype.createSipURI=function(){if(arguments.length==0){console.error("AddressFactoryImpl:createSipURI(): missing uri arg");throw"AddressFactoryImpl:createSipURI():  missing uri arg"}else{if(arguments.length==1){var c=arguments[0];if(c==null){console.error("AddressFactoryImpl:createSipURI():  null uri arg");throw"AddressFactoryImpl:createSipURI():  null uri arg"}var e=new StringMsgParser();var d=e.parseSIPUrl(c);return d}else{if(arguments.length==2){var a=arguments[0];var b=arguments[1];d=this.createSipURI_user_host(a,b);return d}}}};AddressFactoryImpl.prototype.createSipURI_user_host=function(a,b){if(b==null){console.error("AddressFactoryImpl:createSipURI_user_host(): null host arg");throw"AddressFactoryImpl:createSipURI_user_host():  null host arg"}var e="sip:";if(a!=null){e=e+a+"@"}if(b.indexOf(":")!=b.lastIndexOf(":")&&b.trim().charAt(0)!="["){b="["+b+"]"}e=e+b;var d=new StringMsgParser();var c=d.parseSIPUrl(e.toString());return c};AddressFactoryImpl.prototype.createTelURL=function(b){if(b==null){console.error("AddressFactoryImpl:createTelURL(): null uri arg");throw"AddressFactoryImpl:createTelURL():  null uri arg"}var a="tel:"+b;var d=new StringMsgParser();var c=d.parseUrl(a);return c};AddressFactoryImpl.prototype.createAddress_uri=function(b){if(b==null){console.error("AddressFactoryImpl:createAddress_uri(): null uri arg");throw"AddressFactoryImpl:createAddress_uri():  null uri arg"}var a=new AddressImpl();a.setURI(b);return a};AddressFactoryImpl.prototype.createAddress_address=function(b){if(b==null){console.error("AddressFactoryImpl:createAddress_address(): null address arg");throw"AddressFactoryImpl:createAddress_address():  null address arg"}if(b=="*"){var a=new AddressImpl();a.setAddressType(a.wild_card);var c=new SipUri();c.setUser("*");a.setURI(c);return a}else{var a=new AddressImpl();var c=this.createURI(b);a.setURI(c);return a}};AddressFactoryImpl.prototype.createURI=function(c){if(c==null){console.error("AddressFactoryImpl:createURI(): null uri arg");throw"AddressFactoryImpl:createURI():  null uri arg"}var b=new URLParser(c);var a=b.peekScheme();if(a==null){console.error("AddressFactoryImpl:createURI(): bad scheme");throw"AddressFactoryImpl:createURI():  bad scheme"}if(a.toLowerCase()=="sip"){return b.sipURL(true)}else{if(a.toLowerCase()=="sips"){return b.sipURL(true)}else{if(a.toLowerCase()=="tel"){return b.telURL(true)}}}return new GenericURI(c)};function SIPObject(){this.classname="SIPObject"}SIPObject.prototype=new GenericObject();SIPObject.prototype.constructor=SIPObject;function SIPHeader(a){this.classname="SIPHeader";this.headerName=null;if(a!=null){this.headerName=a}}SIPHeader.prototype.COLON=":";SIPHeader.prototype.SP=" ";SIPHeader.prototype.NEWLINE="\r\n";SIPHeader.prototype.getHeaderName=function(){return this.headerName};SIPHeader.prototype.getName=function(){return this.headerName};SIPHeader.prototype.setHeaderName=function(a){this.headerName=a};SIPHeader.prototype.getHeaderValue=function(){var b=null;b=this.encode();var a=b;while(a.length>0&&a.charAt(0)!=":"){a=a.substring(1)}if(a.length>0){a=a.substring(1)}return a.toString().trim()};SIPHeader.prototype.isHeaderList=function(){return false};SIPHeader.prototype.encode=function(){return this.encodeBuffer("").toString()};SIPHeader.prototype.encodeBuffer=function(a){a=a+this.headerName+this.COLON+this.SP;a=this.encodeBodyBuffer(a);a=a+this.NEWLINE;return a};SIPHeader.prototype.encodeBody=function(){};SIPHeader.prototype.encodeBodyBuffer=function(a){a=a+this.encodeBody();return a};SIPHeader.prototype.getValue=function(){return this.getHeaderValue()};SIPHeader.prototype.hashCode=function(){var d=0;var a=this.headerName;if(!(a==null||a.value=="")){for(var b=0;b<a.length;b++){d=d*31+a.charCodeAt(b);var c=2147483647;var e=-2147483648;if(d>c||d<e){d&=4294967295}}}return d};SIPHeader.prototype.toString=function(){return this.encode()};function SIPHeaderList(){this.classname="SIPHeaderList";this.prettyEncode=false;this.hlist=new Array();this.myClass=null;if(arguments.length!=0){var b=arguments[0];var a=arguments[1];this.headerName=a;this.myClass=b}}SIPHeaderList.prototype=new SIPHeader();SIPHeaderList.prototype.constructor=SIPHeaderList;SIPHeaderList.prototype.NEWLINE="\r\n";SIPHeaderList.prototype.WWW_AUTHENTICATE="WWW-Authenticate";SIPHeaderList.prototype.PROXY_AUTHENTICATE="Proxy-Authenticate";SIPHeaderList.prototype.AUTHORIZATION="Authorization";SIPHeaderList.prototype.PROXY_AUTHORIZATION="Proxy-Authorization";SIPHeaderList.prototype.ROUTE="Route";SIPHeaderList.prototype.RECORD_ROUTE="Record-Route";SIPHeaderList.prototype.VIA="Via";SIPHeaderList.prototype.COLON=":";SIPHeaderList.prototype.SP=" ";SIPHeaderList.prototype.COMMA=",";SIPHeaderList.prototype.SEMICOLON=";";SIPHeaderList.prototype.getName=function(){return this.headerName};SIPHeaderList.prototype.add=function(){if(arguments.length==1){var j=arguments[0];var d=null;for(var e=0;e<this.hlist.length;e++){if(j==this.hlist[e]){d=e}}if(d==null){this.hlist.push(j)}}else{if(typeof arguments[0]=="object"){var c=arguments[0];var g=arguments[1];if(g){this.addFirst(c)}else{this.add(c)}}else{if(typeof arguments[0]=="number"){var f=arguments[0];var b=arguments[1];if(this.hlist[f]!=null){var h=this.hlist.slice(f);this.hlist[f]=b;for(e=0;e<h.length;e++){var a=f+e+1;this.hlist[a]=h[e]}}else{this.hlist[f]=b}}}}};SIPHeaderList.prototype.addFirst=function(a){this.hlist.unshift(a)};SIPHeaderList.prototype.concatenate=function(a,b){if(!b){this.addAll(a)}else{this.addAll(0,a)}};SIPHeaderList.prototype.encode=function(){return this.encodeBuffer("").toString()};SIPHeaderList.prototype.encodeBuffer=function(b){if(this.hlist.length==0){b=b+this.headerName+":"+this.NEWLINE}else{if(this.headerName==this.WWW_AUTHENTICATE||this.headerName==this.PROXY_AUTHENTICATE||this.headerName==this.AUTHORIZATION||this.headerName==this.PROXY_AUTHORIZATION||(this.prettyEncode&&(this.headerName==this.VIA||this.headerName==this.ROUTE||this.headerName==this.RECORD_ROUTE))||this.classname=="ExtensionHeaderList"){for(var c=0;c<this.hlist.length;c++){var a=this.hlist[c];b=a.encodeBuffer(b)}}else{b=b+this.headerName+this.COLON+this.SP;b=this.encodeBodyBuffer(b);b=b+this.NEWLINE}}return b};SIPHeaderList.prototype.getHeadersAsEncodedStrings=function(){var b=new Array();for(var c=0;c<this.hlist.length;c++){var a=this.hlist[c];b[c]=a.toString()}return b};SIPHeaderList.prototype.getFirst=function(){if(this.hlist==null||this.hlist.length==0){return null}else{return this.hlist[0]}};SIPHeaderList.prototype.getLast=function(){if(this.hlist==null||this.hlist.length==0){return null}var a=this.hlist.length;return this.hlist[a-1]};SIPHeaderList.prototype.getMyClass=function(){return this.myClass};SIPHeaderList.prototype.isEmpty=function(){if(this.hlist==0){return true}else{return false}};SIPHeaderList.prototype.listIterator=function(){if(arguments.length==0){return this.hlist}else{var a=arguments[0];var b=this.hlist;return b.slice(a)}};SIPHeaderList.prototype.getHeaderList=function(){return this.hlist};SIPHeaderList.prototype.removeFirst=function(){if(this.hlist.length!=0){this.hlist.splice(0,1)}};SIPHeaderList.prototype.removeLast=function(){if(this.hlist.length!=0){var a=this.hlist.length-1;this.hlist.splice(a,1)}};SIPHeaderList.prototype.remove=function(d){if(typeof d=="number"){var a=this.hlist[d];this.hlist.splice(d,1);return a}else{if(typeof d=="object"){if(this.hlist.length==0){return false}else{var b=null;for(var c=0;c<this.hlist.length;c++){if(this.hlist[c]==d){b=c}}if(b!=null){this.hlist.splice(b,1);return true}else{return false}}}}return false};SIPHeaderList.prototype.setMyClass=function(a){this.myClass=a};SIPHeaderList.prototype.toArray=function(){return this.hlist};SIPHeaderList.prototype.indexOf=function(c){var a=null;for(var b=0;b<this.hlist.length;b++){if(this.hlist[b].classname.toLowerCase()==c.toLowerCase()){a=b}}if(a!=null){return a}else{return -1}};SIPHeaderList.prototype.size=function(){return this.hlist.length};SIPHeaderList.prototype.isHeaderList=function(){return true};SIPHeaderList.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};SIPHeaderList.prototype.encodeBodyBuffer=function(a){for(var b=0;b<this.hlist.length;b++){var c=this.hlist[b];if(c.classname=="SIPHeaderList"){console.error("SIPHeaderList:encodeBodyBuffer(): unexpected circularity in SipHeaderList");throw"SIPHeaderList:encodeBodyBuffer(): unexpected circularity in SipHeaderList"}a=c.encodeBodyBuffer(a);if(b!=this.hlist.length-1){if(this.headerName!="Privacy"){a=a+this.COMMA}else{a=a+this.SEMICOLON}}}return a};SIPHeaderList.prototype.addAll=function(){if(arguments.length==1){var e=arguments[0].hlist;var d=this.hlist.length;for(var c=0;c<e.length;c++){var f=c+d;this.hlist[f]=e[c]}if(this.hlist.length!=d){return true}else{return false}}else{if(arguments.length==2){var b=arguments[0];e=arguments[1].hlist;if(this.hlist[b]!=null){var a=this.hlist.slice(b);d=this.hlist.length;for(c=0;c<e.length;c++){f=c+b;this.hlist[f]=e[c]}for(c=0;c<a.length;c++){f=b+c+e.length;this.hlist[f]=a[c]}if(this.hlist.length!=d){return true}else{return false}}else{b=arguments[0];e=arguments[1].hlist;d=this.hlist.length;for(c=0;c<e.length;c++){f=c+b;this.hlist[f]=e[c]}if(this.hlist.length!=d){return true}else{return false}}}}return false};SIPHeaderList.prototype.containsAll=function(b){var e=0;for(var a=0;a<b.length;a++){for(var d=0;d<this.hlist.length;d++){if(this.hlist[d].classname==b[a].classname){e=e+1}}}if(e==b.length){return true}else{return false}};SIPHeaderList.prototype.clear=function(){this.hlist=new Array()};SIPHeaderList.prototype.contains=function(d){var b=0;for(var a=0;a<this.hlist.length;a++){if(this.hlist[a].classname==d){b=1}}if(b==1){return true}else{return false}};SIPHeaderList.prototype.get=function(a){return this.hlist[a]};SIPHeaderList.prototype.iterator=function(){return this.hlist};SIPHeaderList.prototype.lastIndexOf=function(a){var d=null;for(var b=0;b<this.hlist.length;b++){if(this.hlist[b].classname==a){d=b}}if(d==null){return d}else{return -1}};SIPHeaderList.prototype.removeAll=function(e){var b=new Array();var g=0;var a=0;for(var d=0;d<this.hlist.length;d++){for(var f=0;f<e.length;f++){if((this.hlist[d].classname!=e[f].classname)&&(e[f].classname!=null)){a=a+1}}if(a==e.length){b[g]=this.hlist[d];g=g+1}a=0}if(this.hlist.length!=b.length){this.hlist=b;return true}else{return false}};SIPHeaderList.prototype.retainAll=function(d){var a=new Array();var f=0;for(var b=0;b<this.hlist.length;b++){for(var e=0;e<d.length;e++){if((this.hlist[b].classname==d[e].classname)){a[f]=this.hlist[b];f=f+1}}}if(this.hlist.length!=a.length){this.hlist=a;return true}else{return false}};SIPHeaderList.prototype.subList=function(b,a){return this.hlist.slice(b,a)};SIPHeaderList.prototype.hashCode=function(){var c=0;var e=this.headerName;if(!(e==null||e.value=="")){for(var a=0;a<e.length;a++){c=c*31+e.charCodeAt(a);var b=2147483647;var d=-2147483648;if(c>b||c<d){c&=4294967295}}}return c};SIPHeaderList.prototype.set=function(b,c){var a=this.hlist[b];this.hlist[b]=c;return a};SIPHeaderList.prototype.setPrettyEncode=function(a){this.prettyEncode=a};function ParametersHeader(a,b){this.classname="ParametersHeader";this.parameters=null;this.duplicates=null;this.headerName=null;if(a==null&&b==null){this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}else{if(a!=null&&b==null){this.headerName=a;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}else{if(a!=null&&b!=null){this.headerName=a;this.parameters=new NameValueList(b);this.duplicates=new DuplicateNameValueList()}}}}ParametersHeader.prototype=new SIPHeader();ParametersHeader.prototype.constructor=ParametersHeader;ParametersHeader.prototype.getParameter=function(a){return this.parameters.getParameter(a)};ParametersHeader.prototype.getParameterValue=function(a){return this.parameters.getValue(a)};ParametersHeader.prototype.getParameterNames=function(){return this.parameters.getNames()};ParametersHeader.prototype.hasParameters=function(){if(this.parameters!=null&&this.parameters.hmap.length!=0){return true}else{return false}};ParametersHeader.prototype.removeParameter=function(a){this.parameters.delet(a)};ParametersHeader.prototype.setQuotedParameter=function(b,c){var a=this.parameters.getNameValue(b);if(a!=null){a.setValueAsObject(c);a.setQuotedValue()}else{a=new NameValue(b,c);a.setQuotedValue();this.parameters.set_nv(a)}};ParametersHeader.prototype.setParameter=function(b,d){if(typeof d=="object"){this.parameters.set_name_value(b,e)}else{if(typeof d=="boolean"){var e=new Boolean(d);this.parameters.set_name_value(b,e)}else{if(typeof d=="number"){var c=d-[d];if(c==0){e=new Number(d);this.parameters.set_name_value(b,e)}else{e=new Number(d);var a=this.parameters.getNameValue(b);if(a!=null){a.setValueAsObject(e)}else{a=new NameValue(b,e);this.parameters.set_nv(a)}}}else{if(typeof d=="string"){a=this.parameters.getNameValue(b);if(a!=null){a.setValueAsObject(d)}else{a=new NameValue(b,d);this.parameters.set_nv(a)}}}}}};ParametersHeader.prototype.hasParameter=function(a){return this.parameters.hasNameValue(a)};ParametersHeader.prototype.removeParameters=function(){this.parameters=new NameValueList()};ParametersHeader.prototype.getParameters=function(){return this.parameters};ParametersHeader.prototype.setParameter_nv=function(a){this.parameters.set_nv(a)};ParametersHeader.prototype.setParameters=function(a){this.parameters=a};ParametersHeader.prototype.getParameterAsNumber=function(a){if(this.getParameterValue(a)!=null){return this.getParameterValue(a)-0}else{return -1}};ParametersHeader.prototype.getParameterAsURI=function(a){var b=this.getParameterValue(a);if(b instanceof GenericURI){return b}else{return new GenericURI(b)}};ParametersHeader.prototype.getParameterAsBoolean=function(b){var c=this.getParameterValue(b);if(c==null){return false}else{if(c instanceof Boolean){return c}else{if(c instanceof String){var a=new Boolean(c);return a}else{return false}}}};ParametersHeader.prototype.getNameValue=function(a){return this.parameters.getNameValue(a)};ParametersHeader.prototype.setMultiParameter_name_value=function(b,c){var a=new NameValue();a.setName(b);a.setValue(c);this.duplicates.set_nv(a)};ParametersHeader.prototype.setMultiParameter_nv=function(a){this.duplicates.set_nv(a)};ParametersHeader.prototype.getMultiParameter=function(a){return this.duplicates.getParameter(a)};ParametersHeader.prototype.getMultiParameters=function(){return this.duplicates};ParametersHeader.prototype.getMultiParameterValue=function(a){return this.duplicates.getValue(a)};ParametersHeader.prototype.getMultiParameterNames=function(){return this.duplicates.getNames()};ParametersHeader.prototype.hasMultiParameters=function(){if(this.duplicates!=null&&this.duplicates.length!=o){return true}else{return false}};ParametersHeader.prototype.removeMultiParameter=function(a){this.duplicates.delet(a)};ParametersHeader.prototype.hasMultiParameter=function(a){return this.duplicates.hasNameValue(a)};ParametersHeader.prototype.removeMultiParameters=function(){this.duplicates=new DuplicateNameValueList()};ParametersHeader.prototype.equalParameters=function(a){if(this==a){return true}var d=this.getParameterNames();for(var c=0;c<d.length;c++){var b=d[c];var f=this.getParameter(b);var e=a.getParameter(b);if(f==null^e==null){return false}else{if(f!=null&&f.toLowerCase()!=e){return false}}}d=a.getParameterNames();for(c=0;c<d.length;c++){b=d[c];f=a.getParameter(b);e=this.getParameter(b);if(f==null^e==null){return false}else{if(f!=null&&f.toLowerCase()!=e){return false}}}return true};ParametersHeader.prototype.encodeBody=function(){};function RequestLine(a,b){this.classname="RequestLine";this.uri=new GenericURI();this.method=null;this.sipVersion="SIP/2.0";if(a!=null&&b!=null){this.uri=a;this.method=b}}RequestLine.prototype=new SIPObject();RequestLine.prototype.constructor=RequestLine;RequestLine.prototype.SP=" ";RequestLine.prototype.NEWLINE="\r\n";RequestLine.prototype.encode=function(){return this.encodeBuffer("").toString()};RequestLine.prototype.encodeBuffer=function(a){if(this.method!=null){a=a+this.method+this.SP}if(this.uri!=null){a=this.uri.encodeBuffer(a);a=a+this.SP}a=a+this.sipVersion+this.NEWLINE;return a};RequestLine.prototype.getUri=function(){return this.uri};RequestLine.prototype.getMethod=function(){return this.method};RequestLine.prototype.getSipVersion=function(){return this.sipVersion};RequestLine.prototype.setUri=function(a){return this.uri=a};RequestLine.prototype.setMethod=function(a){this.method=a};RequestLine.prototype.setSipVersion=function(a){this.sipVersion=a};RequestLine.prototype.getVersionMajor=function(){if(this.sipVersion==null){return null}var a=null;var c=false;for(var b=0;b<this.sipVersion.length;b++){if(this.sipVersion.charAt(b)=="."){break}if(c){if(a==null){a=""+this.sipVersion.charAt(b)}else{a+=this.sipVersion.charAt(b)}}if(this.sipVersion.charAt(b)=="/"){c=true}}return a};RequestLine.prototype.getVersionMinor=function(){if(this.sipVersion==null){return null}var c=null;var a=false;for(var b=0;b<this.sipVersion.length;b++){if(this.sipVersion.charAt(b)=="."){break}if(a){if(c==null){c=""+this.sipVersion.charAt(b)}else{c+=this.sipVersion.charAt(b)}}if(this.sipVersion.charAt(b)=="/"){a=true}}return c};function UserAgent(){this.classname="UserAgent";this.productTokens=new Array();this.headerName=this.NAME}UserAgent.prototype=new SIPHeader();UserAgent.prototype.constructor=UserAgent;UserAgent.prototype.NAME="User-Agent";UserAgent.prototype.encodeProduct=function(){var b="";for(var a=0;a<this.productTokens.length;a++){b=b+this.productTokens[a]}return b.toString()};UserAgent.prototype.addProductToken=function(b){var a=this.productTokens.length;this.productTokens[a]=b};UserAgent.prototype.encodeBody=function(){return this.encodeProduct()};UserAgent.prototype.getProduct=function(){if(this.productTokens==null||this.productTokens.length==0){return null}else{return this.productTokens}};UserAgent.prototype.setProduct=function(a){if(a==null){console.error("UserAgent:setProduct(): the product parameter is null");throw"UserAgent:setProduct(): the product parameter is null"}this.productTokens=a};function ContentLength(a){this.classname="ContentLength";this.headerName=this.NAME;this.contentLength=null;if(a==null){this.headerName=this.NAME}else{this.headerName=this.NAME;this.contentLength=a}}ContentLength.prototype=new SIPHeader();ContentLength.prototype.constructor=ContentLength;ContentLength.prototype.NAME="Content-Length";ContentLength.prototype.getContentLength=function(){var a=this.contentLength-0;return a};ContentLength.prototype.setContentLength=function(a){if(a<0){console.error("ContentLength:setContentLength(): the contentLength parameter is < 0");throw"ContentLength:setContentLength(): the contentLength parameter is < 0"}this.contentLength=a};ContentLength.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};ContentLength.prototype.encodeBodyBuffer=function(a){if(this.contentLength==null){a=a+"0"}else{a=a+this.contentLength.toString()}return a};ContentLength.prototype.match=function(a){if(a instanceof ContentLength){return true}else{return false}};function ExtensionHeaderImpl(a){this.classname="ExtensionHeaderImpl";this.value=null;if(a!=null){this.headerName=a}}ExtensionHeaderImpl.prototype=new SIPHeader();ExtensionHeaderImpl.prototype.constructor=ExtensionHeaderImpl;ExtensionHeaderImpl.prototype.COLON=":";ExtensionHeaderImpl.prototype.SP=" ";ExtensionHeaderImpl.prototype.NEWLINE="\r\n";ExtensionHeaderImpl.prototype.setName=function(a){this.headerName=a};ExtensionHeaderImpl.prototype.setValue=function(a){this.value=a};ExtensionHeaderImpl.prototype.getHeaderValue=function(){if(this.value!=null){return this.value}else{var d=null;try{d=this.encode()}catch(e){console.error("ExtensionHeaderImpl:getHeaderValue(): catched exception:"+e);return null}var c=d;var b=0;var a=c.substring(b);while(a.length>0&&c.charAt(0)!=":"){b=b+1;a=c.substring(b)}b=b+1;a=c.substring(b);this.value=a.toString().trim();return this.value}};ExtensionHeaderImpl.prototype.encode=function(){var a="";a=a+this.headerName+this.COLON+this.SP+this.value+this.NEWLINE;return a};ExtensionHeaderImpl.prototype.encodeBody=function(){return this.getHeaderValue()};function Server(a){this.classname="Server";this.productTokens=new Array();this.headerName=this.NAME}Server.prototype=new SIPHeader();Server.prototype.constructor=Server;Server.prototype.NAME="Server";Server.prototype.encodeProduct=function(){var b="";for(var a=0;a<this.productTokens.length;a++){b=b+this.productTokens[a];if(a!=this.productTokens.length-1){b=b+"/"}else{break}}return b.toString()};Server.prototype.addProductToken=function(a){this.productTokens.push(a)};Server.prototype.encodeBody=function(){return this.encodeProduct()};Server.prototype.getProduct=function(){if(this.productTokens==null||this.productTokens.length==0){return null}else{return this.productTokens}};Server.prototype.setProduct=function(a){if(a==null){console.error("Server:setProduct(): the product parameter is null");throw"Server:setProduct(): the product parameter is null"}this.productTokens=a};function AddressParametersHeader(a,b){this.classname="AddressParametersHeader";this.address=new AddressImpl();this.headerName=null;if(a!=null&&b==null){this.headerName=a;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}else{if(a!=null&&b!=null){this.headerName=a;this.parameters=new NameValueList(b);this.duplicates=new DuplicateNameValueList()}}}AddressParametersHeader.prototype=new ParametersHeader();AddressParametersHeader.prototype.constructor=AddressParametersHeader;AddressParametersHeader.prototype.getAddress=function(){return this.address};AddressParametersHeader.prototype.setAddress=function(a){this.address=a};AddressParametersHeader.prototype.equals=function(a){if(this==a){return true}if(a instanceof ParametersHeader){var b=a;if(this.getAddress().equals(b.getAddress())&&this.equalParameters(b)){return true}else{return false}}return false};function From(a){this.classname="From";this.parameters=null;this.duplicates=null;this.address=new AddressImpl();if(a==null){this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}else{this.headerName=this.NAME;this.address=a.address;this.parameters=a.parameters}}From.prototype=new AddressParametersHeader();From.prototype.constructor=From;From.prototype.NAME="From";From.prototype.ADDRESS_SPEC=2;From.prototype.LESS_THAN="<";From.prototype.GREATER_THAN=">";From.prototype.SEMICOLON=";";From.prototype.TAG="tag";From.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};From.prototype.encodeBodyBuffer=function(a){if(this.address.getAddressType()==this.ADDRESS_SPEC){a=a+this.LESS_THAN}a=this.address.encodeBuffer(a);if(this.address.getAddressType()==this.ADDRESS_SPEC){a=a+this.GREATER_THAN}if(this.parameters.hmap.length!=0){a=a+this.SEMICOLON;a=this.parameters.encodeBuffer(a)}return a};From.prototype.getHostPort=function(){return this.address.getHostPort()};From.prototype.getDisplayName=function(){return this.address.getDisplayName()};From.prototype.getTag=function(){if(this.parameters==null){return null}return this.getParameter(this.TAG)};From.prototype.hasTag=function(){return this.hasParameter(this.TAG)};From.prototype.removeTag=function(){this.parameters.delet(this.TAG)};From.prototype.setAddress=function(a){this.address=a};From.prototype.setTag=function(a){var b=new Parser();b.checkToken(a);this.setParameter(this.TAG,a)};From.prototype.getUserAtHostPort=function(){return this.address.getUserAtHostPort()};From.prototype.equals=function(a){if((a instanceof From)&&Object.getPrototypeOf(this).equals(a)){return true}else{return false}};From.prototype.getAddress=function(){return this.address};function To(a){this.classname="To";if(a==null){this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}else{this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.setAddress(a.address);this.setParameters(a.parameters)}}To.prototype=new AddressParametersHeader();To.prototype.constructor=To;To.prototype.NAME="To";To.prototype.ADDRESS_SPEC=2;To.prototype.LESS_THAN="<";To.prototype.GREATER_THAN=">";To.prototype.SEMICOLON=";";To.prototype.TAG="tag";To.prototype.COLON=":";To.prototype.SP=" ";To.prototype.NEWLINE="\r\n";To.prototype.encode=function(){return this.headerName+this.COLON+this.SP+this.encodeBody()+this.NEWLINE};To.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};To.prototype.encodeBodyBuffer=function(a){if(this.address!=null){if(this.address.getAddressType()==this.ADDRESS_SPEC){a=a+this.LESS_THAN}a=this.address.encodeBuffer(a);if(this.address.getAddressType()==this.ADDRESS_SPEC){a=a+this.GREATER_THAN}if(!this.parameters.isEmpty()){a=a+this.SEMICOLON;a=this.parameters.encodeBuffer(a)}}return a};To.prototype.getHostPort=function(){if(this.address==null){return null}return this.address.getHostPort()};To.prototype.getDisplayName=function(){if(this.address==null){return null}return this.address.getDisplayName()};To.prototype.getTag=function(){if(this.parameters==null){return null}return this.getParameter(this.TAG)};To.prototype.hasTag=function(){if(this.parameters==null){return false}return this.hasParameter(this.TAG)};To.prototype.removeTag=function(){if(this.parameters!=null){this.parameters.delet(this.TAG)}};To.prototype.setTag=function(a){var b=new Parser();b.checkToken(a);this.setParameter(this.TAG,a)};To.prototype.getUserAtHostPort=function(){if(this.address==null){return null}return this.address.getUserAtHostPort()};function ReferTo(b,a){this.classname="ReferTo";if(b==null){this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.replaces=null}else{this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.setAddress(b.address);this.setParameters(b.parameters);this.setReplaces(a)}}ReferTo.prototype=new AddressParametersHeader();ReferTo.prototype.constructor=ReferTo;ReferTo.prototype.NAME="Refer-To";ReferTo.prototype.ADDRESS_SPEC=2;ReferTo.prototype.LESS_THAN="<";ReferTo.prototype.GREATER_THAN=">";ReferTo.prototype.SEMICOLON=";";ReferTo.prototype.TAG="tag";ReferTo.prototype.COLON=":";ReferTo.prototype.SP=" ";ReferTo.prototype.NEWLINE="\r\n";ReferTo.prototype.setReplaces=function(a){this.replaces=a};ReferTo.prototype.encode=function(){return this.headerName+this.COLON+this.SP+this.encodeBody()+this.NEWLINE};ReferTo.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};ReferTo.prototype.encodeBodyBuffer=function(a){if(this.address!=null){if(this.address.getAddressType()==this.ADDRESS_SPEC){a=a+this.LESS_THAN}a=this.address.encodeBuffer(a);if(this.replaces!=null){if(a.charAt(a.length-1)==">"){a=a.slice(0,a.length-1)+"?Replaces="+this.replaces.encodeBodyBuffer("")+this.GREATER_THAN}else{a=a+"?Replaces="+this.replaces.encodeBodyBuffer("")}}if(this.address.getAddressType()==this.ADDRESS_SPEC){a=a+this.GREATER_THAN}if(!this.parameters.isEmpty()){a=a+this.SEMICOLON;a=this.parameters.encodeBuffer(a)}}return a};ReferTo.prototype.getHostPort=function(){if(this.address==null){return null}return this.address.getHostPort()};ReferTo.prototype.getDisplayName=function(){if(this.address==null){return null}return this.address.getDisplayName()};ReferTo.prototype.getTag=function(){if(this.parameters==null){return null}return this.getParameter(this.TAG)};ReferTo.prototype.hasTag=function(){if(this.parameters==null){return false}return this.hasParameter(this.TAG)};ReferTo.prototype.removeTag=function(){if(this.parameters!=null){this.parameters.delet(this.TAG)}};ReferTo.prototype.setTag=function(a){var b=new Parser();b.checkToken(a);this.setParameter(this.TAG,a)};ReferTo.prototype.getUserAtHostPort=function(){if(this.address==null){return null}return this.address.getUserAtHostPort()};function ReferredBy(a){this.classname="ReferredBy";if(a==null){this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}else{this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.setAddress(a.address);this.setParameters(a.parameters)}}ReferredBy.prototype=new ReferTo();ReferredBy.prototype.constructor=ReferredBy;ReferredBy.prototype.NAME="Referred-By";function Reason(){this.classname="Reason";this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.protocol=null}Reason.prototype=new ParametersHeader();Reason.prototype.constructor=Reason;Reason.prototype.NAME="Reason";Reason.prototype.TEXT="text";Reason.prototype.CAUSE="cause";Reason.prototype.SEMICOLON=";";Reason.prototype.getCause=function(){return this.getParameterAsNumber(this.CAUSE)};Reason.prototype.setCause=function(a){this.parameters.set_name_value("cause",a)};Reason.prototype.setProtocol=function(a){this.protocol=a};Reason.prototype.getProtocol=function(){return this.protocol};Reason.prototype.setText=function(a){if(a.charAt(0)!='"'){a=Utils.prototype.getQuotedString(a)}this.parameters.set_name_value("text",a)};Reason.prototype.getText=function(){return this.parameters.getParameter("text")};Reason.prototype.getName=function(){return this.NAME};Reason.prototype.encodeBody=function(){var a="";a=a+this.protocol;if(this.parameters!=null&&this.parameters.hmap.length!=0){a=a+this.SEMICOLON+this.parameters.encode()}return a.toString()};function ReasonList(){this.classname="ReasonList";this.headerName=this.NAME;this.myClass="Reason"}ReasonList.prototype=new SIPHeaderList();ReasonList.prototype.constructor=ReasonList;ReasonList.prototype.NAME="Reason";ReasonList.prototype.clone=function(){};function Protocol(){this.classname="Protocol";this.protocolName="SIP";this.protocolVersion="2.0";this.transport=SipStackImpl.prototype.DEFAULT_WS_TRANSPORT}Protocol.prototype=new SIPObject();Protocol.prototype.constructor=Protocol;Protocol.prototype.SLASH="/";Protocol.prototype.encode=function(){return this.encodeBuffer("").toString()};Protocol.prototype.encodeBuffer=function(a){a=a+this.protocolName.toUpperCase()+this.SLASH+this.protocolVersion+this.SLASH+this.transport.toUpperCase();return a};Protocol.prototype.getProtocolName=function(){return this.protocolName};Protocol.prototype.getProtocolVersion=function(){return this.protocolVersion};Protocol.prototype.getProtocol=function(){return this.protocolName+"/"+this.protocolVersion};Protocol.prototype.setProtocol=function(b){var a=b.indexOf("/");if(a>0){this.protocolName=b.substring(0,a);this.protocolVersion=b.substring(a+1)}else{console.error("Event:setProtocol(): missing '/' in protocol",0);throw"Event:setProtocol(): missing '/' in protocol"}};Protocol.prototype.getTransport=function(){return this.transport};Protocol.prototype.setProtocolName=function(a){this.protocolName=a};Protocol.prototype.setProtocolVersion=function(a){this.protocolVersion=a};Protocol.prototype.setTransport=function(a){this.transport=a};function Via(){this.classname="Via";this.sentProtocol=new Protocol();this.sentBy=new HostPort();this.comment=null;this.rPortFlag=true;this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}Via.prototype=new ParametersHeader();Via.prototype.constructor=Via;Via.prototype.NAME="Via";Via.prototype.BRANCH="branch";Via.prototype.RECEIVED="received";Via.prototype.MADDR="maddr";Via.prototype.TTL="ttl";Via.prototype.RPORT="rport";Via.prototype.SP=" ";Via.prototype.SEMICOLON=";";Via.prototype.LPAREN="(";Via.prototype.RPAREN=")";Via.prototype.getProtocolVersion=function(){if(this.sentProtocol==null){return null}else{return this.sentProtocol.getProtocolVersion()}};Via.prototype.getSentProtocol=function(){return this.sentProtocol};Via.prototype.getSentBy=function(){return this.sentBy};Via.prototype.getHop=function(){var a=new HopImpl(this.sentBy.getHost().getHostname());return a};Via.prototype.getViaParms=function(){return this.parameters};Via.prototype.hasPort=function(){return this.getSentBy().hasPort()};Via.prototype.hasComment=function(){if(this.comment!=null){return true}else{return false}};Via.prototype.removePort=function(){this.sentBy.removePort()};Via.prototype.removeComment=function(){this.comment=null};Via.prototype.setProtocolVersion=function(){if(this.sentProtocol==null){this.sentProtocol=new Protocol()}this.sentProtocol.setProtocolVersion(this.protocolVersion)};Via.prototype.setHost=function(b){if(typeof b=="object"){if(this.sentBy==null){this.sentBy=new HostPort()}this.sentBy.setHost(b)}else{if(typeof b=="string"){if(this.sentBy==null){this.sentBy=new HostPort()}var a=new Host(b);this.sentBy.setHost(a)}}};Via.prototype.setSentProtocol=function(a){this.sentProtocol=a};Via.prototype.setSentBy=function(a){this.sentBy=a};Via.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};Via.prototype.encodeBodyBuffer=function(a){a=this.sentProtocol.encodeBuffer(a);a=a+this.SP;a=this.sentBy.encodeBuffer(a);if(this.parameters.length!=0){a=a+this.SEMICOLON;a=this.parameters.encodeBuffer(a)}if(this.comment!=null){a=a+this.SP+this.LPAREN+this.comment+this.RPAREN}if(this.rPortFlag&&this.getParameter(this.RPORT)==null){a=a+";rport"}return a};Via.prototype.getHost=function(){if(this.sentBy==null){return null}else{var a=this.sentBy.getHost();if(a==null){return null}else{return a.getHostname()}}};Via.prototype.setPort=function(a){if(a!=-1&&(a<1||a>65535)){console.error("Via:setPort(): port value out of range -1, [1..65535]");throw"Via:setPort(): port value out of range -1, [1..65535]"}if(this.sentBy==null){this.sentBy=new HostPort()}this.sentBy.setPort(a)};Via.prototype.setRPort=function(){this.rPortFlag=true};Via.prototype.getPort=function(){if(this.sentBy==null){return -1}return this.sentBy.getPort()};Via.prototype.getRPort=function(){var b=this.getParameter(this.RPORT);if(b!=null&&!b.equals("")){var a=b-0;return a}else{return -1}};Via.prototype.getTransport=function(){if(this.sentProtocol==null){return"WSS"}return this.sentProtocol.getTransport()};Via.prototype.setTransport=function(a){if(a==null){console.error("Via:setTransport(): the transport parameter is null");throw"Via:setTransport(): the transport parameter is null"}if(this.sentProtocol==null){this.sentProtocol=new Protocol()}this.sentProtocol.setTransport(a)};Via.prototype.getProtocol=function(){if(this.sentProtocol==null){return null}return this.sentProtocol.getProtocol()};Via.prototype.setProtocol=function(a){if(a==null){console.error("Via:setProtocol(): the transport parameter is null");throw"Via:setProtocol(): the protocol parameter is null"}if(this.sentProtocol==null){this.sentProtocol=new Protocol()}this.sentProtocol.setProtocol(a)};Via.prototype.getTTL=function(){var a=this.getParameterAsNumber(this.TTL);return a};Via.prototype.setTTL=function(a){if(a<0&&a!=-1){console.error("Via:setTTL():  the ttl parameter is < 0");throw"Via:setTTL(): the ttl parameter is < 0"}a=a-0;this.setParameter_nv(new NameValue(this.TTL,a))};Via.prototype.getMAddr=function(){return this.getParameter(this.MADDR)};Via.prototype.setMAddr=function(b){if(b==null){console.error("Via:setMAddr():  the mAddr parameter is < 0");throw"Via:setMAddr(): the mAddr parameter is < 0"}var c=new Host();c.setAddress(b);var a=new NameValue(this.MADDR,c);this.setParameter_nv(a)};Via.prototype.getReceived=function(){return this.getParameter(this.RECEIVED)};Via.prototype.setReceived=function(a){if(a==null){console.error("Via:setReceived():  the received parameter is < 0");throw"Via:setReceived(): the received parameter is < 0"}this.setParameter(this.RECEIVED,a)};Via.prototype.getBranch=function(){return this.getParameter(this.BRANCH)};Via.prototype.setBranch=function(a){if(a==null||a.length==0){console.error("Via:setBranch():  branch parameter is null or length 0");throw"Via:setBranch(): branch parameter is null or length 0"}this.setParameter(this.BRANCH,a)};Via.prototype.getSentByField=function(){if(this.sentBy!=null){return this.sentBy.encode()}return null};Via.prototype.getSentProtocolField=function(){if(this.sentProtocol!=null){return this.sentProtocol.encode()}return null};function Contact(){this.classname="Contact";this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.address=new AddressImpl();this.Q=this.Q;this.contactList=new ContactList();this.wildCardFlag=null}Contact.prototype=new AddressParametersHeader();Contact.prototype.constructor=Contact;Contact.prototype.NAME="Contact";Contact.prototype.ACTION="action";Contact.prototype.PROXY="proxy";Contact.prototype.REDIRECT="redirect";Contact.prototype.EXPIRES="expires";Contact.prototype.Q="q";Contact.prototype.NAME_ADDR=1;Contact.prototype.SEMICOLON=";";Contact.prototype.SIP_INSTANCE="+sip.instance";Contact.prototype.PUB_GRUU="pub-gruu";Contact.prototype.TEMP_GRUU="temp-gruu";Contact.prototype.setParameter=function(b,c){var a=this.parameters.getNameValue(b);if(a!=null){a.setValueAsObject(c)}else{a=new NameValue(b,c);if(b.toLowerCase()=="methods"){a.setQuotedValue()}this.parameters.set_nv(a)}};Contact.prototype.encodeBody=function(){return this.encodeBodyBuffer("")};Contact.prototype.encodeBodyBuffer=function(a){if(this.wildCardFlag){a=a+"*"}else{if(this.address.getAddressType()==this.NAME_ADDR){a=this.address.encodeBuffer(a)}else{a=a+"<";a=this.address.encodeBuffer(a);a=a+">"}if(this.parameters.hmap.length!=0){a=a+this.SEMICOLON;a=this.parameters.encodeBuffer(a)}}return a};Contact.prototype.getContactList=function(){return this.contactList};Contact.prototype.getWildCardFlag=function(){return this.wildCardFlag};Contact.prototype.getAddress=function(){return this.address};Contact.prototype.getContactParms=function(){return this.parameters};Contact.prototype.getExpires=function(){return this.getParameterAsNumber(this.EXPIRES)};Contact.prototype.setExpires=function(b){var a=b-0;this.parameters.set_name_value(this.EXPIRES,a)};Contact.prototype.getQValue=function(){return this.getParameterAsNumber(Q)};Contact.prototype.setContactList=function(a){this.contactList=a};Contact.prototype.setWildCardFlag=function(a){this.wildCardFlag=true;this.address=new AddressImpl();this.address.setWildCardFlag()};Contact.prototype.setAddress=function(a){if(a==null){console.error("CSeq:setAddress(): the address parameter is null");throw"CSeq:setAddress(): the address parameter is null"}this.address=a;this.wildCardFlag=false};Contact.prototype.setQValue=function(a){if(a!=-1&&(a<0||a>1)){console.error("CSeq:setQValue(): the qValue is not between 0 and 1");throw"CSeq:setQValue(): Jthe qValue is not between 0 and 1"}var b=new Number(a);this.parameters.set_name_value(Q,b)};Contact.prototype.setWildCard=function(){this.setWildCardFlag(true)};Contact.prototype.isWildCard=function(){return this.address.isWildcard()};Contact.prototype.removeSipInstanceParam=function(){if(this.parameters!=null){this.parameters.delet(this.SIP_INSTANCE)}};Contact.prototype.getSipInstanceParam=function(){return this.parameters.getValue(this.SIP_INSTANCE)};Contact.prototype.setSipInstanceParam=function(a){this.parameters.set_name_value(this.SIP_INSTANCE,a)};Contact.prototype.removePubGruuParam=function(){if(this.parameters!=null){this.parameters.delet(this.PUB_GRUU)}};Contact.prototype.getPubGruuParam=function(){return this.parameters.getValue(this.PUB_GRUU)};Contact.prototype.setPubGruuParam=function(a){this.parameters.set_name_value(this.PUB_GRUU,a)};Contact.prototype.removeTempGruuParam=function(){if(this.parameters!=null){this.parameters.delet(this.TEMP_GRUU)}};Contact.prototype.getTempGruuParam=function(){return this.parameters.getValue(this.TEMP_GRUU)};Contact.prototype.setTempGruuParam=function(a){this.parameters.set_name_value(this.TEMP_GRUU,a)};function MediaRange(){this.classname="MediaRange";this.type=null;this.subtype=null}MediaRange.prototype=new SIPObject();MediaRange.prototype.constructor=MediaRange;MediaRange.prototype.SLASH="/";MediaRange.prototype.getType=function(){return this.type};MediaRange.prototype.getSubtype=function(){return this.subtype};MediaRange.prototype.setType=function(a){this.type=a};MediaRange.prototype.setSubtype=function(a){this.subtype=a};MediaRange.prototype.encode=function(){return this.encodeBuffer("").toString()};MediaRange.prototype.encodeBuffer=function(a){a=a+this.type+this.SLASH+this.subtype;return a};function AuthenticationHeader(a){this.classname="AuthenticationHeader";this.headerName=null;this.scheme=null;if(a==null){this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.parameters.setSeparator(this.COMMA)}else{this.headerName=a;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.parameters.setSeparator(this.COMMA);this.scheme=this.DIGEST}}AuthenticationHeader.prototype=new ParametersHeader();AuthenticationHeader.prototype.constructor=AuthenticationHeader;AuthenticationHeader.prototype.DOMAIN="domain";AuthenticationHeader.prototype.REALM="realm";AuthenticationHeader.prototype.OPAQUE="opaque";AuthenticationHeader.prototype.ALGORITHM="algorithm";AuthenticationHeader.prototype.QOP="qop";AuthenticationHeader.prototype.STALE="stale";AuthenticationHeader.prototype.SIGNATURE="signature";AuthenticationHeader.prototype.RESPONSE="response";AuthenticationHeader.prototype.SIGNED_BY="signed-by";AuthenticationHeader.prototype.NC="nc";AuthenticationHeader.prototype.URI="uri";AuthenticationHeader.prototype.USERNAME="username";AuthenticationHeader.prototype.CNONCE="cnonce";AuthenticationHeader.prototype.NONCE="nonce";AuthenticationHeader.prototype.IK="ik";AuthenticationHeader.prototype.CK="ck";AuthenticationHeader.prototype.INTEGRITY_PROTECTED="integrity-protected";AuthenticationHeader.prototype.COMMA=",";AuthenticationHeader.prototype.DIGEST="Digest";AuthenticationHeader.prototype.DOUBLE_QUOTE='"';AuthenticationHeader.prototype.SP=" ";AuthenticationHeader.prototype.setParameter=function(b,c){var a=this.parameters.getNameValue(b.toLowerCase());if(a==null){a=new NameValue(b,c);if(b.toLowerCase()==this.QOP||b.toLowerCase()==this.REALM||b.toLowerCase()==this.CNONCE||b.toLowerCase()==this.NONCE||b.toLowerCase()==this.USERNAME||b.toLowerCase()==this.DOMAIN||b.toLowerCase()==this.OPAQUE||b.toLowerCase()==this.NEXT_NONCE||b.toLowerCase()==this.URI||b.toLowerCase()==this.RESPONSE||b.toLowerCase()==this.IK||b.toLowerCase()==this.CK||b.toLowerCase()==this.INTEGRITY_PROTECTED){if(((this instanceof Authorization)||(this instanceof ProxyAuthorization))&&b.toLowerCase()==this.QOP){}else{a.setQuotedValue()}if(c==null){console.error("AuthenticationHeader:setParameter(): null value");throw"AuthenticationHeader:setParameter(): null value"}if(c.charAt(0)==this.DOUBLE_QUOTE){console.error("AuthenticationHeader:setParameter(): unexpected DOUBLE_QUOTE");throw"AuthenticationHeader:setParameter(): unexpected DOUBLE_QUOTE"}}this.parameters.set_nv(a)}else{a.setValueAsObject(c)}};AuthenticationHeader.prototype.setChallenge=function(a){this.scheme=a.scheme;this.parameters=a.authParams};AuthenticationHeader.prototype.encodeBody=function(){this.parameters.setSeparator(this.COMMA);return this.scheme+this.SP+this.parameters.encode()};AuthenticationHeader.prototype.setScheme=function(a){this.scheme=a};AuthenticationHeader.prototype.getScheme=function(){return this.scheme};AuthenticationHeader.prototype.setRealm=function(a){if(a==null){console.error("AuthenticationHeader:setRealm(): the realm parameter is null");throw"AuthenticationHeader:setRealm(): the realm parameter is null"}this.setParameter(this.REALM,a)};AuthenticationHeader.prototype.getRealm=function(){return this.getParameter(this.REALM)};AuthenticationHeader.prototype.setNonce=function(a){if(a==null){console.error("AuthenticationHeader:setNonce(): the nonce parameter is null");throw"AuthenticationHeader:setNonce(): the nonce parameter is null"}this.setParameter(this.NONCE,a)};AuthenticationHeader.prototype.getNonce=function(){return this.getParameter(this.NONCE)};AuthenticationHeader.prototype.setURI=function(b){if(b!=null){var a=new NameValue(this.URI,b);a.setQuotedValue();this.parameters.set_nv(a)}else{console.error("AuthenticationHeader:setNonce(): the uri parameter is null");throw"AuthenticationHeader:setURI(): the uri parameter is null"}};AuthenticationHeader.prototype.getURI=function(){return this.getParameterAsURI(this.URI)};AuthenticationHeader.prototype.setAlgorithm=function(a){if(a==null){console.error("AuthenticationHeader:setAlgorithm(): the algorithm parameter is null");throw"AuthenticationHeader:setAlgorithm(): the algorithm parameter is null"}this.setParameter(this.ALGORITHM,a)};AuthenticationHeader.prototype.getAlgorithm=function(){return this.getParameter(this.ALGORITHM)};AuthenticationHeader.prototype.setQop=function(a){if(a==null){console.error("AuthenticationHeader:setQop(): the qop parameter is null");throw"AuthenticationHeader:setQop(): the qop parameter is null"}this.setParameter(this.QOP,a)};AuthenticationHeader.prototype.getQop=function(){return this.getParameter(this.QOP)};AuthenticationHeader.prototype.setOpaque=function(a){if(a==null){console.error("AuthenticationHeader:setOpaque(): the opaque parameter is null");throw"AuthenticationHeader:setOpaque(): the opaque parameter is null"}this.setParameter(this.OPAQUE,a)};AuthenticationHeader.prototype.getOpaque=function(){return this.getParameter(this.OPAQUE)};AuthenticationHeader.prototype.setDomain=function(a){if(a==null){console.error("AuthenticationHeader:setDomain(): the domain parameter is null");throw"AuthenticationHeader:setDomain(): the opaque parameter is null"}this.setParameter(this.DOMAIN,a)};AuthenticationHeader.prototype.getDomain=function(){return this.getParameter(this.DOMAIN)};AuthenticationHeader.prototype.setStale=function(a){this.parameters.set_nv(new NameValue(this.STALE,new Boolean(a)))};AuthenticationHeader.prototype.isStale=function(){return this.getParameterAsBoolean(this.STALE)};AuthenticationHeader.prototype.setCNonce=function(a){this.setParameter(this.CNONCE,a)};AuthenticationHeader.prototype.getCNonce=function(){return this.getParameter(this.CNONCE)};AuthenticationHeader.prototype.getNonceCount=function(){return this.getParameterAsNumber(this.NC)};AuthenticationHeader.prototype.setNonceCount=function(b){if(b<0){console.error("AuthenticationHeader:setNonceCount(): bad parameter");throw"AuthenticationHeader:setNonceCount(): bad parameter"}var c=new String(b);var a="00000000";c=a.substring(0,8-c.length)+c;this.setParameter(this.NC,c)};AuthenticationHeader.prototype.getResponse=function(){return this.getParameter(this.RESPONSE)};AuthenticationHeader.prototype.setResponse=function(a){if(a==null){console.error("AuthenticationHeader:setResponse(): the domain parameter is null");throw"AuthenticationHeader:setResponse():  the opaque parameter is null"}this.setParameter(this.RESPONSE,a)};AuthenticationHeader.prototype.getUsername=function(){return this.getParameter(this.USERNAME)};AuthenticationHeader.prototype.setUsername=function(a){this.setParameter(this.USERNAME,a)};AuthenticationHeader.prototype.setIK=function(a){if(a==null){console.error("AuthenticationHeader:setIK(): the auth-param IK parameter is null");throw"AuthenticationHeader:setIK(): the auth-param IK parameter is null"}this.setParameter(this.IK,a)};AuthenticationHeader.prototype.getIK=function(){return this.getParameter(this.IK)};AuthenticationHeader.prototype.setCK=function(a){if(a==null){console.error("AuthenticationHeader:setCK() the auth-param CK parameter is null");throw"AuthenticationHeader:setCK(): the auth-param CK parameter is null"}this.setParameter(this.CK,a)};AuthenticationHeader.prototype.getCK=function(){return this.getParameter(this.CK)};AuthenticationHeader.prototype.setIntegrityProtected=function(a){if(a==null){console.error("AuthenticationHeader:setIntegrityProtected(): the integrity-protected parameter is null");throw"AuthenticationHeader:setIntegrityProtected(): the integrity-protected parameter is null"}this.setParameter(this.INTEGRITY_PROTECTED,a)};AuthenticationHeader.prototype.getIntegrityProtected=function(){return this.getParameter(this.INTEGRITY_PROTECTED)};function WWWAuthenticate(){this.classname="WWWAuthenticate";this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.parameters.setSeparator(this.COMMA);this.scheme=this.DIGEST}WWWAuthenticate.prototype=new AuthenticationHeader();WWWAuthenticate.prototype.constructor=WWWAuthenticate;WWWAuthenticate.prototype.NAME="WWW-Authenticate";WWWAuthenticate.prototype.COMMA=",";WWWAuthenticate.prototype.DIGEST="Digest";WWWAuthenticate.prototype.getURI=function(){return null};WWWAuthenticate.prototype.setURI=function(a){};function Route(a){this.classname="Route";if(a==null){this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}else{this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.address=a}}Route.prototype=new AddressParametersHeader();Route.prototype.constructor=Route;Route.prototype.NAME="Route";Route.prototype.NAME_ADDR=1;Route.prototype.SEMICOLON=";";Route.prototype.hashCode=function(){var d=0;var a=this.address.getHostPort().encode().toLowerCase();if(!(a==null||a.value=="")){for(var b=0;b<a.length;b++){d=d*31+a.charCodeAt(b);var c=2147483647;var e=-2147483648;if(d>c||d<e){d&=4294967295}}}return d};Route.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};Route.prototype.encodeBodyBuffer=function(a){var b=this.address.getAddressType()==this.NAME_ADDR;if(!b){a=a+"<";a=this.address.encodeBuffer(a);a=a+">"}else{a=this.address.encodeBuffer(a)}if(this.parameters.hmap.length!=0){a=a+this.SEMICOLON;a=this.parameters.encodeBuffer(a)}return a};function ProxyAuthenticate(){this.classname="ProxyAuthenticate";this.headerName=this.PROXY_AUTHENTICATE;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.parameters.setSeparator(this.COMMA);this.scheme=this.DIGEST}ProxyAuthenticate.prototype=new AuthenticationHeader();ProxyAuthenticate.prototype.constructor=ProxyAuthenticate;ProxyAuthenticate.prototype.PROXY_AUTHENTICATE="Proxy-Authenticate";ProxyAuthenticate.prototype.COMMA=",";ProxyAuthenticate.prototype.DIGEST="Digest";ProxyAuthenticate.prototype.getURI=function(){return null};ProxyAuthenticate.prototype.setURI=function(a){};function ProxyAuthorization(){this.classname="ProxyAuthorization";this.scheme=null;this.headerName=this.PROXY_AUTHORIZATION;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.parameters.setSeparator(this.COMMA);this.scheme=this.DIGEST}ProxyAuthorization.prototype=new AuthenticationHeader();ProxyAuthorization.prototype.constructor=ProxyAuthorization;ProxyAuthorization.prototype.PROXY_AUTHORIZATION="Proxy-Authorization";ProxyAuthorization.prototype.COMMA=",";ProxyAuthorization.prototype.DIGEST="Digest";function StatusLine(){this.classname="StatusLine";this.matchStatusClass=null;this.sipVersion=this.SIP_VERSION_STRING;this.statusCode=null;this.reasonPhrase=null}StatusLine.prototype=new SIPObject();StatusLine.prototype.constructor=StatusLine;StatusLine.prototype.SIP_VERSION_STRING="SIP/2.0";StatusLine.prototype.SP=" ";StatusLine.prototype.NEWLINE="\r\n";StatusLine.prototype.match=function(){};StatusLine.prototype.setMatchStatusClass=function(a){this.matchStatusClass=a};StatusLine.prototype.encode=function(){var a=this.SIP_VERSION_STRING+this.SP+this.statusCode;if(this.reasonPhrase!=null){a=a+this.SP+this.reasonPhrase}a=a+this.NEWLINE;return a};StatusLine.prototype.getSipVersion=function(){return this.sipVersion};StatusLine.prototype.getStatusCode=function(){return this.statusCode};StatusLine.prototype.getReasonPhrase=function(){return this.reasonPhrase};StatusLine.prototype.setSipVersion=function(a){this.sipVersion=a};StatusLine.prototype.setStatusCode=function(a){this.statusCode=a};StatusLine.prototype.setReasonPhrase=function(a){this.reasonPhrase=a};StatusLine.prototype.getVersionMajor=function(){if(this.sipVersion==null){return null}var a=null;var c=false;for(var b=0;b<this.sipVersion.length;b++){if(this.sipVersion.charAt(b)=="."){c=false}if(c){if(a==null){a=""+this.sipVersion.charAt(b)}else{a=a+this.sipVersion.charAt(b)}}if(this.sipVersion.charAt(b)=="/"){c=true}}return a};StatusLine.prototype.getVersionMinor=function(){if(this.sipVersion==null){return null}var c=null;var a=false;for(var b=0;b<this.sipVersion.length;b++){if(a){if(c==null){c=""+this.sipVersion.charAt(b)}else{c=c+this.sipVersion.charAt(b)}}if(this.sipVersion.charAt(b)=="."){a=true}}return c};function Authorization(){this.classname="Authorization";this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.parameters.setSeparator(this.COMMA);this.scheme=this.DIGEST}Authorization.prototype=new AuthenticationHeader();Authorization.prototype.constructor=Authorization;Authorization.prototype.NAME="Authorization";Authorization.prototype.COMMA=",";Authorization.prototype.DIGEST="Digest";function Allow(a){this.classname="Allow";this.method=null;if(a==null){this.headerName=this.ALLOW}else{if(arguments.length==1){this.headerName=this.ALLOW;this.method=a}}}Allow.prototype=new SIPHeader();Allow.prototype.constructor=Allow;Allow.prototype.ALLOW="Allow";Allow.prototype.getMethod=function(){return this.method};Allow.prototype.setMethod=function(a){if(a==null){console.error("Allow:setMethod(): JAIN-SIP Exception, the method parameter is null.");throw"Allow:setMethod(): the method parameter is null."}this.method=a};Allow.prototype.encodeBody=function(){return this.method};function RecordRoute(a){this.classname="RecordRoute";if(a==null){this.headerName=this.RECORD_ROUTE;this.address=new AddressImpl();this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}else{this.headerName=this.NAME;this.address=a;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}}RecordRoute.prototype=new AddressParametersHeader();RecordRoute.prototype.constructor=RecordRoute;RecordRoute.prototype.NAME="Record-Route";RecordRoute.prototype.RECORD_ROUTE="Record-Route";RecordRoute.prototype.ADDRESS_SPEC=2;RecordRoute.prototype.LESS_THAN="<";RecordRoute.prototype.GREATER_THAN=">";RecordRoute.prototype.SEMICOLON=";";RecordRoute.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};RecordRoute.prototype.encodeBodyBuffer=function(a){if(this.address.getAddressType()==this.ADDRESS_SPEC){a=a+this.LESS_THAN}a=this.address.encodeBuffer(a);if(this.address.getAddressType()==this.ADDRESS_SPEC){a=a+this.GREATER_THAN}if(this.parameters.hmap.length!=0){a=a+this.SEMICOLON;a=this.parameters.encodeBuffer(a)}return a};function MaxForwards(a){this.classname="MaxForwards";this.headerName=this.NAME;this.maxForwards=null;if(a==null){this.headerName=this.NAME}else{this.headerName=this.NAME;this.setMaxForwards(a)}}MaxForwards.prototype=new SIPHeader();MaxForwards.prototype.constructor=MaxForwards;MaxForwards.prototype.NAME="Max-Forwards";MaxForwards.prototype.getMaxForwards=function(){return this.maxForwards};MaxForwards.prototype.setMaxForwards=function(a){if(a<0||a>255){console.error("MaxForwards:setMaxForwards(): bad max forwards value "+a);throw"MaxForwards:setMaxForwards(): bad max forwards value "+a}this.maxForwards=a};MaxForwards.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};MaxForwards.prototype.encodeBodyBuffer=function(a){a=a+this.maxForwards;return a};MaxForwards.prototype.hasReachedZero=function(){if(this.maxForwards==0){return true}else{return false}};MaxForwards.prototype.decrementMaxForwards=function(){if(this.maxForwards>0){this.maxForwards--}else{console.error("MaxForwards:decrementMaxForwards(): has already reached 0!");throw"MaxForwards:decrementMaxForwards(): has already reached 0!"}};function ContentType(b,a){this.classname="ContentType";this.mediaRange=new MediaRange();this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();if(b!=null&&a!=null){this.setContentType(b,a)}}ContentType.prototype=new ParametersHeader();ContentType.prototype.constructor=ContentType;ContentType.prototype.NAME="Content-Type";ContentType.prototype.SEMICOLON=";";ContentType.prototype.compareMediaRange=function(f){var b=(this.mediaRange.type+"/"+this.mediaRange.subtype).toLowerCase();var a=f.toLowerCase();var g=0;var e;if(b.length>=a.length){e=b.length}else{e=a.length}for(var d=0;d<e;d++){if(b.charAt(d)==null){}else{if(b.charAt(d)>a.charAt(d)){g=g+1}else{if(b.charAt(d)<a.charAt(d)){g=g-1}}}}return g};ContentType.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};ContentType.prototype.encodeBodyBuffer=function(a){a=this.mediaRange.encodeBuffer(a);if(this.hasParameters()){a=a+this.SEMICOLON;a=this.parameters.encodeBuffer(a)}return a};ContentType.prototype.getMediaRange=function(){return this.mediaRange};ContentType.prototype.getMediaType=function(){return this.mediaRange.type};ContentType.prototype.getMediaSubType=function(){return this.mediaRange.subtype};ContentType.prototype.getContentSubType=function(){return this.mediaRange==null?null:this.mediaRange.getSubtype()};ContentType.prototype.getContentType=function(){return this.mediaRange==null?null:this.mediaRange.getType()};ContentType.prototype.getCharset=function(){return this.getParameter("charset")};ContentType.prototype.setMediaRange=function(a){this.mediaRange=a};ContentType.prototype.setContentType=function(){if(arguments==1){var b=arguments[0];if(b==null){console.error("ContentType:setContentType(): null argument");throw"ContentType:setContentType(): null argument"}if(this.mediaRange==null){this.mediaRange=new MediaRange()}this.mediaRange.setType(b)}else{b=arguments[0];var a=arguments[1];if(this.mediaRange==null){this.mediaRange=new MediaRange()}this.mediaRange.setType(b);this.mediaRange.setSubtype(a)}};ContentType.prototype.setContentSubType=function(a){if(a==null){console.error("ContentType:setContentSubType(): null contentType parameter");throw"ContentType:setContentSubType(): null contentType parameter"}if(this.mediaRange==null){this.mediaRange=new MediaRange()}this.mediaRange.setSubtype(a)};function TimeStamp(){this.classname="TimeStamp";this.timeStamp=-1;this.delay=-1;this.delayFloat=-1;this.timeStampFloat=-1;this.headerName=this.TIMESTAMP}TimeStamp.prototype=new SIPHeader();TimeStamp.prototype.constructor=TimeStamp;TimeStamp.prototype.TIMESTAMP="Timestamp";TimeStamp.prototype.getTimeStampAsString=function(){if(this.timeStamp==-1&&this.timeStampFloat==-1){return""}else{if(this.timeStamp!=-1){return this.timeStamp.toString()}else{return this.timeStampFloat.toString()}}};TimeStamp.prototype.getDelayAsString=function(){if(this.delay==-1&&this.delayFloat==-1){return""}else{if(this.delay!=-1){return this.delay.toString()}else{return this.delayFloat.toString()}}};TimeStamp.prototype.encodeBody=function(){var a="";var c=this.getTimeStampAsString();var b=this.getDelayAsString();if(c==""&&b==""){return""}if(c!=""){a=a+c}if(b!=""){a=a+" "+b}return a.toString()};TimeStamp.prototype.hasDelay=function(){if(this.delay!=-1){return true}else{return false}};TimeStamp.prototype.removeDelay=function(){this.delay=-1};TimeStamp.prototype.setTimeStamp=function(a){if(a<0){console.error("TimeStamp:setTimeStamp(): the timeStamp parameter is <0");throw"TimeStamp:setTimeStamp(): the timeStamp parameter is <0"}this.timeStamp=-1;this.timeStampFloat=a};TimeStamp.prototype.getTimeStamp=function(){if(this.timeStampFloat==-1){return this.timeStamp}else{return this.timeStampFloat}};TimeStamp.prototype.getDelay=function(){if(this.delayFloat==-1){return this.delay}else{return this.delayFloat}};TimeStamp.prototype.setDelay=function(a){if(a<0&&a!=-1){console.error("TimeStamp:setDelay(): the delay parameter is <0");throw"TimeStamp:setDelay(): the delay parameter is <0"}this.delayFloat=a;this.delay=-1};TimeStamp.prototype.getTime=function(){return this.timeStamp==-1?this.timeStampFloat:this.timeStamp};TimeStamp.prototype.getTimeDelay=function(){return this.delay==-1?this.delayFloat:this.delay};TimeStamp.prototype.setTime=function(a){if(this.timeStamp<-1){console.error("TimeStamp:setTime(): illegal timestamp");throw"TimeStamp:setTime(): illegal timestamp"}this.timeStamp=a;this.timeStampFloat=-1};TimeStamp.prototype.setTimeDelay=function(a){if(a<-1){console.error("TimeStamp:setTimeDelay(): value out of range "+a);throw"TimeStamp:setTimeDelay(): value out of range "+a}this.delay=a;this.delayFloat=-1};function ContentDisposition(a){this.classname="ContentDisposition";this.dispositionType=null;this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}ContentDisposition.prototype=new ParametersHeader();ContentDisposition.prototype.constructor=ContentDisposition;ContentDisposition.prototype.NAME="Content-Disposition";ContentDisposition.prototype.SEMICOLON=";";ContentDisposition.prototype.encodeBody=function(){var a=this.dispositionType;if(this.parameters.hmap.length!=0){a=a+this.SEMICOLON+this.parameters.encode()}return a.toString()};ContentDisposition.prototype.setDispositionType=function(a){if(a==null){console.error("ContentDisposition:setDispositionType(): the dispositionType parameter is null");throw"ContentDisposition:setDispositionType(): the dispositionType parameter is null"}this.dispositionType=a};ContentDisposition.prototype.getDispositionType=function(){return this.dispositionType};ContentDisposition.prototype.getHandling=function(){return this.getParameter("handling")};ContentDisposition.prototype.setHandling=function(a){if(a==null){console.error("ContentDisposition:setHandling(): the handling parameter is null");throw"ContentDisposition:setHandling(): the handling parameter is null"}this.setParameter("handling",a)};ContentDisposition.prototype.getContentDisposition=function(){return this.encodeBody()};function CallIdentifier(){this.classname="CallIdentifier";this.localId=null;this.host=null;if(arguments.length==2){var a=arguments[0];var b=arguments[1];this.localId=a;this.host=b}else{if(arguments.length==1){var c=arguments[0];this.setCallID(c)}}}CallIdentifier.prototype=new SIPObject();CallIdentifier.prototype.constructor=CallIdentifier;CallIdentifier.prototype.AT="@";CallIdentifier.prototype.encode=function(){return this.encodeBuffer("").toString()};CallIdentifier.prototype.encodeBuffer=function(a){a=a+this.localId;if(this.host!=null){a=a+this.AT+this.host}return a};CallIdentifier.prototype.hashCode=function(){if(this.localId==null){console.error("CallIdentifier:hashCode(): hash code called before id is set");throw"CallIdentifier:hashCode(): hash code called before id is set"}var d=0;var a=this.localId.toLowerCase();if(!(a==null||a.value=="")){for(var b=0;b<a.length;b++){d=d*31+a.charCodeAt(b);var c=2147483647;var e=-2147483648;if(d>c||d<e){d&=4294967295}}}return d};CallIdentifier.prototype.getLocalId=function(){return this.localId};CallIdentifier.prototype.getHost=function(){return this.host};CallIdentifier.prototype.setLocalId=function(a){this.localId=a};CallIdentifier.prototype.setCallID=function(b){if(b==null){console.error("CallIdentifier:setCallID(): cid parameter is null");throw"CallIdentifier:setCallID(): cid parameter is null"}var a=b.indexOf("@");if(a==-1){this.localId=b;this.host=null}else{this.localId=b.substring(0,a);this.host=b.substring(a+1,b.length);if(this.localId==null||this.host==null){console.error("CallIdentifier:setCallID(): CallID  must be token@token or token");throw"CallIdentifier:setCallID(): CallID  must be token@token or token"}}};CallIdentifier.prototype.setHost=function(a){this.host=a};function CallID(){this.classname="CallID";this.headerName=this.NAME;this.callIdentifier=new CallIdentifier();if(arguments.length!=0){var a=arguments[0];this.callIdentifier=new CallIdentifier(a)}}CallID.prototype=new SIPHeader();CallID.prototype.constructor=CallID;CallID.prototype.NAME="Call-ID";CallID.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};CallID.prototype.encodeBodyBuffer=function(a){if(this.callIdentifier!=null){a=this.callIdentifier.encodeBuffer(a)}return a};CallID.prototype.getCallId=function(){return this.encodeBody()};CallID.prototype.getCallIdentifer=function(){return this.callIdentifier};CallID.prototype.setCallId=function(a){this.callIdentifier=new CallIdentifier(a)};CallID.prototype.setCallIdentifier=function(a){this.callIdentifier=a};function CSeq(){this.classname="CSeq";this.method=null;this.seqno=null;if(arguments.length==0){this.headerName=this.CSEQ}else{var c=arguments[0];var b=arguments[1];this.headerName=this.CSEQ;this.seqno=c;var a=new SIPRequest();this.method=a.getCannonicalName(b)}}CSeq.prototype=new SIPHeader();CSeq.prototype.constructor=CSeq;CSeq.prototype.CSEQ="CSeq";CSeq.prototype.COLON=":";CSeq.prototype.SP=" ";CSeq.prototype.NEWLINE="\r\n";CSeq.prototype.encode=function(){return this.headerName+this.COLON+this.SP+this.encodeBody()+this.NEWLINE};CSeq.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};CSeq.prototype.encodeBodyBuffer=function(a){a=a+this.seqno+this.SP+this.method.toUpperCase();return a};CSeq.prototype.getMethod=function(){return this.method};CSeq.prototype.setSeqNumber=function(a){if(a<0){console.error("CSeq:setSeqNumber(): the sequence number parameter is < 0 : "+a);throw"CSeq:setSeqNumber(): the sequence number parameter is < 0 : "+a}else{if(a>2147483647){console.error("CSeq:setSeqNumber(): the sequence number parameter is too large : "+a);throw"CSeq:setSeqNumber(): the sequence number parameter is too large : "+a}}this.seqno=a};CSeq.prototype.setSequenceNumber=function(a){this.setSeqNumber(a)};CSeq.prototype.setMethod=function(b){if(b==null){console.error("CSeq:setMethod(): the method parameter is null");throw"CSeq:setMethod(): the meth parameter is null"}var a=new SIPRequest();this.method=a.getCannonicalName(b)};CSeq.prototype.getSequenceNumber=function(){if(this.seqno==null){return 0}else{return this.seqno}};CSeq.prototype.getSeqNumber=function(){return this.seqno};function Supported(a){this.classname="Supported";this.optionTag=null;if(a!=null){this.headerName="Supported";this.optionTag=a}else{this.headerName="Supported";this.optionTag=null}}Supported.prototype=new SIPHeader();Supported.prototype.constructor=Supported;Supported.prototype.COLON=":";Supported.prototype.NEWLINE="\r\n";Supported.prototype.encode=function(){var a=this.headerName+this.COLON;if(this.optionTag!=null){a=a+this.SP+this.optionTag}a=a+this.NEWLINE;return a};Supported.prototype.encodeBody=function(){return this.optionTag!=null?this.optionTag:""};Supported.prototype.setOptionTag=function(a){if(a==null){console.error("Supported:setOptionTag(): the optionTag parameter is null");throw"Supported:setOptionTag(): the optionTag parameter is null"}this.optionTag=a};Supported.prototype.getOptionTag=function(){return this.optionTag};function Expires(){this.classname="Expires";this.headerName=this.NAME;this.expires=null}Expires.prototype=new SIPHeader();Expires.prototype.constructor=Expires;Expires.prototype.NAME="Expires";Expires.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};Expires.prototype.encodeBodyBuffer=function(a){a=a+this.expires;return a};Expires.prototype.getExpires=function(){return this.expires};Expires.prototype.setExpires=function(a){if(a<0){console.error("Expires:setExpires(): bad argument "+a);throw"Expires:setExpires(): bad argument "+a}this.expires=a};function ContactList(){this.classname="ContactList";this.headerName=this.NAME;this.myClass="Contact";this.hlist=new Array()}ContactList.prototype=new SIPHeaderList();ContactList.prototype.constructor=ContactList;ContactList.prototype.NAME="Contact";ContactList.prototype.clone=function(){};function ViaList(){this.classname="ViaList";this.headerName=this.NAME;this.myClass="Via";this.hlist=new Array()}ViaList.prototype=new SIPHeaderList();ViaList.prototype.constructor=ViaList;ViaList.prototype.NAME="Via";ViaList.prototype.clone=function(){};function WWWAuthenticateList(){this.classname="WWWAuthenticateList";this.headerName=this.NAME;this.myClass="WWWAuthenticate";this.hlist=new Array()}WWWAuthenticateList.prototype=new SIPHeaderList();WWWAuthenticateList.prototype.constructor=WWWAuthenticateList;WWWAuthenticateList.prototype.NAME="WWW-Authenticate";WWWAuthenticateList.prototype.clone=function(){};function RouteList(){this.classname="RouteList";this.headerName=this.NAME;this.myClass="Route";this.hlist=new Array()}RouteList.prototype=new SIPHeaderList();RouteList.prototype.constructor=RouteList;RouteList.prototype.NAME="Route";RouteList.prototype.clone=function(){};RouteList.prototype.encode=function(){if(this.hlist.length==0){return""}else{return this.encodeBuffer("")}};RouteList.prototype.equals=function(){};function ProxyAuthenticateList(){this.classname="ProxyAuthenticateList";this.headerName=this.NAME;this.myClass="ProxyAuthenticate";this.hlist=new Array()}ProxyAuthenticateList.prototype=new SIPHeaderList();ProxyAuthenticateList.prototype.constructor=ProxyAuthenticateList;ProxyAuthenticateList.prototype.NAME="Proxy-Authenticate";ProxyAuthenticateList.prototype.clone=function(){};function ProxyAuthorizationList(){this.classname="ProxyAuthorizationList";this.headerName=this.NAME;this.myClass="ProxyAuthorization"}ProxyAuthorizationList.prototype=new SIPHeaderList();ProxyAuthorizationList.prototype.constructor=ProxyAuthorizationList;ProxyAuthorizationList.prototype.NAME="Proxy-Authorization";ProxyAuthorizationList.prototype.clone=function(){};function AuthorizationList(){this.classname="AuthorizationList";this.headerName=this.NAME;this.myClass="Authorization"}AuthorizationList.prototype=new SIPHeaderList();AuthorizationList.prototype.constructor=AuthorizationList;AuthorizationList.prototype.NAME="Authorization";AuthorizationList.prototype.clone=function(){};function AllowList(){this.classname="AllowList";this.headerName=this.NAME;this.myClass="Allow";this.hlist=new Array()}AllowList.prototype=new SIPHeaderList();AllowList.prototype.constructor=AllowList;AllowList.prototype.NAME="Allow";AllowList.prototype.clone=function(){};AllowList.prototype.getMethods=function(){var d=new Array();for(var c=0;c<this.hlist.length;c++){var b=this.hlist[c];d[c]=b.getMethod()}return d};AllowList.prototype.setMethods=function(a){var d=new Array();for(var b=0;b<a.length;b++){var c=new Allow();c.setMethod(a[b]);this.add(c)}return d};function AllowEvents(a){this.serialVersionUID="5281728373401351378L";this.classname="AllowEvents";this.eventType=null;if(a==null){this.headerName=this.ALLOW_EVENTS}else{this.headerName=this.ALLOW_EVENTS;this.eventType=a}}AllowEvents.prototype=new SIPHeader();AllowEvents.prototype.constructor=AllowEvents;AllowEvents.prototype.ALLOW_EVENTS="Allow-Events";AllowEvents.prototype.setEventType=function(a){if(a==null){console.error("AllowEvents:setEventType(): the eventType parameter is null");throw"AllowEvents:setEventType(): the eventType parameter is null"}this.eventType=a};AllowEvents.prototype.getEventType=function(){return this.eventType};AllowEvents.prototype.encodeBody=function(){return this.eventType};function EventHeader(a){this.classname="Event";this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.eventType=null;if(a!=null){this.eventType=a}}EventHeader.prototype=new ParametersHeader();EventHeader.prototype.constructor=EventHeader;EventHeader.prototype.NAME="Event";EventHeader.prototype.setEventType=function(a){if(a==null){console.error("Event:setEventType(): the eventType parameter is null");throw"Event:setEventType(): the eventType parameter is null"}this.eventType=a};EventHeader.prototype.getEventType=function(){return this.eventType};EventHeader.prototype.encodeBody=function(){return this.eventType};function AllowEventsList(){this.serialVersionUID="-684763195336212992L";this.classname="AllowEventsList";this.headerName=this.NAME;this.myClass="AllowEvents"}AllowEventsList.prototype=new SIPHeaderList();AllowEventsList.prototype.constructor=AllowEventsList;AllowEventsList.prototype.NAME="Allow-Events";AllowEventsList.prototype.clone=function(){};AllowEventsList.prototype.getMethods=function(){var b=Object.getPrototypeOf(this).hlist;var d=new Array();for(var a=0;a<b.length;a++){var c=b[a];d[a]=c.getEventType()}return d};AllowEventsList.prototype.setMethods=function(a){for(var b=0;b<a.length;b++){var c=new AllowEvents();c.setEventType(a[b]);this.add(c)}};function RecordRouteList(){this.classname="RecordRouteList";this.headerName=this.NAME;this.myClass="RecordRoute";this.hlist=new Array()}RecordRouteList.prototype=new SIPHeaderList();RecordRouteList.prototype.constructor=RecordRouteList;RecordRouteList.prototype.NAME="Record-Route";RecordRouteList.prototype.clone=function(){};function SupportedList(){this.classname="SupportedList";this.headerName=this.NAME;this.myClass="Supported";this.hlist=new Array()}SupportedList.prototype=new SIPHeaderList();SupportedList.prototype.constructor=SupportedList;SupportedList.prototype.NAME="Supported";SupportedList.prototype.clone=function(){};function HeaderFactoryImpl(){this.classname="HeaderFactoryImpl";this.stripAddressScopeZones=false}HeaderFactoryImpl.prototype=new SIPHeaderList();HeaderFactoryImpl.prototype.constructor=HeaderFactoryImpl;HeaderFactoryImpl.prototype.NAME="Authorization";HeaderFactoryImpl.prototype.setPrettyEncoding=function(b){var a=new SIPHeaderList();a.setPrettyEncode(b)};HeaderFactoryImpl.prototype.createAllowEventsHeader=function(a){if(a==null){console.error("HeaderFactoryImpl:createAllowEventsHeader(): null arg eventType");throw"HeaderFactoryImpl:createAllowEventsHeader(): null arg eventType"}var b=new AllowEvents();b.setEventType(a);return b};HeaderFactoryImpl.prototype.createAllowHeader=function(b){if(b==null){console.error("HeaderFactoryImpl:createAllowHeader(): null arg method");throw"HeaderFactoryImpl:createAllowHeader(): null arg method"}var a=new Allow();a.setMethod(b);return a};HeaderFactoryImpl.prototype.createCSeqHeader=function(b,c){if(b<0){console.error("HeaderFactoryImpl:createCSeqHeader(): bad arg "+b);throw"HeaderFactoryImpl:createCSeqHeader(): bad arg "+b}if(c==null){console.error("HeaderFactoryImpl:createCSeqHeader(): null arg method");throw"HeaderFactoryImpl:createCSeqHeader(): null arg method"}var a=new CSeq();a.setMethod(c);a.setSeqNumber(b);return a};HeaderFactoryImpl.prototype.createCallIdHeader=function(b){if(b==null){var a=new Date();b=new String(a.getTime())}var d=new CallID();d.setCallId(b);return d};HeaderFactoryImpl.prototype.createContactHeader=function(){if(arguments.length==0){var a=new Contact();a.setWildCardFlag(true);a.setExpires(0);return a}else{var b=arguments[0];if(b==null){console.error("HeaderFactoryImpl:createContactHeader(): null arg address");throw"HeaderFactoryImpl:createContactHeader(): null arg address"}a=new Contact();a.setAddress(b);return a}};HeaderFactoryImpl.prototype.createContentDispositionHeader=function(a){if(a<0){console.error("HeaderFactoryImpl:createContentDispositionHeader(): null arg contentDisposition");throw"HeaderFactoryImpl:createContentDispositionHeader(): null arg contentDisposition"}var b=new ContentDisposition();b.setDispositionType(a);return b};HeaderFactoryImpl.prototype.createContentLengthHeader=function(a){if(a<0){console.error("HeaderFactoryImpl:createContentLengthHeader(): bad contentLength");throw"HeaderFactoryImpl:createContentLengthHeader(): bad contentLength"}var b=new ContentLength();b.setContentLength(a);return b};HeaderFactoryImpl.prototype.createContentTypeHeader=function(d,a){if(d==null||a==null){console.error("HeaderFactoryImpl:createContentTypeHeader(): null contentType or subType");throw"HeaderFactoryImpl:createContentTypeHeader(): null contentType or subType"}var b=new ContentType();b.setContentType(d);b.setContentSubType(a);return b};HeaderFactoryImpl.prototype.createEventHeader=function(a){if(a==null){console.error("HeaderFactoryImpl:createEventHeader(): null eventType");throw"HeaderFactoryImpl:createEventHeader(): null eventType"}return new EventHeader(a)};HeaderFactoryImpl.prototype.createExpiresHeader=function(a){if(a<0){console.error("HeaderFactoryImpl:createExpiresHeader(): bad value "+a);throw"HeaderFactoryImpl:createExpiresHeader(): bad value "+a}var b=new Expires();b.setExpires(a);return b};HeaderFactoryImpl.prototype.createExtensionHeader=function(a,c){if(a==null){console.error("HeaderFactoryImpl:createExtensionHeader(): bad name");throw"HeaderFactoryImpl:createExtensionHeader(): bad name"}var b=new ExtensionHeaderImpl();b.setName(a);b.setValue(c);return b};HeaderFactoryImpl.prototype.createFromHeader=function(b,a){if(b==null){console.error("HeaderFactoryImpl:createFromHeader(): null address arg");throw"HeaderFactoryImpl:createFromHeader(): null address arg"}var c=new From();c.setAddress(b);if(a!=null){c.setTag(a)}return c};HeaderFactoryImpl.prototype.createMaxForwardsHeader=function(b){if(b<0||b>255){console.error("HeaderFactoryImpl:createMaxForwardsHeader(): bad maxForwards arg "+b);throw"HeaderFactoryImpl:createMaxForwardsHeader(): bad maxForwards arg "+b}var a=new MaxForwards();a.setMaxForwards(b);return a};HeaderFactoryImpl.prototype.createProxyAuthenticateHeader=function(a){if(a==null){console.error("HeaderFactoryImpl:createProxyAuthenticateHeader(): null scheme arg");throw"HeaderFactoryImpl:createProxyAuthenticateHeader(): null scheme arg"}var b=new ProxyAuthenticate();b.setScheme(a);return b};HeaderFactoryImpl.prototype.createProxyAuthorizationHeader=function(a){if(a==null){console.error("HeaderFactoryImpl:createProxyAuthorizationHeader(): null scheme arg");throw"HeaderFactoryImpl:createProxyAuthorizationHeader():null scheme arg"}var b=new ProxyAuthorization();b.setScheme(a);return b};HeaderFactoryImpl.prototype.createReasonHeader=function(d,a,c){if(d==null){console.error("HeaderFactoryImpl:createReasonHeader(): null protocol arg");throw"HeaderFactoryImpl:createReasonHeader(): null protocol arg"}if(a<0){console.error("HeaderFactoryImpl:createReasonHeader(): bad cause");throw"HeaderFactoryImpl:createReasonHeader():bad cause"}var b=new Reason();b.setProtocol(d);b.setCause(a);b.setText(c);return b};HeaderFactoryImpl.prototype.createRecordRouteHeader=function(b){if(b==null){console.error("HeaderFactoryImpl:createRecordRouteHeader(): null address arg");throw"HeaderFactoryImpl:createRecordRouteHeader(): null address arg"}var a=new RecordRoute();a.setAddress(b);return a};HeaderFactoryImpl.prototype.createRouteHeader=function(a){if(a==null){console.error("HeaderFactoryImpl:createRouteHeader(): null address arg");throw"HeaderFactoryImpl:createRouteHeader(): null address arg"}var b=new Route();b.setAddress(a);return b};HeaderFactoryImpl.prototype.createSubjectHeader=function(a){if(a==null){console.error("HeaderFactoryImpl:createSubjectHeader(): null subject arg");throw"HeaderFactoryImpl:createSubjectHeader():  null subject arg"}var b=new Subject();b.setSubject(a);return b};HeaderFactoryImpl.prototype.createSupportedHeader=function(b){if(b==null){console.error("HeaderFactoryImpl:createSupportedHeader(): null optionTag arg");throw"HeaderFactoryImpl:createSupportedHeader(): null optionTag arg"}var a=new Supported();a.setOptionTag(b);return a};HeaderFactoryImpl.prototype.createTimeStampHeader=function(a){if(a<0){console.error("HeaderFactoryImpl:createTimeStampHeader(): illegal timeStamp");throw"HeaderFactoryImpl:createTimeStampHeader(): illegal timeStamp"}var b=new TimeStamp();b.setTimeStamp(a);return b};HeaderFactoryImpl.prototype.createToHeader=function(b,a){if(b==null){console.error("HeaderFactoryImpl:createToHeader(): null address arg");throw"HeaderFactoryImpl:createToHeader(): null address arg"}var c=new To();c.setAddress(b);if(a!=null){c.setTag(a)}return c};HeaderFactoryImpl.prototype.createReferToHeader=function(b,c){if(b==null){console.error("HeaderFactoryImpl:createReferToHeader(): null address arg");throw"HeaderFactoryImpl:createReferToHeader(): null address arg"}var a=new ReferTo();a.setAddress(b);a.setReplaces(c);return a};HeaderFactoryImpl.prototype.createReferredByHeader=function(a){if(a==null){console.error("HeaderFactoryImpl:createReferredByHeader(): null address arg");throw"HeaderFactoryImpl:createReferredByHeader(): null address arg"}var b=new ReferredBy();b.setAddress(a);return b};HeaderFactoryImpl.prototype.createUserAgentHeader=function(b){if(b==null){console.error("HeaderFactoryImpl:createUserAgentHeader(): null product arg");throw"HeaderFactoryImpl:createUserAgentHeader(): null product arg"}var a=new UserAgent();a.setProduct(b);return a};HeaderFactoryImpl.prototype.createViaHeader=function(e,a,f,d){if(e==null||f==null){console.error("HeaderFactoryImpl:createViaHeader(): null host or  transport arg");throw"HeaderFactoryImpl:createViaHeader(): null host or  transport arg"}var b=new Via();if(d!=null){b.setBranch(d)}if(e.indexOf(":")>=0&&e.indexOf("[")<0){if(this.stripAddressScopeZones){var c=e.indexOf("%");if(c!=-1){e=e.substring(0,c)}}e="["+e+"]"}b.setHost(e);if(a!=null){b.setPort(a)}if(f!=null){b.setTransport(f)}else{b.setTransport("WSS")}return b};HeaderFactoryImpl.prototype.createWWWAuthenticateHeader=function(a){if(a==null){console.error("HeaderFactoryImpl:createWWWAuthenticateHeader(): null scheme arg");throw"HeaderFactoryImpl:createWWWAuthenticateHeader(): null scheme arg"}var b=new WWWAuthenticate();b.setScheme(a);return b};HeaderFactoryImpl.prototype.createHeader=function(){if(arguments.length==1){var b=arguments[0];var f=new StringMsgParser();var e=f.parseSIPHeader(b.trim());if(e instanceof SIPHeaderList){if(e.size()>1){console.error("HeaderFactoryImpl:createHeader(): only singleton allowed "+b);throw"HeaderFactoryImpl:createHeader():only singleton allowed "+b}else{if(e.size()==0){var d=e.getMyClass();var h=new Function("return new "+d)();return h}else{return e.getFirst()}}}else{return e}}else{if(arguments.length==2){var g=arguments[0];var a=arguments[1];if(g==null){console.error("header name is null");console.error("HeaderFactoryImpl:createHeader(): header name is null");throw"HeaderFactoryImpl:createHeader(): header name is null"}var c=g+":"+a;return this.createHeader(c)}}};HeaderFactoryImpl.prototype.createHeaders=function(c){if(c==null){console.error("HeaderFactoryImpl:createHeaders(): null headers arg");throw"HeaderFactoryImpl:createHeaders(): null headers arg"}var b=new StringMsgParser();var a=b.parseSIPHeader(c);if(a instanceof SIPHeaderList){return a}else{console.error("HeaderFactoryImpl:createHeaders():List of headers of this type is not allowed in a message",0);throw"HeaderFactoryImpl:createHeaders(): list of headers of this type is not allowed in a message"}};HeaderFactoryImpl.prototype.createRouteList=function(f){if(f!=null){var e=new RouteList();for(var d=f.getHeaderList().length-1;d>=0;d--){var c=f.getHeaderList()[d];var b=new Route();var a=c.getAddress();b.setAddress(a);b.setParameters(c.getParameters());e.add(b)}return e}else{return new RouteList()}};HeaderFactoryImpl.prototype.createRequestLine=function(b){var a=new RequestLineParser(b);return a.parse()};HeaderFactoryImpl.prototype.createStatusLine=function(a){var b=new StatusLineParser(a);return b.parse()};HeaderFactoryImpl.prototype.createAuthorizationHeader=function(){if(arguments.length==1){var d=arguments[0];return this.createAuthorizationHeaderargu1(d)}else{var c=arguments[0];var e=arguments[1];var b=arguments[2];var f=arguments[3];var a=arguments[4];return this.createAuthorizationHeaderargu2(c,e,b,f)}};HeaderFactoryImpl.prototype.createAuthorizationHeaderargu1=function(a){if(a==null){console.error("HeaderFactoryImpl:createAuthorizationHeaderargu1(): null scheme arg");throw"HeaderFactoryImpl:createAuthorizationHeaderargu1(): null scheme arg"}var b=new Authorization();b.setScheme(a);return b};HeaderFactoryImpl.prototype.createAuthorizationHeaderargu2=function(g,h,c,e){if(g.hasHeader("www-authenticate")){var j=g.getWWWAuthenticate().getRealm();var d=g.getWWWAuthenticate().getScheme();var k=g.getWWWAuthenticate().getNonce();var b=g.getWWWAuthenticate().getQop();var l=new Authorization()}else{if(g.hasHeader("proxy-authenticate")){j=g.getProxyAuthenticate().getRealm();d=g.getProxyAuthenticate().getScheme();k=g.getProxyAuthenticate().getNonce();b=g.getProxyAuthenticate().getQop();var n=new ProxyAuthorization()}}var m=new MessageDigestAlgorithm();var a=g.getCSeq().getMethod();var p=null;var i=null;if(b!=null){var p=Math.floor(Math.random()*16777215).toString(16);var i="00000001"}var f=m.calculateResponse(e,j,c,k,i,p,a,h.getRequestURI().toString(),null,b);if(g.hasHeader("www-authenticate")){l.setUsername(e);l.setRealm(j);l.setNonce(k);if(p!=null){l.setCNonce(p)}if(i!=null){l.setNonceCount(i)}l.setScheme(d);l.setResponse(f);l.setURI(h.getRequestURI());l.setAlgorithm("MD5");if(b!=null){l.setQop(b)}return l}else{if(g.hasHeader("proxy-authenticate")){n.setUsername(e);n.setRealm(j);n.setNonce(k);if(p!=null){n.setCNonce(p)}if(i!=null){n.setNonceCount(i)}n.setScheme(d);n.setResponse(f);n.setURI(h.getRequestURI());n.setAlgorithm("MD5");if(b!=null){n.setQop(b)}return n}}};function Parser(){this.classname="Parser"}Parser.prototype=new ParserCore();Parser.prototype.constructor=Parser;Parser.prototype.INVITE=LexerCore.prototype.START+5;Parser.prototype.ACK=LexerCore.prototype.START+6;Parser.prototype.OPTIONS=LexerCore.prototype.START+8;Parser.prototype.BYE=LexerCore.prototype.START+7;Parser.prototype.REGISTER=LexerCore.prototype.START+4;Parser.prototype.CANCEL=LexerCore.prototype.START+9;Parser.prototype.SUBSCRIBE=LexerCore.prototype.START+53;Parser.prototype.NOTIFY=LexerCore.prototype.START+54;Parser.prototype.PUBLISH=LexerCore.prototype.START+67;Parser.prototype.MESSAGE=LexerCore.prototype.START+70;Parser.prototype.ID=LexerCore.prototype.ID;Parser.prototype.SIP=LexerCore.prototype.START+3;Parser.prototype.createParseException=function(){};Parser.prototype.getLexer=function(){return this.lexer};Parser.prototype.sipVersion=function(){var a=this.lexer.match(this.SIP);if(a.getTokenValue().toUpperCase()!="SIP"){this.createParseException("Expecting SIP")}this.lexer.match("/");a=this.lexer.match(this.ID);if(a.getTokenValue()!="2.0"){this.createParseException("Expecting SIP/2.0")}return"SIP/2.0"};Parser.prototype.method=function(){var b=this.lexer.peekNextToken(1);var a=b[0];if(a.getTokenType()==this.INVITE||a.getTokenType()==this.ACK||a.getTokenType()==this.OPTIONS||a.getTokenType()==this.BYE||a.getTokenType()==this.REGISTER||a.getTokenType()==this.CANCEL||a.getTokenType()==this.SUBSCRIBE||a.getTokenType()==this.NOTIFY||a.getTokenType()==this.PUBLISH||a.getTokenType()==this.MESSAGE||a.getTokenType()==this.ID){this.lexer.consume();return a.getTokenValue()}else{console.error("Parser:method(): invalid Method");throw"Parser:method(): invalid Method"}};Parser.prototype.checkToken=function(b){if(b==null||b.length==0){console.error("Parser:checkToken(): null or empty token");throw"Parser:method(): null or empty token"}else{for(var a=0;a<b.length;++a){var c=new LexerCore();if(!c.isTokenChar(b.charAt(a))){console.error("Parser:checkToken(): invalid character(s) in string (not allowed in 'token')",a);throw"Parser:method(): invalid character(s) in string (not allowed in 'token')"}}}};function Lexer(b,a){this.classname="Lexer";this.buffer=a;this.bufferLen=a.length;this.ptr=0;this.currentLexer=new Array();this.currentLexerName=b;this.selectLexer(b)}Lexer.prototype=new LexerCore();Lexer.prototype.constructor=Lexer;Lexer.prototype.ErrorInfoHeader="Error-Info";Lexer.prototype.AllowEventsHeader="Allow-Events";Lexer.prototype.AuthenticationInfoHeader="Authentication-Info";Lexer.prototype.EventHeader="Event";Lexer.prototype.MinExpiresHeader="Min-Expires";Lexer.prototype.RSeqHeader="RSeq";Lexer.prototype.RAckHeader="RAck";Lexer.prototype.ReasonHeader="Reason";Lexer.prototype.ReplyToHeader="Reply-To";Lexer.prototype.SubscriptionStateHeader="Subscription-State";Lexer.prototype.TimeStampHeader="Timestamp";Lexer.prototype.InReplyToHeader="In-Reply-To";Lexer.prototype.MimeVersionHeader="MIME-Version";Lexer.prototype.AlertInfoHeader="Alert-Info";Lexer.prototype.FromHeader="From";Lexer.prototype.ToHeader="To";Lexer.prototype.ReferToHeader="Refer-To";Lexer.prototype.ViaHeader="Via";Lexer.prototype.UserAgentHeader="User-Agent";Lexer.prototype.ServerHeader="Server";Lexer.prototype.AcceptEncodingHeader="Accept-Encoding";Lexer.prototype.AcceptHeader="Accept";Lexer.prototype.AllowHeader="Allow";Lexer.prototype.RouteHeader="Route";Lexer.prototype.AuthorizationHeader="Authorization";Lexer.prototype.ProxyAuthorizationHeader="Proxy-Authorization";Lexer.prototype.RetryAfterHeader="Retry-After";Lexer.prototype.ProxyRequireHeader="Proxy-Require";Lexer.prototype.ContentLanguageHeader="Content-Language";Lexer.prototype.UnsupportedHeader="Unsupported";Lexer.prototype.SupportedHeader="Supported";Lexer.prototype.WarningHeader="Warning";Lexer.prototype.MaxForwardsHeader="Max-Forwards";Lexer.prototype.DateHeader="Date";Lexer.prototype.PriorityHeader="Priority";Lexer.prototype.ProxyAuthenticateHeader="Proxy-Authenticate";Lexer.prototype.ContentEncodingHeader="Content-Encoding";Lexer.prototype.ContentLengthHeader="Content-Length";Lexer.prototype.SubjectHeader="Subject";Lexer.prototype.ContentTypeHeader="Content-Type";Lexer.prototype.ContactHeader="Contact";Lexer.prototype.CallIdHeader="Call-ID";Lexer.prototype.RequireHeader="Require";Lexer.prototype.ExpiresHeader="Expires";Lexer.prototype.RecordRouteHeader="Record-Route";Lexer.prototype.OrganizationHeader="Organization";Lexer.prototype.CSeqHeader="CSeq";Lexer.prototype.AcceptLanguageHeader="Accept-Language";Lexer.prototype.WWWAuthenticateHeader="WWW-Authenticate";Lexer.prototype.CallInfoHeader="Call-Info";Lexer.prototype.ContentDispositionHeader="Content-Disposition";Lexer.prototype.SIPETagHeader="SIP-ETag";Lexer.prototype.SIPIfMatchHeader="SIP-If-Match";Lexer.prototype.SessionExpiresHeader="Session-Expires";Lexer.prototype.MinSEHeader="Min-SE";Lexer.prototype.ReferredByHeader="Referred-By";Lexer.prototype.ReplacesHeader="Replaces";Lexer.prototype.JoinHeader="Join";Lexer.prototype.PathHeader="Path";Lexer.prototype.ServiceRouteHeader="Service-Route";Lexer.prototype.PAssertedIdentityHeader="P-Asserted-Identity";Lexer.prototype.PPreferredIdentityHeader="P-Preferred-Identity";Lexer.prototype.PrivacyHeader="Privacy";Lexer.prototype.PCalledPartyIDHeader="P-Called-Party-ID";Lexer.prototype.PAssociatedURIHeader="P-Associated-URI";Lexer.prototype.PVisitedNetworkIDHeader="P-Visited-Network-ID";Lexer.prototype.PChargingFunctionAddressesHeader="P-Charging-Function-Addresses";Lexer.prototype.PChargingVectorHeader="P-Charging-Vector";Lexer.prototype.PAccessNetworkInfoHeader="P-Access-Network-Info";Lexer.prototype.PMediaAuthorizationHeader="P-Media-Authorization";Lexer.prototype.SecurityServerHeader="Security-Server";Lexer.prototype.SecurityVerifyHeader="Security-Verify";Lexer.prototype.SecurityClientHeader="Security-Client";Lexer.prototype.PUserDatabaseHeader="P-User-Database";Lexer.prototype.PProfileKeyHeader="P-Profile-Key";Lexer.prototype.PServedUserHeader="P-Served-User";Lexer.prototype.PPreferredServiceHeader="P-Preferred-Service";Lexer.prototype.PAssertedServiceHeader="P-Asserted-Service";Lexer.prototype.ReferencesHeader="References";Lexer.prototype.AcceptContact="Accept-Contact";Lexer.prototype.getHeaderName=function(a){if(a==null){return null}var d=null;try{var c=a.indexOf(":");d=null;if(c>=1){d=a.substring(0,c).trim()}}catch(b){console.error("Lexer:getHeaderName(): catched exception:"+b);return null}return d};Lexer.prototype.getHeaderValue=function(a){if(a==null){return null}var d=null;try{var c=a.indexOf(":");d=a.substring(c+1)}catch(b){console.error("Lexer:getHeaderValue(): catched exception:"+b);return null}return d};Lexer.prototype.selectLexer=function(c){var b=null;for(var a=0;a<this.lexerTables.length;a++){if(this.lexerTables[a][0]==c){b=a}}if(b!=null){this.currentLexer=this.lexerTables[b][1]}this.currentLexerName=c;if(this.currentLexer.length==0){this.addLexer(c);if(c=="method_keywordLexer"){this.addKeyword(TokenNames.prototype.REGISTER,TokenTypes.prototype.REGISTER);this.addKeyword(TokenNames.prototype.ACK,TokenTypes.prototype.ACK);this.addKeyword(TokenNames.prototype.OPTIONS,TokenTypes.prototype.OPTIONS);this.addKeyword(TokenNames.prototype.BYE,TokenTypes.prototype.BYE);this.addKeyword(TokenNames.prototype.INVITE,TokenTypes.prototype.INVITE);this.addKeyword(TokenNames.prototype.SIP.toUpperCase(),TokenTypes.prototype.SIP);this.addKeyword(TokenNames.prototype.SIPS.toUpperCase(),TokenTypes.prototype.SIPS);this.addKeyword(TokenNames.prototype.SUBSCRIBE,TokenTypes.prototype.SUBSCRIBE);this.addKeyword(TokenNames.prototype.NOTIFY,TokenTypes.prototype.NOTIFY);this.addKeyword(TokenNames.prototype.MESSAGE,TokenTypes.prototype.MESSAGE);this.addKeyword(TokenNames.prototype.PUBLISH,TokenTypes.prototype.PUBLISH)}else{if(c=="command_keywordLexer"){this.addKeyword(this.ErrorInfoHeader.toUpperCase(),TokenTypes.prototype.ERROR_INFO);this.addKeyword(this.AllowEventsHeader.toUpperCase(),TokenTypes.prototype.ALLOW_EVENTS);this.addKeyword(this.AuthenticationInfoHeader.toUpperCase(),TokenTypes.prototype.AUTHENTICATION_INFO);this.addKeyword(this.EventHeader.toUpperCase(),TokenTypes.prototype.EVENT);this.addKeyword(this.MinExpiresHeader.toUpperCase(),TokenTypes.prototype.MIN_EXPIRES);this.addKeyword(this.RSeqHeader.toUpperCase(),TokenTypes.prototype.RSEQ);this.addKeyword(this.RAckHeader.toUpperCase(),TokenTypes.prototype.RACK);this.addKeyword(this.ReasonHeader.toUpperCase(),TokenTypes.prototype.REASON);this.addKeyword(this.ReplyToHeader.toUpperCase(),TokenTypes.prototype.REPLY_TO);this.addKeyword(this.SubscriptionStateHeader.toUpperCase(),TokenTypes.prototype.SUBSCRIPTION_STATE);this.addKeyword(this.TimeStampHeader.toUpperCase(),TokenTypes.prototype.TIMESTAMP);this.addKeyword(this.InReplyToHeader.toUpperCase(),TokenTypes.prototype.IN_REPLY_TO);this.addKeyword(this.MimeVersionHeader.toUpperCase(),TokenTypes.prototype.MIME_VERSION);this.addKeyword(this.AlertInfoHeader.toUpperCase(),TokenTypes.prototype.ALERT_INFO);this.addKeyword(this.FromHeader.toUpperCase(),TokenTypes.prototype.FROM);this.addKeyword(this.ToHeader.toUpperCase(),TokenTypes.prototype.TO);this.addKeyword(this.ReferToHeader.toUpperCase(),TokenTypes.prototype.REFER_TO);this.addKeyword(this.ViaHeader.toUpperCase(),TokenTypes.prototype.VIA);this.addKeyword(this.UserAgentHeader.toUpperCase(),TokenTypes.prototype.USER_AGENT);this.addKeyword(this.ServerHeader.toUpperCase(),TokenTypes.prototype.SERVER);this.addKeyword(this.AcceptEncodingHeader.toUpperCase(),TokenTypes.prototype.ACCEPT_ENCODING);this.addKeyword(this.AcceptHeader.toUpperCase(),TokenTypes.prototype.ACCEPT);this.addKeyword(this.AllowHeader.toUpperCase(),TokenTypes.prototype.ALLOW);this.addKeyword(this.RouteHeader.toUpperCase(),TokenTypes.prototype.ROUTE);this.addKeyword(this.AuthorizationHeader.toUpperCase(),TokenTypes.prototype.AUTHORIZATION);this.addKeyword(this.ProxyAuthorizationHeader.toUpperCase(),TokenTypes.prototype.PROXY_AUTHORIZATION);this.addKeyword(this.RetryAfterHeader.toUpperCase(),TokenTypes.prototype.RETRY_AFTER);this.addKeyword(this.ProxyRequireHeader.toUpperCase(),TokenTypes.prototype.PROXY_REQUIRE);this.addKeyword(this.ContentLanguageHeader.toUpperCase(),TokenTypes.prototype.CONTENT_LANGUAGE);this.addKeyword(this.UnsupportedHeader.toUpperCase(),TokenTypes.prototype.UNSUPPORTED);this.addKeyword(this.SupportedHeader.toUpperCase(),TokenTypes.prototype.SUPPORTED);this.addKeyword(this.WarningHeader.toUpperCase(),TokenTypes.prototype.WARNING);this.addKeyword(this.MaxForwardsHeader.toUpperCase(),TokenTypes.prototype.MAX_FORWARDS);this.addKeyword(this.DateHeader.toUpperCase(),TokenTypes.prototype.DATE);this.addKeyword(this.PriorityHeader.toUpperCase(),TokenTypes.prototype.PRIORITY);this.addKeyword(this.ProxyAuthenticateHeader.toUpperCase(),TokenTypes.prototype.PROXY_AUTHENTICATE);this.addKeyword(this.ContentEncodingHeader.toUpperCase(),TokenTypes.prototype.CONTENT_ENCODING);this.addKeyword(this.ContentLengthHeader.toUpperCase(),TokenTypes.prototype.CONTENT_LENGTH);this.addKeyword(this.SubjectHeader.toUpperCase(),TokenTypes.prototype.SUBJECT);this.addKeyword(this.ContentTypeHeader.toUpperCase(),TokenTypes.prototype.CONTENT_TYPE);this.addKeyword(this.ContactHeader.toUpperCase(),TokenTypes.prototype.CONTACT);this.addKeyword(this.CallIdHeader.toUpperCase(),TokenTypes.prototype.CALL_ID);this.addKeyword(this.RequireHeader.toUpperCase(),TokenTypes.prototype.REQUIRE);this.addKeyword(this.ExpiresHeader.toUpperCase(),TokenTypes.prototype.EXPIRES);this.addKeyword(this.RecordRouteHeader.toUpperCase(),TokenTypes.prototype.RECORD_ROUTE);this.addKeyword(this.OrganizationHeader.toUpperCase(),TokenTypes.prototype.ORGANIZATION);this.addKeyword(this.CSeqHeader.toUpperCase(),TokenTypes.prototype.CSEQ);this.addKeyword(this.AcceptLanguageHeader.toUpperCase(),TokenTypes.prototype.ACCEPT_LANGUAGE);this.addKeyword(this.WWWAuthenticateHeader.toUpperCase(),TokenTypes.prototype.WWW_AUTHENTICATE);this.addKeyword(this.CallInfoHeader.toUpperCase(),TokenTypes.prototype.CALL_INFO);this.addKeyword(this.ContentDispositionHeader.toUpperCase(),TokenTypes.prototype.CONTENT_DISPOSITION);this.addKeyword(TokenNames.prototype.K.toUpperCase(),TokenTypes.prototype.SUPPORTED);this.addKeyword(TokenNames.prototype.C.toUpperCase(),TokenTypes.prototype.CONTENT_TYPE);this.addKeyword(TokenNames.prototype.E.toUpperCase(),TokenTypes.prototype.CONTENT_ENCODING);this.addKeyword(TokenNames.prototype.F.toUpperCase(),TokenTypes.prototype.FROM);this.addKeyword(TokenNames.prototype.I.toUpperCase(),TokenTypes.prototype.CALL_ID);this.addKeyword(TokenNames.prototype.M.toUpperCase(),TokenTypes.prototype.CONTACT);this.addKeyword(TokenNames.prototype.L.toUpperCase(),TokenTypes.prototype.CONTENT_LENGTH);this.addKeyword(TokenNames.prototype.S.toUpperCase(),TokenTypes.prototype.SUBJECT);this.addKeyword(TokenNames.prototype.T.toUpperCase(),TokenTypes.prototype.TO);this.addKeyword(TokenNames.prototype.U.toUpperCase(),TokenTypes.prototype.ALLOW_EVENTS);this.addKeyword(TokenNames.prototype.V.toUpperCase(),TokenTypes.prototype.VIA);this.addKeyword(TokenNames.prototype.R.toUpperCase(),TokenTypes.prototype.REFER_TO);this.addKeyword(TokenNames.prototype.O.toUpperCase(),TokenTypes.prototype.EVENT);this.addKeyword(TokenNames.prototype.X.toUpperCase(),TokenTypes.prototype.SESSIONEXPIRES_TO);this.addKeyword(this.SIPETagHeader.toUpperCase(),TokenTypes.prototype.SIP_ETAG);this.addKeyword(this.SIPIfMatchHeader.toUpperCase(),TokenTypes.prototype.SIP_IF_MATCH);this.addKeyword(this.SessionExpiresHeader.toUpperCase(),TokenTypes.prototype.SESSIONEXPIRES_TO);this.addKeyword(this.MinSEHeader.toUpperCase(),TokenTypes.prototype.MINSE_TO);this.addKeyword(this.ReferredByHeader.toUpperCase(),TokenTypes.prototype.REFERREDBY_TO);this.addKeyword(TokenNames.prototype.B.toUpperCase(),TokenTypes.prototype.REFERREDBY_TO);this.addKeyword(this.ReplacesHeader.toUpperCase(),TokenTypes.prototype.REPLACES_TO);this.addKeyword(this.JoinHeader.toUpperCase(),TokenTypes.prototype.JOIN_TO);this.addKeyword(this.PathHeader.toUpperCase(),TokenTypes.prototype.PATH);this.addKeyword(this.ServiceRouteHeader.toUpperCase(),TokenTypes.prototype.SERVICE_ROUTE);this.addKeyword(this.PAssertedIdentityHeader.toUpperCase(),TokenTypes.prototype.P_ASSERTED_IDENTITY);this.addKeyword(this.PPreferredIdentityHeader.toUpperCase(),TokenTypes.prototype.P_PREFERRED_IDENTITY);this.addKeyword(this.PrivacyHeader.toUpperCase(),TokenTypes.prototype.PRIVACY);this.addKeyword(this.PCalledPartyIDHeader.toUpperCase(),TokenTypes.prototype.P_CALLED_PARTY_ID);this.addKeyword(this.PAssociatedURIHeader.toUpperCase(),TokenTypes.prototype.P_ASSOCIATED_URI);this.addKeyword(this.PVisitedNetworkIDHeader.toUpperCase(),TokenTypes.prototype.P_VISITED_NETWORK_ID);this.addKeyword(this.PChargingFunctionAddressesHeader.toUpperCase(),TokenTypes.prototype.P_CHARGING_FUNCTION_ADDRESSES);this.addKeyword(this.PChargingVectorHeader.toUpperCase(),TokenTypes.prototype.P_VECTOR_CHARGING);this.addKeyword(this.PAccessNetworkInfoHeader.toUpperCase(),TokenTypes.prototype.P_ACCESS_NETWORK_INFO);this.addKeyword(this.PMediaAuthorizationHeader.toUpperCase(),TokenTypes.prototype.P_MEDIA_AUTHORIZATION);this.addKeyword(this.SecurityServerHeader.toUpperCase(),TokenTypes.prototype.SECURITY_SERVER);this.addKeyword(this.SecurityVerifyHeader.toUpperCase(),TokenTypes.prototype.SECURITY_VERIFY);this.addKeyword(this.SecurityClientHeader.toUpperCase(),TokenTypes.prototype.SECURITY_CLIENT);this.addKeyword(this.PUserDatabaseHeader.toUpperCase(),TokenTypes.prototype.P_USER_DATABASE);this.addKeyword(this.PProfileKeyHeader.toUpperCase(),TokenTypes.prototype.P_PROFILE_KEY);this.addKeyword(this.PServedUserHeader.toUpperCase(),TokenTypes.prototype.P_SERVED_USER);this.addKeyword(this.PPreferredServiceHeader.toUpperCase(),TokenTypes.prototype.P_PREFERRED_SERVICE);this.addKeyword(this.PAssertedServiceHeader.toUpperCase(),TokenTypes.prototype.P_ASSERTED_SERVICE);this.addKeyword(this.ReferencesHeader.toUpperCase(),TokenTypes.prototype.REFERENCES);this.addKeyword(this.AcceptContact.toUpperCase(),TokenTypes.prototype.ACCEPT_CONTACT)}else{if(c=="status_lineLexer"){this.addKeyword(TokenNames.prototype.SIP.toUpperCase(),TokenTypes.prototype.SIP)}else{if(c=="request_lineLexer"){this.addKeyword(TokenNames.prototype.SIP.toUpperCase(),TokenTypes.prototype.SIP)}else{if(c=="sip_urlLexer"){this.addKeyword(TokenNames.prototype.TEL.toUpperCase(),TokenTypes.prototype.TEL);this.addKeyword(TokenNames.prototype.SIP.toUpperCase(),TokenTypes.prototype.SIP);this.addKeyword(TokenNames.prototype.SIPS.toUpperCase(),TokenTypes.prototype.SIPS)}}}}}}};function HeaderParser(){this.classname="HeaderParser";if(typeof arguments[0]=="string"){var b=arguments[0];this.lexer=new Lexer("command_keywordLexer",b)}else{if(typeof arguments[0]=="object"){var a=arguments[0];this.lexer=a;this.lexer.selectLexer("command_keywordLexer")}}}HeaderParser.prototype=new Parser();HeaderParser.prototype.constructor=HeaderParser;HeaderParser.prototype.wkday=function(){var a=this.lexer.ttoken();var b=a.toLowerCase();if(TokenNames.prototype.MON==b.toLowerCase()){return 2}else{if(TokenNames.prototype.TUE.toLowerCase()==b.toLowerCase()){return 3}else{if(TokenNames.prototype.WED.toLowerCase()==b.toLowerCase()){return 4}else{if(TokenNames.prototype.THU.toLowerCase()==b.toLowerCase()){return 5}else{if(TokenNames.prototype.FRI.toLowerCase()==b.toLowerCase()){return 6}else{if(TokenNames.prototype.SAT.toLowerCase()==b.toLowerCase()){return 7}else{if(TokenNames.prototype.SUN.toLowerCase()==b.toLowerCase()){return 1}else{console.error("HeaderParser:wkday(): bad wkday");throw"HeaderParser:wkday(): bad wkday"}}}}}}}};HeaderParser.prototype.date=function(){try{var a=new Date();var e=this.lexer.number();var b=e+0;if(b<=0||b>31){console.error("HeaderParser:date(): bad day");throw"HeaderParser:date():  bad day"}a.set(5,b);this.lexer.match(" ");var g=this.lexer.ttoken().toLowerCase();if(g.equals("jan")){a.setMonth(0)}else{if(g=="feb"){a.setMonth(1)}else{if(g=="mar"){a.setMonth(2)}else{if(g=="apr"){a.setMonth(3)}else{if(g=="may"){a.setMonth(4)}else{if(g=="jun"){a.setMonth(5)}else{if(g=="jul"){a.setMonth(6)}else{if(g=="aug"){a.setMonth(7)}else{if(g=="sep"){a.setMonth(8)}else{if(g=="oct"){a.setMonth(9)}else{if(g=="nov"){a.setMonth(10)}else{if(g=="dec"){a.setMonth(11)}}}}}}}}}}}}this.lexer.match(" ");var c=this.lexer.number();var f=c;a.setYear(f);return a}catch(d){console.error("HeaderParser:date(): bad date field");throw"HeaderParser:date(): bad date field"}};HeaderParser.prototype.time=function(f){try{var e=this.lexer.number();var a=e;f.setHours(a);this.lexer.match(":");e=this.lexer.number();var c=e;f.setMinutes(c);this.lexer.match(":");e=this.lexer.number();var d=e;f.setSeconds(d)}catch(b){console.error("HeaderParser:time(): error processing time ");throw"HeaderParser:time():error processing time "}};HeaderParser.prototype.parse=function(){var c=this.lexer.getNextToken(":");this.lexer.consume(1);var a=this.lexer.getLine().replace(/^(\s)+|(\s)+$/g,"");var b=new ExtensionHeaderImpl(c);b.setValue(a);return b};HeaderParser.prototype.headerName=function(a){this.lexer.match(a);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT()};function ParametersParser(){this.classname="ParametersParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}ParametersParser.prototype=new HeaderParser();ParametersParser.prototype.constructor=ParametersParser;ParametersParser.prototype.parse=function(b){this.lexer.SPorHT();while(this.lexer.lookAhead(0)==";"){this.lexer.consume(1);this.lexer.SPorHT();var a=this.nameValue();b.setParameter_nv(a);this.lexer.SPorHT()}};ParametersParser.prototype.parseNameValueList=function(b){b.removeParameters();while(true){this.lexer.SPorHT();var a=nameValue();b.setParameter(a.getName(),a.getValueAsObject());this.lexer.SPorHT();if(this.lexer.lookAhead(0)!=";"){break}else{this.lexer.consume(1)}}};function TokenTypes(){this.classname="TokenTypes"}TokenTypes.prototype.constructor=Parser;TokenTypes.prototype.START=LexerCore.prototype.START;TokenTypes.prototype.END=LexerCore.prototype.END;TokenTypes.prototype.SIP=LexerCore.prototype.START+3;TokenTypes.prototype.REGISTER=LexerCore.prototype.START+4;TokenTypes.prototype.INVITE=LexerCore.prototype.START+5;TokenTypes.prototype.ACK=LexerCore.prototype.START+6;TokenTypes.prototype.BYE=LexerCore.prototype.START+7;TokenTypes.prototype.OPTIONS=LexerCore.prototype.START+8;TokenTypes.prototype.CANCEL=LexerCore.prototype.START+9;TokenTypes.prototype.ERROR_INFO=LexerCore.prototype.START+10;TokenTypes.prototype.IN_REPLY_TO=LexerCore.prototype.START+11;TokenTypes.prototype.MIME_VERSION=LexerCore.prototype.START+12;TokenTypes.prototype.ALERT_INFO=LexerCore.prototype.START+13;TokenTypes.prototype.FROM=LexerCore.prototype.START+14;TokenTypes.prototype.TO=LexerCore.prototype.START+15;TokenTypes.prototype.VIA=LexerCore.prototype.START+16;TokenTypes.prototype.USER_AGENT=LexerCore.prototype.START+17;TokenTypes.prototype.SERVER=LexerCore.prototype.START+18;TokenTypes.prototype.ACCEPT_ENCODING=LexerCore.prototype.START+19;TokenTypes.prototype.ACCEPT=LexerCore.prototype.START+20;TokenTypes.prototype.ALLOW=LexerCore.prototype.START+21;TokenTypes.prototype.ROUTE=LexerCore.prototype.START+22;TokenTypes.prototype.AUTHORIZATION=LexerCore.prototype.START+23;TokenTypes.prototype.PROXY_AUTHORIZATION=LexerCore.prototype.START+24;TokenTypes.prototype.RETRY_AFTER=LexerCore.prototype.START+25;TokenTypes.prototype.PROXY_REQUIRE=LexerCore.prototype.START+26;TokenTypes.prototype.CONTENT_LANGUAGE=LexerCore.prototype.START+27;TokenTypes.prototype.UNSUPPORTED=LexerCore.prototype.START+28;TokenTypes.prototype.SUPPORTED=LexerCore.prototype.START+20;TokenTypes.prototype.WARNING=LexerCore.prototype.START+30;TokenTypes.prototype.MAX_FORWARDS=LexerCore.prototype.START+31;TokenTypes.prototype.DATE=LexerCore.prototype.START+32;TokenTypes.prototype.PRIORITY=LexerCore.prototype.START+33;TokenTypes.prototype.PROXY_AUTHENTICATE=LexerCore.prototype.START+34;TokenTypes.prototype.CONTENT_ENCODING=LexerCore.prototype.START+35;TokenTypes.prototype.CONTENT_LENGTH=LexerCore.prototype.START+36;TokenTypes.prototype.SUBJECT=LexerCore.prototype.START+37;TokenTypes.prototype.CONTENT_TYPE=LexerCore.prototype.START+38;TokenTypes.prototype.CONTACT=LexerCore.prototype.START+39;TokenTypes.prototype.CALL_ID=LexerCore.prototype.START+40;TokenTypes.prototype.REQUIRE=LexerCore.prototype.START+41;TokenTypes.prototype.EXPIRES=LexerCore.prototype.START+42;TokenTypes.prototype.ENCRYPTION=LexerCore.prototype.START+43;TokenTypes.prototype.RECORD_ROUTE=LexerCore.prototype.START+44;TokenTypes.prototype.ORGANIZATION=LexerCore.prototype.START+45;TokenTypes.prototype.CSEQ=LexerCore.prototype.START+46;TokenTypes.prototype.ACCEPT_LANGUAGE=LexerCore.prototype.START+47;TokenTypes.prototype.WWW_AUTHENTICATE=LexerCore.prototype.START+48;TokenTypes.prototype.RESPONSE_KEY=LexerCore.prototype.START+49;TokenTypes.prototype.HIDE=LexerCore.prototype.START+50;TokenTypes.prototype.CALL_INFO=LexerCore.prototype.START+51;TokenTypes.prototype.CONTENT_DISPOSITION=LexerCore.prototype.START+52;TokenTypes.prototype.SUBSCRIBE=LexerCore.prototype.START+53;TokenTypes.prototype.NOTIFY=LexerCore.prototype.START+54;TokenTypes.prototype.TIMESTAMP=LexerCore.prototype.START+55;TokenTypes.prototype.SUBSCRIPTION_STATE=LexerCore.prototype.START+56;TokenTypes.prototype.TEL=LexerCore.prototype.START+57;TokenTypes.prototype.REPLY_TO=LexerCore.prototype.START+58;TokenTypes.prototype.REASON=LexerCore.prototype.START+59;TokenTypes.prototype.RSEQ=LexerCore.prototype.START+60;TokenTypes.prototype.RACK=LexerCore.prototype.START+61;TokenTypes.prototype.MIN_EXPIRES=LexerCore.prototype.START+62;TokenTypes.prototype.EVENT=LexerCore.prototype.START+63;TokenTypes.prototype.AUTHENTICATION_INFO=LexerCore.prototype.START+64;TokenTypes.prototype.ALLOW_EVENTS=LexerCore.prototype.START+65;TokenTypes.prototype.REFER_TO=LexerCore.prototype.START+66;TokenTypes.prototype.PUBLISH=LexerCore.prototype.START+67;TokenTypes.prototype.SIP_ETAG=LexerCore.prototype.START+68;TokenTypes.prototype.SIP_IF_MATCH=LexerCore.prototype.START+69;TokenTypes.prototype.MESSAGE=LexerCore.prototype.START+70;TokenTypes.prototype.PATH=LexerCore.prototype.START+71;TokenTypes.prototype.SERVICE_ROUTE=LexerCore.prototype.START+72;TokenTypes.prototype.P_ASSERTED_IDENTITY=LexerCore.prototype.START+73;TokenTypes.prototype.P_PREFERRED_IDENTITY=LexerCore.prototype.START+74;TokenTypes.prototype.P_VISITED_NETWORK_ID=LexerCore.prototype.START+75;TokenTypes.prototype.P_CHARGING_FUNCTION_ADDRESSES=LexerCore.prototype.START+76;TokenTypes.prototype.P_VECTOR_CHARGING=LexerCore.prototype.START+77;TokenTypes.prototype.PRIVACY=LexerCore.prototype.START+78;TokenTypes.prototype.P_ACCESS_NETWORK_INFO=LexerCore.prototype.START+79;TokenTypes.prototype.P_CALLED_PARTY_ID=LexerCore.prototype.START+80;TokenTypes.prototype.P_ASSOCIATED_URI=LexerCore.prototype.START+81;TokenTypes.prototype.P_MEDIA_AUTHORIZATION=LexerCore.prototype.START+82;TokenTypes.prototype.P_MEDIA_AUTHORIZATION_TOKEN=LexerCore.prototype.START+83;TokenTypes.prototype.REFERREDBY_TO=LexerCore.prototype.START+84;TokenTypes.prototype.SESSIONEXPIRES_TO=LexerCore.prototype.START+85;TokenTypes.prototype.MINSE_TO=LexerCore.prototype.START+86;TokenTypes.prototype.REPLACES_TO=LexerCore.prototype.START+87;TokenTypes.prototype.SIPS=LexerCore.prototype.START+88;TokenTypes.prototype.SECURITY_SERVER=LexerCore.prototype.START+89;TokenTypes.prototype.SECURITY_CLIENT=LexerCore.prototype.START+90;TokenTypes.prototype.SECURITY_VERIFY=LexerCore.prototype.START+91;TokenTypes.prototype.JOIN_TO=LexerCore.prototype.START+92;TokenTypes.prototype.P_USER_DATABASE=LexerCore.prototype.START+93;TokenTypes.prototype.P_PROFILE_KEY=LexerCore.prototype.START+94;TokenTypes.prototype.P_SERVED_USER=LexerCore.prototype.START+95;TokenTypes.prototype.P_PREFERRED_SERVICE=LexerCore.prototype.START+96;TokenTypes.prototype.P_ASSERTED_SERVICE=LexerCore.prototype.START+97;TokenTypes.prototype.REFERENCES=LexerCore.prototype.START+98;TokenTypes.prototype.ACCEPT_CONTACT=LexerCore.prototype.START+99;TokenTypes.prototype.ALPHA=LexerCore.prototype.ALPHA;TokenTypes.prototype.DIGIT=LexerCore.prototype.DIGIT;TokenTypes.prototype.ID=LexerCore.prototype.ID;TokenTypes.prototype.WHITESPACE=LexerCore.prototype.WHITESPACE;TokenTypes.prototype.BACKSLASH=LexerCore.prototype.BACKSLASH;TokenTypes.prototype.QUOTE=LexerCore.prototype.QUOTE;TokenTypes.prototype.AT=LexerCore.prototype.AT;TokenTypes.prototype.SP=LexerCore.prototype.SP;TokenTypes.prototype.HT=LexerCore.prototype.HT;TokenTypes.prototype.COLON=LexerCore.prototype.COLON;TokenTypes.prototype.STAR=LexerCore.prototype.STAR;TokenTypes.prototype.DOLLAR=LexerCore.prototype.DOLLAR;TokenTypes.prototype.PLUS=LexerCore.prototype.PLUS;TokenTypes.prototype.POUND=LexerCore.prototype.POUND;TokenTypes.prototype.MINUS=LexerCore.prototype.MINUS;TokenTypes.prototype.DOUBLEQUOTE=LexerCore.prototype.DOUBLEQUOTE;TokenTypes.prototype.TILDE=LexerCore.prototype.TILDE;TokenTypes.prototype.BACK_QUOTE=LexerCore.prototype.BACK_QUOTE;TokenTypes.prototype.NULL=LexerCore.prototype.NULL;TokenTypes.prototype.EQUALS="=".charCodeAt(0);TokenTypes.prototype.SEMICOLON=";".charCodeAt(0);TokenTypes.prototype.SLASH="/".charCodeAt(0);TokenTypes.prototype.L_SQUARE_BRACKET="[".charCodeAt(0);TokenTypes.prototype.R_SQUARE_BRACKET="]".charCodeAt(0);TokenTypes.prototype.R_CURLY="}".charCodeAt(0);TokenTypes.prototype.L_CURLY="{".charCodeAt(0);TokenTypes.prototype.HAT="^".charCodeAt(0);TokenTypes.prototype.BAR="|".charCodeAt(0);TokenTypes.prototype.DOT=".".charCodeAt(0);TokenTypes.prototype.EXCLAMATION="!".charCodeAt(0);TokenTypes.prototype.LPAREN="(".charCodeAt(0);TokenTypes.prototype.RPAREN=")".charCodeAt(0);TokenTypes.prototype.GREATER_THAN=">".charCodeAt(0);TokenTypes.prototype.LESS_THAN="<".charCodeAt(0);TokenTypes.prototype.PERCENT="%".charCodeAt(0);TokenTypes.prototype.QUESTION="?".charCodeAt(0);TokenTypes.prototype.AND="&".charCodeAt(0);TokenTypes.prototype.UNDERSCORE="_".charCodeAt(0);function TokenNames(){this.classname="TokenNames"}TokenNames.prototype.INVITE="INVITE";TokenNames.prototype.ACK="ACK";TokenNames.prototype.BYE="BYE";TokenNames.prototype.SUBSCRIBE="SUBSCRIBE";TokenNames.prototype.NOTIFY="NOTIFY";TokenNames.prototype.OPTIONS="OPTIONS";TokenNames.prototype.REGISTER="REGISTER";TokenNames.prototype.MESSAGE="MESSAGE";TokenNames.prototype.PUBLISH="PUBLISH";TokenNames.prototype.SIP="sip";TokenNames.prototype.SIPS="sips";TokenNames.prototype.TEL="tel";TokenNames.prototype.GMT="GMT";TokenNames.prototype.MON="Mon";TokenNames.prototype.TUE="Tue";TokenNames.prototype.WED="Wed";TokenNames.prototype.THU="Thu";TokenNames.prototype.FRI="Fri";TokenNames.prototype.SAT="Sat";TokenNames.prototype.SUN="Sun";TokenNames.prototype.JAN="Jan";TokenNames.prototype.FEB="Feb";TokenNames.prototype.MAR="Mar";TokenNames.prototype.APR="Apr";TokenNames.prototype.MAY="May";TokenNames.prototype.JUN="Jun";TokenNames.prototype.JUL="Jul";TokenNames.prototype.AUG="Aug";TokenNames.prototype.SEP="Sep";TokenNames.prototype.OCT="Oct";TokenNames.prototype.NOV="Nov";TokenNames.prototype.DEC="Dec";TokenNames.prototype.K="K";TokenNames.prototype.C="C";TokenNames.prototype.E="E";TokenNames.prototype.F="F";TokenNames.prototype.I="I";TokenNames.prototype.M="M";TokenNames.prototype.L="L";TokenNames.prototype.S="S";TokenNames.prototype.T="T";TokenNames.prototype.U="U";TokenNames.prototype.V="V";TokenNames.prototype.R="R";TokenNames.prototype.O="O";TokenNames.prototype.X="X";TokenNames.prototype.B="B";function StringMsgParser(a){this.classname="StringMsgParser";this.readBody=true;this.parseExceptionListener=null;this.rawStringMessage=null;this.strict=true;this.computeContentLengthFromMessage=false;this.viaCount=0;if(a!=null){this.parseExceptionListener=a}}StringMsgParser.prototype.SIP_VERSION_STRING="SIP/2.0";StringMsgParser.prototype.setParseExceptionListener=function(a){this.parseExceptionListener=a};StringMsgParser.prototype.parseSIPMessage=function(){if(typeof arguments[0]=="string"){var b=arguments[0];return this.parseSIPMessagestring(b)}else{if(typeof arguments[0]=="object"){var a=arguments[0];return this.parseSIPMessagebyte(a)}}};StringMsgParser.prototype.parseSIPMessagestring=function(a){if(a==null||a.length==0){return null}this.rawStringMessage=a;var b=0;try{while(a.charCodeAt(b)<32){b++}}catch(g){console.error("StringMsgParser:parseSIPMessagestring(): catched exception:"+g);return null}var l=null;var j=null;var f=true;var n=null;do{var e=b;try{var h=a.charAt(b);while(h!="\r"&&h!="\n"){h=a.charAt(++b)}}catch(g){console.error("StringMsgParser:parseSIPMessagestring(): catched exception:"+g);break}l=a.substring(e,b);l=this.trimEndOfLine(l);if(l.length==0){if(j!=null){this.processHeader(j,n)}}else{if(f){n=this.processFirstLine(l)}else{var k=l.charAt(0);if(k=="\t"||k==" "){if(j==null){console.error("StringMsgParser:parseSIPMessagestring(): bad header continuation.");throw"StringMsgParser:parseSIPMessagestring(): bad header continuation."}j=j+l.substring(1)}else{if(j!=null){this.processHeader(j,n)}j=l}}}if(a.charAt(b)=="\r"&&a.length>b+1&&a.charAt(b+1)=="\n"){b++}b++;f=false}while(l.length>0);n.setSize(b);if(this.readBody&&n.getContentLength()!=null){if(n.getContentLength().getContentLength()!=0){var d=a.substring(b);n.setMessageContent(d,this.strict,this.computeContentLengthFromMessage,n.getContentLength().getContentLength())}else{if(!this.computeContentLengthFromMessage&&n.getContentLength().getContentLength()==0){if(this.strict){var m=a.substring(a.length-4,4);if(!"\r\n\r\n"==m){console.error("StringMsgParser:parse(): extraneous characters at the end of the message",b);throw"StringMsgParser:parse(): extraneous characters at the end of the message"}}}}}return n};StringMsgParser.prototype.parseSIPMessagebyte=function(p){if(p==null||p.length==0){return null}var d=0;try{while(p[d].charCodeAt(0)<32){d++}}catch(h){console.error("StringMsgParser:parseSIPMessagebyte(): catched exception:"+h);return null}var n="";var k=null;var g=true;var q=null;do{var f=d;try{while(p[d]!="\r"&&p[d]!="\n"){d++}}catch(h){console.error("StringMsgParser:parseSIPMessagebyte(): catched exception:"+h);break}var a=d-f;try{for(var j=0;j<a;j++){n=n+p[j+f]}}catch(h){console.error("StringMsgParser:parseSIPMessagebyte(): bad message encoding!");throw"StringMsgParser:parseSIPMessagebyte():bad message encoding!"}n=this.trimEndOfLine(n);if(n.length()==0){if(k!=null&&q!=null){this.processHeader(k,q)}}else{if(g){q=this.processFirstLine(n)}else{var m=n.charAt(0);if(m=="\t"||m==" "){if(k==null){console.error("StringMsgParser:parseSIPMessagebyte(): bad header continuation");throw"StringMsgParser:parseSIPMessagebyte(): bad header continuation"}k=k+n.substring(1)}else{if(k!=null&&q!=null){this.processHeader(k,q)}k=n}}}if(p[d]=="\r"&&p.length>d+1&&p[d+1]=="\n"){d++}d++;g=false}while(n.length>0);if(q==null){console.error("StringMsgParser:parseSIPMessagebyte(): bad message");throw"StringMsgParser:parseSIPMessagebyte(): bad message"}q.setSize(d);if(this.readBody&&q.getContentLength()!=null&&q.getContentLength().getContentLength()!=0){var b=p.length-d;var e=new Array();var c=d;for(j=0;j<b;j++){e[j]=p[c];c=c+1}q.setMessageContent(e,this.computeContentLengthFromMessage,q.getContentLength().getContentLength())}return q};StringMsgParser.prototype.trimEndOfLine=function(a){if(a==null){return a}var b=a.length-1;while(b>=0&&a.charCodeAt(b)<=32){b--}if(b==a.length-1){return a}if(b==-1){return""}return a.substring(0,b+1)};StringMsgParser.prototype.processFirstLine=function(f){var j=null;var g=this.SIP_VERSION_STRING.length;var a=0;for(var c=0;c<g;c++){if(f.charAt(c)==this.SIP_VERSION_STRING.charAt(c)){a=a+1}}if(a!=g){j=new SIPRequest();try{var h=new RequestLineParser(f+"\n").parse();j.setRequestLine(h)}catch(e){console.error("StringMsgParser:processFirstLine(): catched exception:"+e);if(this.parseExceptionListener!=null){var d=new RequestLine();this.parseExceptionListener.handleException(e,j,d.classname,f,this.rawStringMessage)}else{throw e}}}else{j=new SIPResponse();try{var b=new StatusLineParser(f+"\n").parse();j.setStatusLine(b)}catch(e){console.error("StringMsgParser:processFirstLine(): catched exception:"+e);if(this.parseExceptionListener!=null){b=new StatusLine();this.parseExceptionListener.handleException(e,j,b.classname,f,this.rawStringMessage)}else{throw e}}}return j};StringMsgParser.prototype.processHeader=function(d,j){if(d==null||d.length==0){return}var g=null;try{var e=new ParserFactory();g=e.createParser(d+"\n")}catch(i){console.error("StringMsgParser:processHeader(): catched exception:"+i);this.parseExceptionListener.handleException(i,j,null,d,this.rawStringMessage);return}try{var b=g.parse();if(b instanceof ViaList){this.viaCount=this.viaCount+1;if(this.viaCount==1){j.attachHeader(b,false)}else{j.addViaHeaderList(b)}}else{j.attachHeader(b,false)}}catch(i){console.error("StringMsgParser:processHeader(): catched exception:"+i);if(this.parseExceptionListener!=null){var c=new Lexer();var h=c.getHeaderName(d);var f=new NameMap();var a=f.getClassFromName(h);if(a==null){a=new ExtensionHeaderImpl().classname}this.parseExceptionListener.handleException(i,j,a,d,this.rawStringMessage)}}};StringMsgParser.prototype.parseAddress=function(a){var b=new AddressParser(a);return b.address(true)};StringMsgParser.prototype.parseHost=function(a){var b=new Lexer("charLexer",a);return new HostNameParser(b).host()};StringMsgParser.prototype.parseTelephoneNumber=function(a){return new URLParser(a).parseTelephoneNumber(true)};StringMsgParser.prototype.parseSIPUrl=function(a){try{return new URLParser(a).sipURL(true)}catch(b){console.error("StringMsgParser:parseSIPUrl(): "+a+" is not a SIP URL ");throw"StringMsgParser:parseSIPUrl(): "+a+" is not a SIP URL "}};StringMsgParser.prototype.parseUrl=function(a){return new URLParser(a).parse()};StringMsgParser.prototype.parseSIPHeader=function(g){var a=0;var b=g.length-1;try{while(g.charCodeAt(a)<=32){a++}while(g.charCodeAt(b)<=32){b--}}catch(j){console.error("StringMsgParser:parseSIPHeader(): empty header");throw"StringMsgParser:parseSIPHeader(): eEmpty header"}var d="";var e=a;var h=a;var l=false;while(e<=b){var k=g.charAt(e);if(k=="\r"||k=="\n"){if(!l){d=d+g.substring(h,e);l=true}}else{if(l){l=false;if(k==" "||k=="\t"){d=d+" ";h=e+1}else{h=e}}}e++}d=d+g.substring(h,e);d=d+"\n";var f=new ParserFactory();var m=f.createParser(d.toString());if(m==null){console.error("StringMsgParser:parseSIPHeader(): could not create parser");throw"StringMsgParser:parseSIPHeader(): could not create parser"}return m.parse()};StringMsgParser.prototype.parseSIPRequestLine=function(a){a+="\n";return new RequestLineParser(a).parse()};StringMsgParser.prototype.parseSIPStatusLine=function(a){a+="\n";return new StatusLineParser(a).parse()};StringMsgParser.prototype.setComputeContentLengthFromMessage=function(a){this.computeContentLengthFromMessage=a};StringMsgParser.prototype.setStrict=function(a){this.strict=a};function AddressParametersParser(){this.classname="AddressParametersParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}AddressParametersParser.prototype=new ParametersParser();AddressParametersParser.prototype.constructor=AddressParametersParser;AddressParametersParser.prototype.parse=function(a){try{var c=new AddressParser(this.getLexer());var e=c.address(false);a.setAddress(e);this.lexer.SPorHT();var d=this.lexer.lookAhead(0);if(this.lexer.hasMoreChars()&&d!=""&&d!="\n"&&this.lexer.startsId()){ParametersParser.prototype.parseNameValueList.call(this,a)}else{ParametersParser.prototype.parse.call(this,a)}}catch(b){console.error("AddressParametersParser:parse(): address Error");throw b}};function ChallengeParser(){this.classname="ChallengeParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}ChallengeParser.prototype=new HeaderParser();ChallengeParser.prototype.constructor=ChallengeParser;ChallengeParser.prototype.parse=function(c){this.lexer.SPorHT();this.lexer.match(TokenTypes.prototype.ID);var a=this.lexer.getNextToken();this.lexer.SPorHT();c.setScheme(a.getTokenValue());while(this.lexer.lookAhead(0)!="\n"){this.parseParameter(c);this.lexer.SPorHT();var b=this.lexer.lookAhead(0);if(b=="\n"||b=="'\0'"){break}this.lexer.match(",");this.lexer.SPorHT()}};ChallengeParser.prototype.parseParameter=function(b){var a=this.nameValue("=");b.setParameter_nv(a)};function URLParser(){this.classname="URLParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("sip_urlLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("sip_urlLexer",a)}}}URLParser.prototype=new Parser();URLParser.prototype.constructor=URLParser;URLParser.prototype.PLUS=TokenTypes.prototype.PLUS;URLParser.prototype.SEMICOLON=TokenTypes.prototype.SEMICOLON;URLParser.prototype.isMark=function(a){switch(a){case"-":case"_":case".":case"!":case"~":case"*":case"'":case"(":case")":return true;default:return false}};URLParser.prototype.isUnreserved=function(a){var b=new Lexer("","");if(b.isAlphaDigit(a)||this.isMark(a)){return true}else{return false}};URLParser.prototype.isReservedNoSlash=function(a){switch(a){case";":case"?":case":":case"@":case"&":case"+":case"$":case",":return true;default:return false}};URLParser.prototype.isUserUnreserved=function(a){switch(a){case"&":case"?":case"+":case"$":case"#":case"/":case",":case";":case"=":return true;default:return false}};URLParser.prototype.unreserved=function(){var a=this.lexer.lookAhead(0);if(this.isUnreserved(a)){this.lexer.consume(1);return a}else{console.error("URLParser:unreserved(): unreserved");throw"URLParser:unreserved(): unreserved"}};URLParser.prototype.paramNameOrValue=function(){var a=this.lexer.getPtr();while(this.lexer.hasMoreChars()){var b=this.lexer.lookAhead(0);var c=false;switch(b){case"[":case"]":case"/":case":":case"&":case"+":case"$":c=true}if(c||this.isUnreserved(b)){this.lexer.consume(1)}else{if(this.isEscaped()){this.lexer.consume(3)}else{break}}}return this.lexer.getBuffer().substring(a,this.lexer.getPtr())};URLParser.prototype.uriParam=function(){var d="";var b=this.paramNameOrValue();var c=this.lexer.lookAhead(0);var a=true;if(c=="="){this.lexer.consume(1);d=this.paramNameOrValue();a=false}if(b.length==0&&(d==null||d.length==0)){return null}else{return new NameValue(b,d,a)}};URLParser.prototype.isReserved=function(a){switch(a){case";":case"/":case"?":case":":case"=":case"@":case"&":case"+":case"$":case",":return true;default:return false}};URLParser.prototype.reserved=function(){var a=this.lexer.lookAhead(0);if(this.isReserved(a)){this.lexer.consume(1);var b="";b=(b+a).toString();return b}else{console.error("URLParser:reserved(): reserved");throw"URLParser:reserved(): reserved"}};URLParser.prototype.isEscaped=function(){try{var b=new Lexer("","");if(this.lexer.lookAhead(0)=="%"&&b.isHexDigit(this.lexer.lookAhead(1))&&b.isHexDigit(this.lexer.lookAhead(2))){return true}else{return false}}catch(a){console.error("URLParser:isEscaped(): catched exception:"+a);return false}};URLParser.prototype.escaped=function(){var e=new Lexer("","");var a="";var d=this.lexer.lookAhead(0);var c=this.lexer.lookAhead(1);var b=this.lexer.lookAhead(2);if(d=="%"&&e.isHexDigit(c)&&e.isHexDigit(b)){this.lexer.consume(3);a=a+d+c+b}else{console.error("URLParser:escaped(): escaped");throw"URLParser:escaped(): escaped"}return a.toString()};URLParser.prototype.mark=function(){var a=this.lexer.lookAhead(0);if(this.isMark(a)){this.lexer.consume(1);return a}else{console.error("URLParser:mark(): marked");throw"URLParser:mark(): marked"}};URLParser.prototype.uric=function(){try{var c=new Lexer("","");var d=this.lexer.lookAhead(0);if(this.isUnreserved(d)){this.lexer.consume(1);return c.charAsString(d)}else{if(this.isReserved(d)){this.lexer.consume(1);return c.charAsString(d)}else{if(this.isEscaped()){var a=this.lexer.charAsString(3);this.lexer.consume(3);return a}else{return null}}}}catch(b){console.error("URLParser:uric(): catched exception:"+b);return null}};URLParser.prototype.uricNoSlash=function(){try{var c=new Lexer("","");var d=this.lexer.lookAhead(0);if(this.isEscaped()){var a=this.lexer.charAsString(3);this.lexer.consume(3);return a}else{if(this.isUnreserved(d)){this.lexer.consume(1);return c.charAsString(d)}else{if(this.isReservedNoSlash(d)){this.lexer.consume(1);return c.charAsString(d)}else{return null}}}}catch(b){console.error("URLParser:uricNoSlash(): catched exception:"+b);return null}};URLParser.prototype.uricString=function(){var a="";while(true){var b=this.uric();if(b==null){var d=this.lexer.lookAhead(0);if(d=="["){var e=new HostNameParser(this.getLexer());var c=e.hostPort(false);a=a+c.toString();continue}break}a=a+b}return a.toString()};URLParser.prototype.uriReference=function(g){var a=null;var f=this.lexer.peekNextToken(2);var d=f[0];var c=f[1];if(d.getTokenType()==TokenTypes.prototype.SIP||d.getTokenType()==TokenTypes.prototype.SIPS){if(c.getTokenType()==":"){a=this.sipURL(g)}else{console.error("URLParser:uriReference(): expecting ':'");throw"URLParser:uriReference(): expecting ':'"}}else{if(d.getTokenType()==TokenTypes.prototype.TEL){if(c.getTokenType()==":"){a=this.telURL(g)}else{console.error("URLParser:uriReference(): expecting ':'");throw"URLParser:uriReference(): expecting ':'"}}else{var e=this.uricString();try{a=new GenericURI(e)}catch(b){console.error("URLParser:uriReference(): "+b);throw"URLParser:uriReference(): "+b}}}return a};URLParser.prototype.base_phone_number=function(){var b="";var d=new Lexer("","");var c=0;while(this.lexer.hasMoreChars()){var a=this.lexer.lookAhead(0);if(d.isDigit(a)||a=="-"||a=="."||a=="("||a==")"){this.lexer.consume(1);b=b+a;c++}else{if(c>0){break}else{console.error("URLParser:base_phone_number(): unexpected"+a);throw"URLParser:base_phone_number(): unexpected"+a}}}return b.toString()};URLParser.prototype.local_number=function(){var a="";var c=new Lexer("","");var b=0;while(this.lexer.hasMoreChars()){var d=this.lexer.lookAhead(0);if(d=="*"||d=="#"||d=="-"||d=="."||d=="("|d==")"||c.isHexDigit(d)){this.lexer.consume(1);a=a+d;b++}else{if(b>0){break}else{console.error("URLParser:local_number(): unexpected"+d);throw"URLParser:local_number(): unexpected"+d}}}return a.toString()};URLParser.prototype.parseTelephoneNumber=function(e){var a;this.lexer.selectLexer("charLexer");var b=new Lexer("","");var d=this.lexer.lookAhead(0);if(d=="+"){a=this.global_phone_number(e)}else{if(b.isHexDigit(d)||d=="#"||d=="*"||d=="-"||d=="."||d=="("||d==")"){a=this.local_phone_number(e)}else{console.error("URLParser:parseTelephoneNumber(): unexpected char "+d);throw"URLParser:parseTelephoneNumber(): unexpected char "+d}}return a};URLParser.prototype.global_phone_number=function(f){var c=new TelephoneNumber();c.setGlobal(true);var e=null;this.lexer.match("+");var a=this.base_phone_number();c.setPhoneNumber(a);if(this.lexer.hasMoreChars()){var d=this.lexer.lookAhead(0);if(d==";"&&f){this.lexer.consume(1);e=tel_parameters();c.setParameters(e)}}return c};URLParser.prototype.local_phone_number=function(f){var c=new TelephoneNumber();c.setGlobal(false);var e=null;var a=null;a=this.local_number();c.setPhoneNumber(a);if(this.lexer.hasMoreChars()){var d=this.lexer.peekNextToken();switch(d.getTokenType()){case this.SEMICOLON:if(f){this.lexer.consume(1);e=this.tel_parameters();c.setParameters(e)}break;default:break}}return c};URLParser.prototype.tel_parameters=function(){var d=new NameValueList();var a;while(true){var b=this.paramNameOrValue();if(b.toLowerCase()==("phone-context").toLowerCase()){a=this.phone_context()}else{if(this.lexer.lookAhead(0)=="="){this.lexer.consume(1);var c=this.paramNameOrValue();a=new NameValue(b,c,false)}else{a=new NameValue(b,"",true)}}d.set(a);if(this.lexer.lookAhead(0)==";"){this.lexer.consume(1)}else{return d}}};URLParser.prototype.phone_context=function(){this.lexer.match("=");var c=this.lexer.lookAhead(0);var b=null;if(c=="+"){this.lexer.consume(1);b="+"+this.base_phone_number()}else{if(Lexer.isAlphaDigit(c)){var a=this.lexer.match(Lexer.prototype.ID);b=a.getTokenValue()}else{console.error("URLParser:phone_context(): invalid phone-context:"+c);throw"URLParser:phone_context(): invalid phone-context:"+c}}return new NameValue("phone-context",b,false)};URLParser.prototype.telURL=function(c){this.lexer.match(TokenTypes.prototype.TEL);this.lexer.match(":");var a=this.parseTelephoneNumber(c);var b=new TelURLImpl();b.setTelephoneNumber(a);return b};URLParser.prototype.sipURL=function(h){var c=new SipUri();var f=this.lexer.peekNextToken();var b=TokenTypes.prototype.SIP;var e=TokenNames.prototype.SIP;if(f.getTokenType()==TokenTypes.prototype.SIPS){b=TokenTypes.prototype.SIPS;e=TokenNames.prototype.SIPS}this.lexer.match(b);this.lexer.match(":");c.setScheme(e);var d=this.lexer.markInputPosition();var a=this.user();var i=null;if(this.lexer.lookAhead()==":"){this.lexer.consume(1);i=this.password()}if(this.lexer.lookAhead()=="@"){this.lexer.consume(1);c.setUser(a);if(i!=null){c.setUserPassword(i)}}else{this.lexer.rewindInputPosition(d)}var g=new HostNameParser(this.getLexer());var k=g.hostPort(false);c.setHostPort(k);this.lexer.selectLexer("charLexer");while(this.lexer.hasMoreChars()){if(this.lexer.lookAhead(0)!=";"||!h){break}this.lexer.consume(1);var j=this.uriParam();if(j!=null){c.setUriParameter(j)}}if(this.lexer.hasMoreChars()&&this.lexer.lookAhead(0)=="?"){this.lexer.consume(1);while(this.lexer.hasMoreChars()){j=this.qheader();c.setQHeader(j);if(this.lexer.hasMoreChars()&&this.lexer.lookAhead(0)!="&"){break}else{this.lexer.consume(1)}}}return c};URLParser.prototype.peekScheme=function(){var b=this.lexer.peekNextToken(1);if(b.length==0){return null}var a=b[0].getTokenValue();return a};URLParser.prototype.qheader=function(){var b=this.lexer.ptr;while(true){var d=this.lexer.lookAhead(0);if(d=="="){break}else{if(d==""){console.error("URLParser:qheader(): EOL reached");throw"URLParser:qheader(): EOL reached"}}this.lexer.consume(1)}var a=this.lexer.getBuffer().substring(b,this.lexer.ptr);this.lexer.consume(1);var c=this.hvalue();return new NameValue(a,c,false)};URLParser.prototype.hvalue=function(){var a="";while(this.lexer.hasMoreChars()){var d=this.lexer.lookAhead(0);var c=false;switch(d){case"+":case"?":case":":case"[":case"]":case"/":case"$":case"_":case"-":case'"':case"!":case"~":case"*":case".":case"(":case")":c=true}var b=new Lexer("","");if(c||b.isAlphaDigit(d)){this.lexer.consume(1);a=a+d}else{if(d=="%"){a=a+this.escaped()}else{break}}}return a.toString()};URLParser.prototype.urlString=function(){var a="";this.lexer.selectLexer("charLexer");while(this.lexer.hasMoreChars()){var b=this.lexer.lookAhead(0);if(b==" "||b=="\t"||b=="\n"||b==">"||b=="<"){break}this.lexer.consume(0);a=a+b}return a.toString()};URLParser.prototype.user=function(){var a=this.lexer.getPtr();while(this.lexer.hasMoreChars()){var b=this.lexer.lookAhead(0);if(this.isUnreserved(b)||this.isUserUnreserved(b)){this.lexer.consume(1)}else{if(this.isEscaped()){this.lexer.consume(3)}else{break}}}return this.lexer.getBuffer().substring(a,this.lexer.getPtr())};URLParser.prototype.password=function(){var a=this.lexer.getPtr();while(this.lexer.hasMoreChars()){var c=this.lexer.lookAhead(0);var b=false;switch(c){case"&":case"=":case"+":case"$":case",":b=true}if(b||this.isUnreserved(c)){this.lexer.consume(1)}else{if(this.isEscaped()){this.lexer.consume(3)}else{break}}}return this.lexer.getBuffer().substring(a,this.lexer.getPtr())};URLParser.prototype.parse=function(){return this.uriReference(true)};function AddressParser(){this.classname="AddressParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}AddressParser.prototype=new Parser();AddressParser.prototype.constructor=AddressParser;AddressParser.prototype.NAME_ADDR=1;AddressParser.prototype.ADDRESS_SPEC=2;AddressParser.prototype.nameAddr=function(){if(this.lexer.lookAhead(0)=="<"){this.lexer.consume(1);this.lexer.selectLexer("sip_urlLexer");this.lexer.SPorHT();var d=new URLParser(this.lexer);var c=d.uriReference(true);var a=new AddressImpl();a.setAddressType(this.NAME_ADDR);a.setURI(c);this.lexer.SPorHT();this.lexer.match(">");return a}else{var e=new AddressImpl();e.setAddressType(this.NAME_ADDR);var b=null;if(this.lexer.lookAhead(0)=='"'){b=this.lexer.quotedString();this.lexer.SPorHT()}else{b=this.lexer.getNextToken("<")}e.setDisplayName(b.trim());this.lexer.match("<");this.lexer.SPorHT();d=new URLParser(this.lexer);c=d.uriReference(true);a=new AddressImpl();e.setAddressType(this.NAME_ADDR);e.setURI(c);this.lexer.SPorHT();this.lexer.match(">");return e}};AddressParser.prototype.address=function(f){var a=null;var b=0;while(this.lexer.hasMoreChars()){var e=this.lexer.lookAhead(b);if(e=="<"||e=='"'||e==":"||e=="/"){break}else{if(e==""){console.error("AddressParser:address(): unexpected EOL");throw"AddressParser:parse(): unexpected EOL"}else{b++}}}e=this.lexer.lookAhead(b);if(e=="<"||e=='"'){a=this.nameAddr()}else{if(e==":"||e=="/"){a=new AddressImpl();var d=new URLParser(this.lexer);var c=d.uriReference(f);a.setAddressType(this.ADDRESS_SPEC);a.setURI(c)}else{console.error("AddressParser:address(): bad address spec");throw"AddressParser:parse(): bad address spec"}}return a};function ToParser(){this.classname="ToParser";if(typeof arguments[0]=="object"){var a=arguments[0];this.lexer=a;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var b=arguments[0];this.lexer=new Lexer("command_keywordLexer",b)}}}ToParser.prototype=new AddressParametersParser();ToParser.prototype.constructor=ToParser;ToParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.TO);var a=new To();AddressParametersParser.prototype.parse.call(this,a);this.lexer.match("\n");return a};function ReferToParser(){this.classname="ReferToParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}ReferToParser.prototype=new AddressParametersParser();ReferToParser.prototype.constructor=ReferToParser;ReferToParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.REFER_TO);var a=new ReferTo();AddressParametersParser.prototype.parse.call(this,a);this.lexer.match("\n");return a};function ReferredByParser(){this.classname="ReferredByParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}ReferredByParser.prototype=new AddressParametersParser();ReferredByParser.prototype.constructor=ReferredByParser;ReferredByParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.REFERREDBY_TO);var a=new ReferredBy();AddressParametersParser.prototype.parse.call(this,a);this.lexer.match("\n");return a};function FromParser(){this.classname="FromParser";if(typeof arguments[0]=="object"){var a=arguments[0];this.lexer=a;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var b=arguments[0];this.lexer=new Lexer("command_keywordLexer",b)}}}FromParser.prototype=new AddressParametersParser();FromParser.prototype.constructor=FromParser;FromParser.prototype.parse=function(){var a=new From();this.lexer.match(TokenTypes.prototype.FROM);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT();AddressParametersParser.prototype.parse.call(this,a);this.lexer.match("\n");return a};function CSeqParser(){this.classname="CSeqParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}CSeqParser.prototype=new HeaderParser();CSeqParser.prototype.constructor=CSeqParser;CSeqParser.prototype.parse=function(){var e=new CSeq();this.lexer.match(TokenTypes.prototype.CSEQ);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT();var b=this.lexer.number();e.setSeqNumber(b);this.lexer.SPorHT();var d=new SIPRequest();var a=d.getCannonicalName(this.method());e.setMethod(a);this.lexer.SPorHT();this.lexer.match("\n");return e};function ViaParser(){this.classname="ViaParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}ViaParser.prototype=new HeaderParser();ViaParser.prototype.constructor=ViaParser;ViaParser.prototype.RECEIVED="received";ViaParser.prototype.BRANCH="branch";ViaParser.prototype.parseVia=function(j){this.lexer.match(TokenTypes.prototype.ID);var c=this.lexer.getNextToken();this.lexer.SPorHT();this.lexer.match("/");this.lexer.SPorHT();this.lexer.match(TokenTypes.prototype.ID);this.lexer.SPorHT();var g=this.lexer.getNextToken();this.lexer.SPorHT();this.lexer.match("/");this.lexer.SPorHT();this.lexer.match(TokenTypes.prototype.ID);this.lexer.SPorHT();var e=this.lexer.getNextToken();this.lexer.SPorHT();var m=new Protocol();m.setProtocolName(c.getTokenValue());m.setProtocolVersion(g.getTokenValue());m.setTransport(e.getTokenValue());j.setSentProtocol(m);var h=new HostNameParser(this.getLexer());var d=h.hostPort(true);j.setSentBy(d);this.lexer.SPorHT();while(this.lexer.lookAhead(0)==";"){this.lexer.consume(1);this.lexer.SPorHT();var k=this.nameValue();var b=k.getName();if(b==this.BRANCH){var f=k.getValueAsObject();if(f==null){console.error("ViaParser:parseVia(): null branch Id",this.lexer.getPtr());throw"ViaParser:parseVia(): null branch Id"+this.lexer.getPtr()}}j.setParameter_nv(k);this.lexer.SPorHT()}if(this.lexer.lookAhead(0)=="("){this.lexer.selectLexer("charLexer");this.lexer.consume(1);var i="";while(true){var a=this.lexer.lookAhead(0);if(a==")"){this.lexer.consume(1);break}else{if(a=="\\"){var l=this.lexer.getNextToken();i=i+l.getTokenValue();this.lexer.consume(1);l=this.lexer.getNextToken();i=i+l.getTokenValue();this.lexer.consume(1)}else{if(a=="\n"){break}else{i=i+a;this.lexer.consume(1)}}}}j.setComment(i.toString())}};ViaParser.prototype.nameValue=function(){this.lexer.match(LexerCore.prototype.ID);var b=this.lexer.getNextToken();this.lexer.SPorHT();try{var d=false;var f=this.lexer.lookAhead(0);if(f=="="){this.lexer.consume(1);this.lexer.SPorHT();var g=null;if(b.getTokenValue().toLowerCase()==this.RECEIVED.toLowerCase()){g=this.lexer.byteStringNoSemicolon()}else{if(this.lexer.lookAhead(0)=='"'){g=this.lexer.quotedString();d=true}else{this.lexer.match(LexerCore.prototype.ID);var e=this.lexer.getNextToken();g=e.getTokenValue()}}var a=new NameValue(b.getTokenValue().toLowerCase(),g);if(d){a.setQuotedValue()}return a}else{return new NameValue(b.getTokenValue().toLowerCase(),null)}}catch(c){console.error("ViaParser:nameValue(): catched exception:"+c);return new NameValue(b.getTokenValue(),null)}};ViaParser.prototype.parse=function(){var b=new ViaList();this.lexer.match(TokenTypes.prototype.VIA);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT();while(true){var a=new Via();this.parseVia(a);b.add(a);this.lexer.SPorHT();if(this.lexer.lookAhead(0)==","){this.lexer.consume(1);this.lexer.SPorHT()}if(this.lexer.lookAhead(0)=="\n"){break}}this.lexer.match("\n");return b};function ContactParser(){this.classname="ContactParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}ContactParser.prototype=new AddressParametersParser();ContactParser.prototype.constructor=ContactParser;ContactParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.CONTACT);var b=new ContactList();while(true){var a=new Contact();if(this.lexer.lookAhead(0)=="*"){var c=this.lexer.lookAhead(1);if(c==" "||c=="\t"||c=="\r"||c=="\n"){this.lexer.match("*");a.setWildCardFlag(true)}else{AddressParametersParser.prototype.parse.call(this,a)}}else{AddressParametersParser.prototype.parse.call(this,a)}b.add(a);this.lexer.SPorHT();var d=this.lexer.lookAhead(0);if(d==","){this.lexer.match(",");this.lexer.SPorHT()}else{if(d=="\n"||d==""){break}else{console.error("ContactParser:address(): unexpected char");throw"ContactParser:parse(): unexpected char"}}}return b};ContactParser.prototype.nameValue=function(){this.lexer.match(LexerCore.prototype.ID);var b=this.lexer.getNextToken();this.lexer.SPorHT();try{var d=false;var e=this.lexer.lookAhead(0);if(e=="="){this.lexer.consume(1);this.lexer.SPorHT();var f=null;if(this.lexer.lookAhead(0)=='"'){f=this.lexer.quotedString();d=true}else{f=this.lexer.byteStringNoSemicolon()}var a=new NameValue(b.getTokenValue().toLowerCase(),f);if(d){a.setQuotedValue()}return a}else{return new NameValue(b.getTokenValue().toLowerCase(),null)}}catch(c){console.error("ContactParser:nameValue(): catched exception:"+c);return new NameValue(b.getTokenValue(),null)}};function ContentTypeParser(){this.classname="ContentTypeParser";if(typeof arguments[0]=="object"){var a=arguments[0];this.lexer=a;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var b=arguments[0];this.lexer=new Lexer("command_keywordLexer",b)}}}ContentTypeParser.prototype=new ParametersParser();ContentTypeParser.prototype.constructor=ContentTypeParser;ContentTypeParser.prototype.parse=function(){var c=new ContentType();this.headerName(TokenTypes.prototype.CONTENT_TYPE);this.lexer.match(TokenTypes.prototype.ID);var a=this.lexer.getNextToken();this.lexer.SPorHT();c.setContentType(a.getTokenValue());this.lexer.match("/");this.lexer.match(TokenTypes.prototype.ID);var b=this.lexer.getNextToken();this.lexer.SPorHT();c.setContentSubType(b.getTokenValue());ParametersParser.prototype.parse.call(this,c);this.lexer.match("\n");return c};function ContentLengthParser(){this.classname="ContentLengthParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}ContentLengthParser.prototype=new HeaderParser();ContentLengthParser.prototype.constructor=ContentLengthParser;ContentLengthParser.prototype.parse=function(){var a=new ContentLength();this.headerName(TokenTypes.prototype.CONTENT_LENGTH);var b=this.lexer.number();a.setContentLength(b);this.lexer.SPorHT();this.lexer.match("\n");return a};function AuthorizationParser(){this.classname="AuthorizationParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}AuthorizationParser.prototype=new ChallengeParser();AuthorizationParser.prototype.constructor=AuthorizationParser;AuthorizationParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.AUTHORIZATION);var a=new Authorization();ChallengeParser.prototype.parse.call(this,a);return a};function WWWAuthenticateParser(){this.classname="WWWAuthenticateParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}WWWAuthenticateParser.prototype=new ChallengeParser();WWWAuthenticateParser.prototype.constructor=WWWAuthenticateParser;WWWAuthenticateParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.WWW_AUTHENTICATE);var a=new WWWAuthenticate();ChallengeParser.prototype.parse.call(this,a);return a};function CallIDParser(){this.classname="CallIDParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}CallIDParser.prototype=new HeaderParser();CallIDParser.prototype.constructor=CallIDParser;CallIDParser.prototype.parse=function(){this.lexer.match(TokenTypes.prototype.CALL_ID);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT();var a=new CallID();this.lexer.SPorHT();var b=this.lexer.getRest();a.setCallId(b.trim());return a};function RouteParser(){this.classname="RouteParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}RouteParser.prototype=new AddressParametersParser();RouteParser.prototype.constructor=RouteParser;RouteParser.prototype.parse=function(){var b=new RouteList();this.lexer.match(TokenTypes.prototype.ROUTE);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT();while(true){var a=new Route();AddressParametersParser.prototype.parse.call(this,a);b.add(a);this.lexer.SPorHT();var c=this.lexer.lookAhead(0);if(c==","){this.lexer.match(",");this.lexer.SPorHT()}else{if(c=="\n"){break}else{console.error("RouteParser:parse(): unexpected char");throw"RouteParser:parse(): unexpected char"}}}return b};function RecordRouteParser(){this.classname="RecordRouteParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}RecordRouteParser.prototype=new AddressParametersParser();RecordRouteParser.prototype.constructor=RecordRouteParser;RecordRouteParser.prototype.parse=function(){var b=new RecordRouteList();this.lexer.match(TokenTypes.prototype.RECORD_ROUTE);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT();while(true){var a=new RecordRoute();AddressParametersParser.prototype.parse.call(this,a);b.add(a);this.lexer.SPorHT();var c=this.lexer.lookAhead(0);if(c==","){this.lexer.match(",");this.lexer.SPorHT()}else{if(c=="\n"){break}else{console.error("RecordRouteParser:parse(): unexpected char");throw"RecordRouteParser:parse(): unexpected char"}}}return b};function ProxyAuthenticateParser(){this.classname="ProxyAuthenticateParser";if(typeof arguments[0]=="object"){var a=arguments[0];this.lexer=a;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var b=arguments[0];this.lexer=new Lexer("command_keywordLexer",b)}}}ProxyAuthenticateParser.prototype=new ChallengeParser();ProxyAuthenticateParser.prototype.constructor=ProxyAuthenticateParser;ProxyAuthenticateParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.PROXY_AUTHENTICATE);var a=new ProxyAuthenticate();ChallengeParser.prototype.parse.call(this,a);return a};function ProxyAuthorizationParser(){this.classname="ProxyAuthorizationParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}ProxyAuthorizationParser.prototype=new ChallengeParser();ProxyAuthorizationParser.prototype.constructor=ProxyAuthorizationParser;ProxyAuthorizationParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.PROXY_AUTHORIZATION);var a=new ProxyAuthorization();ChallengeParser.prototype.parse.call(this,a);return a};function TimeStampParser(){this.classname="TimeStampParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}TimeStampParser.prototype=new HeaderParser();TimeStampParser.prototype.constructor=TimeStampParser;TimeStampParser.prototype.TIMESTAMP="Timestamp";TimeStampParser.prototype.parse=function(){var a=new TimeStamp();this.headerName(TokenTypes.prototype.TIMESTAMP);a.setHeaderName(this.TIMESTAMP);this.lexer.SPorHT();var e=this.lexer.number();if(this.lexer.lookAhead(0)=="."){this.lexer.match(".");var b=this.lexer.number();var c=e+"."+b;var d=c;a.setTimeStamp(d)}else{d=e;a.setTime(d)}this.lexer.SPorHT();if(this.lexer.lookAhead(0)!="\n"){e=this.lexer.number()}if(this.lexer.lookAhead(0)=="."){this.lexer.match(".");b=this.lexer.number();c=e+"."+b;d=c;a.setDelay(d)}else{d=e;a.setDelay(d)}return a};function UserAgentParser(){this.classname="UserAgentParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}UserAgentParser.prototype=new HeaderParser();UserAgentParser.prototype.constructor=UserAgentParser;UserAgentParser.prototype.parse=function(){var d=new UserAgent();this.headerName(TokenTypes.prototype.USER_AGENT);if(this.lexer.lookAhead(0)=="\n"){console.error("UserAgentParser:parse(): empty header");throw"UserAgentParser:parse(): empty header"}while(this.lexer.lookAhead(0)!="\n"&&this.lexer.lookAhead(0)!=""){if(this.lexer.lookAhead(0)=="("){var e=this.lexer.comment();d.addProductToken("("+e+")")}else{this.getLexer().SPorHT();var c=this.lexer.byteStringNoSlash();if(c==null){console.error("UserAgentParser:parse(): expected product string");throw"UserAgentParser:parse():expected product string"}var b=c;if(this.lexer.peekNextToken().getTokenValue()=="/"){this.lexer.match("/");this.getLexer().SPorHT();var a=this.lexer.byteStringNoWhiteSpace();if(a==null){console.error("UserAgentParser:parse(): expected product version");throw"UserAgentParser:parse(): expected product version"}b=b+"/"+a}d.addProductToken(b.toString())}this.lexer.SPorHT()}return d};function SupportedParser(){this.classname="SupportedParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}SupportedParser.prototype=new HeaderParser();SupportedParser.prototype.constructor=SupportedParser;SupportedParser.prototype.SUPPORTED="Supported";SupportedParser.prototype.parse=function(){var b=new SupportedList();this.headerName(TokenTypes.prototype.SUPPORTED);while(this.lexer.lookAhead(0)!="\n"){this.lexer.SPorHT();var a=new Supported();a.setHeaderName(this.SUPPORTED);this.lexer.match(TokenTypes.prototype.ID);var c=this.lexer.getNextToken();a.setOptionTag(c.getTokenValue());this.lexer.SPorHT();b.add(a);while(this.lexer.lookAhead(0)==","){this.lexer.match(",");this.lexer.SPorHT();a=new Supported();this.lexer.match(TokenTypes.prototype.ID);c=this.lexer.getNextToken();a.setOptionTag(c.getTokenValue());this.lexer.SPorHT();b.add(a)}}return b};function ServerParser(){this.classname="ServerParser";if(typeof arguments[0]=="object"){var a=arguments[0];this.lexer=a;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var b=arguments[0];this.lexer=new Lexer("command_keywordLexer",b)}}}ServerParser.prototype=new HeaderParser();ServerParser.prototype.constructor=ServerParser;ServerParser.prototype.parse=function(){var a=new Server();this.headerName(TokenTypes.prototype.SERVER);if(this.lexer.lookAhead(0)=="\n"){console.error("ServerParser:parse(): empty header");throw"ServerParser:parse():  empty header"}a.addProductToken(this.lexer.getRest().trim());return a};function SubjectParser(){this.classname="SubjectParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}SubjectParser.prototype=new HeaderParser();SubjectParser.prototype.constructor=SubjectParser;SubjectParser.prototype.parse=function(){var a=new Subject();this.headerName(TokenTypes.prototype.SUBJECT);this.lexer.SPorHT();var b=this.lexer.getRest();a.setSubject(b.trim());return a};function MaxForwardsParser(){this.classname="MaxForwardsParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}MaxForwardsParser.prototype=new HeaderParser();MaxForwardsParser.prototype.constructor=MaxForwardsParser;MaxForwardsParser.prototype.parse=function(){var a=new MaxForwards();this.headerName(TokenTypes.prototype.MAX_FORWARDS);var b=this.lexer.number();a.setMaxForwards(b);this.lexer.SPorHT();this.lexer.match("\n");return a};function ReasonParser(){this.classname="ReasonParser";if(typeof arguments[0]=="object"){var a=arguments[0];this.lexer=a;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var b=arguments[0];this.lexer=new Lexer("command_keywordLexer",b)}}}ReasonParser.prototype=new ParametersParser();ReasonParser.prototype.constructor=ReasonParser;ReasonParser.prototype.parse=function(){var d=new ReasonList();this.headerName(TokenTypes.prototype.REASON);this.lexer.SPorHT();while(this.lexer.lookAhead(0)!="\n"){var c=new Reason();this.lexer.match(TokenTypes.prototype.ID);var a=this.lexer.getNextToken();var b=a.getTokenValue();c.setProtocol(b);ParametersParser.prototype.parse.call(this,c);d.add(c);if(this.lexer.lookAhead(0)==","){this.lexer.match(",");this.lexer.SPorHT()}else{this.lexer.SPorHT()}return d}};function RequestLineParser(){this.classname="RequestLineParser";if(typeof arguments[0]=="string"){var b=arguments[0];this.lexer=new Lexer("method_keywordLexer",b)}else{if(typeof arguments[0]=="object"){var a=arguments[0];this.lexer=a;this.lexer.selectLexer("method_keywordLexer")}}}RequestLineParser.prototype=new Parser();RequestLineParser.prototype.constructor=RequestLineParser;RequestLineParser.prototype.parse=function(){var b=new RequestLine();var a=this.method();this.lexer.SPorHT();b.setMethod(a);this.lexer.selectLexer("sip_urlLexer");var e=new URLParser(this.getLexer());var d=e.uriReference(true);this.lexer.SPorHT();b.setUri(d);this.lexer.selectLexer("request_lineLexer");var c=this.sipVersion();b.setSipVersion(c);this.lexer.SPorHT();this.lexer.match("\n");return b};function ExpiresParser(){this.classname="ExpiresParser";if(typeof arguments[0]=="object"){var a=arguments[0];this.lexer=a;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var b=arguments[0];this.lexer=new Lexer("command_keywordLexer",b)}}}ExpiresParser.prototype=new HeaderParser();ExpiresParser.prototype.constructor=ExpiresParser;ExpiresParser.prototype.parse=function(){var a=new Expires();this.lexer.match(TokenTypes.prototype.EXPIRES);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT();var b=this.lexer.getNextId();this.lexer.match("\n");var c=b+0;a.setExpires(c);return a};function EventParser(){this.classname="EventParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}EventParser.prototype=new ParametersParser();EventParser.prototype.constructor=EventParser;EventParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.EVENT);this.lexer.SPorHT();var b=new EventHeader(null);this.lexer.match(TokenTypes.prototype.ID);var a=this.lexer.getNextToken();var c=a.getTokenValue();b.setEventType(c);ParametersParser.prototype.parse.call(this,b);this.lexer.SPorHT();this.lexer.match("\n");return b};function StatusLineParser(){this.classname="StatusLineParser";if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("status_lineLexer",a)}else{if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("status_lineLexer")}}}StatusLineParser.prototype=new Parser();StatusLineParser.prototype.constructor=StatusLineParser;StatusLineParser.prototype.statusCode=function(){var b=this.lexer.number();var a=b;return a};StatusLineParser.prototype.reasonPhrase=function(){return this.lexer.getRest().trim()};StatusLineParser.prototype.parse=function(){var b=new StatusLine();var a=this.sipVersion();b.setSipVersion(a);this.lexer.SPorHT();var c=this.statusCode();b.setStatusCode(c);this.lexer.SPorHT();var d=this.reasonPhrase();b.setReasonPhrase(d);this.lexer.SPorHT();return b};function ContentDispositionParser(){this.classname="ContentDispositionParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}ContentDispositionParser.prototype=new ParametersParser();ContentDispositionParser.prototype.constructor=ContentDispositionParser;ContentDispositionParser.prototype.CONTENT_DISPOSITION="Content-Disposition";ContentDispositionParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.CONTENT_DISPOSITION);var b=new ContentDisposition();b.setHeaderName(this.CONTENT_DISPOSITION);this.lexer.SPorHT();this.lexer.match(TokenTypes.prototype.ID);var a=this.lexer.getNextToken();b.setDispositionType(a.getTokenValue());this.lexer.SPorHT();ParametersParser.prototype.parse.call(this,b);this.lexer.SPorHT();this.lexer.match("\n");return b};function AllowParser(){this.classname="AllowParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}AllowParser.prototype=new HeaderParser();AllowParser.prototype.constructor=AllowParser;AllowParser.prototype.ALLOW="Allow";AllowParser.prototype.parse=function(){var c=new AllowList();this.headerName(TokenTypes.prototype.ALLOW);var b=new Allow();b.setHeaderName(this.ALLOW);this.lexer.SPorHT();this.lexer.match(TokenTypes.prototype.ID);var a=this.lexer.getNextToken();b.setMethod(a.getTokenValue());c.add(b);this.lexer.SPorHT();while(this.lexer.lookAhead(0)==","){this.lexer.match(",");this.lexer.SPorHT();b=new Allow();this.lexer.match(TokenTypes.prototype.ID);a=this.lexer.getNextToken();b.setMethod(a.getTokenValue());c.add(b);this.lexer.SPorHT()}this.lexer.SPorHT();this.lexer.match("\n");return c};function AllowEventsParser(){this.classname="AllowEventsParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}AllowEventsParser.prototype=new HeaderParser();AllowEventsParser.prototype.constructor=AllowEventsParser;AllowEventsParser.prototype.ALLOW_EVENTS="Allow-Events";AllowEventsParser.prototype.parse=function(){var c=new AllowEventsList();this.headerName(TokenTypes.prototype.ALLOW_EVENTS);var b=new AllowEvents();b.setHeaderName(this.ALLOW_EVENTS);this.lexer.SPorHT();this.lexer.match(TokenTypes.prototype.ID);var a=this.lexer.getNextToken();b.setEventType(a.getTokenValue());c.add(b);this.lexer.SPorHT();while(this.lexer.lookAhead(0)==","){this.lexer.match(",");this.lexer.SPorHT();b=new AllowEvents();this.lexer.match(TokenTypes.prototype.ID);a=this.lexer.getNextToken();b.setEventType(a.getTokenValue());c.add(b);this.lexer.SPorHT()}this.lexer.SPorHT();this.lexer.match("\n");return c};function ParserFactory(){this.classname="ParserFactory";this.parserTable=new Array();this.constructorArgs=null;this.parserConstructorCache=new Array();this.put(this.parserTable,"t",new ToParser().classname);this.put(this.parserTable,"To".toLowerCase(),new ToParser().classname);this.put(this.parserTable,"From".toLowerCase(),new FromParser().classname);this.put(this.parserTable,"f",new FromParser().classname);this.put(this.parserTable,"CSeq".toLowerCase(),new CSeqParser().classname);this.put(this.parserTable,"Via".toLowerCase(),new ViaParser().classname);this.put(this.parserTable,"v",new ViaParser().classname);this.put(this.parserTable,"Contact".toLowerCase(),new ContactParser().classname);this.put(this.parserTable,"m",new ContactParser().classname);this.put(this.parserTable,"Content-Type".toLowerCase(),new ContentTypeParser().classname);this.put(this.parserTable,"c",new ContentTypeParser().classname);this.put(this.parserTable,"Content-Length".toLowerCase(),new ContentLengthParser().classname);this.put(this.parserTable,"l",new ContentLengthParser().classname);this.put(this.parserTable,"Authorization".toLowerCase(),new AuthorizationParser().classname);this.put(this.parserTable,"WWW-Authenticate".toLowerCase(),new WWWAuthenticateParser().classname);this.put(this.parserTable,"Call-ID".toLowerCase(),new CallIDParser().classname);this.put(this.parserTable,"i",new CallIDParser().classname);this.put(this.parserTable,"Route".toLowerCase(),new RouteParser().classname);this.put(this.parserTable,"Record-Route".toLowerCase(),new RecordRouteParser().classname);this.put(this.parserTable,"Proxy-Authorization".toLowerCase(),new ProxyAuthorizationParser().classname);this.put(this.parserTable,"Proxy-Authenticate".toLowerCase(),new ProxyAuthenticateParser().classname);this.put(this.parserTable,"Timestamp".toLowerCase(),new TimeStampParser().classname);this.put(this.parserTable,"User-Agent".toLowerCase(),new UserAgentParser().classname);this.put(this.parserTable,"Supported".toLowerCase(),new SupportedParser().classname);this.put(this.parserTable,"k",new SupportedParser().classname);this.put(this.parserTable,"Server".toLowerCase(),new ServerParser().classname);this.put(this.parserTable,"Subject".toLowerCase(),new SubjectParser().classname);this.put(this.parserTable,"s",new SubjectParser().classname);this.put(this.parserTable,"Max-Forwards".toLowerCase(),new MaxForwardsParser().classname);this.put(this.parserTable,"Reason".toLowerCase(),new ReasonParser().classname);this.put(this.parserTable,"Expires".toLowerCase(),new ExpiresParser().classname);this.put(this.parserTable,"Event".toLowerCase(),new EventParser().classname);this.put(this.parserTable,"o",new EventParser().classname);this.put(this.parserTable,"Content-Disposition".toLowerCase(),new ContentDispositionParser().classname);this.put(this.parserTable,"Allow".toLowerCase(),new AllowParser().classname);this.put(this.parserTable,"Allow-Events".toLowerCase(),new AllowEventsParser().classname);this.put(this.parserTable,"u",new AllowEventsParser().classname);this.put(this.parserTable,"Refer-To".toLowerCase(),new ReferToParser().classname);this.put(this.parserTable,"Referred-By".toLowerCase(),new ReferredByParser().classname)}ParserFactory.prototype.createParser=function(k){var d=new Lexer("","");var g=d.getHeaderName(k);var h=d.getHeaderValue(k);if(g==null||h==null){console.error("ParserFactory:createParser(): the header name or value is null");throw"ParserFactory:createParser(): the header name or value is null"}var c=null;var j=g.toLowerCase();for(var e=0;e<this.parserTable.length;e++){if(this.parserTable[e][0]==j){c=this.parserTable[e][1]}}if(c!=null){var a=null;for(e=0;e<this.parserConstructorCache.length;e++){if(this.parserConstructorCache[e][0]==c){c=this.parserConstructorCache[e][1]}}if(a==null){a=new Function("return new "+c)();this.put(this.parserConstructorCache,c,a)}var f=k;var b=new window[c](f);return b}else{return new HeaderParser(k)}};ParserFactory.prototype.put=function(e,b,f){var g=0;for(var d=0;d<e.length;d++){var c=e[d][0];if(c==b){g=1;var a=new Array();a[0]=c;a[1]=f;e[d]=a}}if(g==0){a=new Array();a[0]=b;a[1]=f;e.push(a)}return e};function WSMsgParser(a){this.classname="WSMsgParser";this.messageChannel=a}WSMsgParser.prototype.RPORT="rport";WSMsgParser.prototype.RECEIVED="received";WSMsgParser.prototype.parsermessage=function(c){var d=new StringMsgParser();var e=d.parseSIPMessage(c);var b=e.getContentLength();var a=0;if(b!=null){a=b.getContentLength()}else{a=0}if(a==0){e.removeContent()}console.info("SIP message received: "+e.encode());this.processMessage(e)};WSMsgParser.prototype.processMessage=function(f){if(f.getFrom()==null||f.getTo()==null||f.getCallId()==null||f.getCSeq()==null||f.getViaHeaders()==null){return}if(f instanceof SIPRequest){var d=f;var c=this.messageChannel.messageProcessor.sipStack.newSIPServerRequest(d,this.messageChannel);if(c!=null){c.processRequest(d,this.messageChannel)}}else{var e=f;try{e.checkHeaders()}catch(a){console.error("WSMsgParser:processMessage(): catched exception:"+a);return}var b=this.messageChannel.messageProcessor.sipStack.newSIPServerResponse(e,this.messageChannel);if(b!=null){if(b instanceof SIPClientTransaction&&!b.checkFromTag(e)){return}b.processResponse(e,this.messageChannel)}}};function MessageObject(){this.classname="MessageObject"}MessageObject.prototype=new GenericObject();MessageObject.prototype.constructor=MessageObject;MessageObject.prototype.encode=function(){};function ListMap(){this.classname="ListMap";this.headerListTable=new Array();this.initialized=null;this.initializeListMap()}ListMap.prototype.put=function(d,e,b){var j=0;for(var g=0;g<d.length;g++){var f=d[g][0];if(f.classname==e){j=1;var a=new Array();a[0]=e;a[1]=b;d[g]=a}}if(j==0){var h=d.length;a=new Array();a[0]=e;a[1]=b;d[h]=a}};ListMap.prototype.initializeListMap=function(){this.put(this.headerListTable,"Contact","ContactList");this.put(this.headerListTable,"Via","ViaList");this.put(this.headerListTable,"WWW-Authenticate","WWWAuthenticateList");this.put(this.headerListTable,"Route","RouteList");this.put(this.headerListTable,"Proxy-Authenticate","ProxyAuthenticateList");this.put(this.headerListTable,"Allow","AllowList");this.put(this.headerListTable,"Record-Route","RecordRouteList");this.put(this.headerListTable,"Supported","SupportedList");this.initialized=true};ListMap.prototype.hasList=function(){if(!this.initialized){initializeListMap()}var d=arguments[0];if(typeof d=="object"){if(d instanceof SIPHeaderList){return false}else{var c=d.classname;var a=null}}else{c=d;a=null}for(var b=0;b<this.headerListTable.length;b++){if(this.headerListTable[b][0]==c){a=this.headerListTable[b][1]}}if(a!=null){return true}else{return false}};ListMap.prototype.getListClass=function(c){if(!this.initialized){initializeListMap()}var b=null;for(var a=0;a<this.headerListTable.length;a++){if(this.headerListTable[a][0]==c){b=this.headerListTable[a][1]}}return b};ListMap.prototype.getList=function(e){if(!this.initialized){initializeListMap()}var d=e.headerName;var a=null;for(var c=0;c<this.headerListTable.length;c++){if(this.headerListTable[c][0]==d){a=this.headerListTable[c][1]}}if(a!=null){var b=new Function("return new "+a)();b.setHeaderName(e.getName());return b}else{return null}};function SIPMessage(){this.classname="SIPMessage";this.contentEncodingCharset=new MessageFactoryImpl().getDefaultContentEncodingCharset();this.nullRequest=null;this.unrecognizedHeaders=new Array();this.headers=new Array();this.fromHeader=new From();this.toHeader=new To();this.cSeqHeader=new CSeq();this.callIdHeader=new CallID();this.contentLengthHeader=new ContentDisposition();this.maxForwardsHeader=new MaxForwards();this.size=null;this.messageContent=null;this.nameTable=new Array();this.applicationData=null;var a=new ContentLength(0);this.stackTransaction=null;this.attachHeader(a,false)}SIPMessage.prototype=new MessageObject();SIPMessage.prototype.constructor=SIPMessage;SIPMessage.prototype.NEWLINE="\r\n";SIPMessage.prototype.ViaHeader="Via";SIPMessage.prototype.BRANCH_MAGIC_COOKIE_UPPER_CASE="Z9HG4BK";SIPMessage.prototype.CANCEL="CANCEL";SIPMessage.prototype.CONTENT_TYPE_LOWERCASE="content-type";SIPMessage.prototype.AUTHORIZATION_LOWERCASE="authorization";SIPMessage.prototype.PROXYAUTHORIZATION_LOWERCASE="proxy-authorization";SIPMessage.prototype.CONTACT_LOWERCASE="contact";SIPMessage.prototype.VIA_LOWERCASE="via";SIPMessage.prototype.ROUTE_LOWERCASE="route";SIPMessage.prototype.RECORDROUTE_LOWERCASE="record-route";SIPMessage.prototype.CONTENT_DISPOSITION_LOWERCASE="content-disposition";SIPMessage.prototype.EXPIRES_LOWERCASE="expires";SIPMessage.prototype.listMap=new ListMap();SIPMessage.prototype.isRequestHeader=function(a){if(a instanceof Authorization||a instanceof MaxForwards||a instanceof UserAgent||a instanceof ProxyAuthorization||a instanceof Route||a instanceof RouteList||a instanceof Subject){return true}else{return false}};SIPMessage.prototype.isResponseHeader=function(a){if(a instanceof WWWAuthenticate||a instanceof ProxyAuthenticate){return true}else{return false}};SIPMessage.prototype.getMessageAsEncodedStrings=function(){var a=new Array();for(var d=0;d<this.headers.length;d++){var e=this.headers[d];if(e instanceof SIPHeaderList){var b=e;for(var c=0;c<b.getHeadersAsEncodedStrings().length;c++){a[a.length]=b.getHeadersAsEncodedStrings()[c]}}else{a[a.length]=e.encode()}}return a};SIPMessage.prototype.encodeSIPHeaders=function(){var d="";var a="";for(var c=0;c<this.headers.length;c++){var b=this.headers[c];if(!(b instanceof ContentLength)){a=a+b.encodeBuffer(d)}}a=(a+this.contentLengthHeader.encodeBuffer(d)+this.NEWLINE).toString();return a};SIPMessage.prototype.encodeMessage=function(){};SIPMessage.prototype.getDialogId=function(a){};SIPMessage.prototype.encode=function(){var e="";for(var b=0;b<this.headers.length;b++){var a=this.headers[b];if(!(a instanceof ContentLength)){e=e+a.encode()}}for(b=0;b<this.unrecognizedHeaders.length;b++){var c=this.unrecognizedHeaders[b];e=e+c+this.NEWLINE}e=e+this.contentLengthHeader.encode()+this.NEWLINE;if(this.messageContent!=null){var d=this.messageContent;e=e+d}return e.toString()};SIPMessage.prototype.encodeAsBytes=function(h){if(this instanceof SIPRequest&&this.isNullRequest()){return this.getBytes("\r\n\r\n")}var g=this.getHeader(this.ViaHeader);g.setTransport(h);var f="";for(var c=0;c<this.headers.length;c++){var b=this.headers[c];if(!(b instanceof ContentLength)){b.encode(f)}}this.contentLengthHeader.encode(f);f=f+this.NEWLINE;var a=null;var e=this.getRawContent();if(e!=null){var d=null;d=this.getBytes(f.toString());a=d.concat(e)}else{a=this.getBytes(f.toString())}return a};SIPMessage.prototype.attachHeader=function(){if(arguments.length==1){var a=arguments[0];this.attachHeaderargu1(a)}else{if(arguments.length==2){a=arguments[0];var b=arguments[1];this.attachHeaderargu2(a,b)}else{if(arguments.length==3){a=arguments[0];b=arguments[1];var c=arguments[2];this.attachHeaderargu3(a,b,c)}}}};SIPMessage.prototype.attachHeaderargu1=function(b){if(b==null){console.error("MessageFactoryImpl:attachHeaderargu1(): null header!");throw"MessageFactoryImpl:attachHeaderargu1(): null header!"}if(b instanceof SIPHeaderList){var a=b;if(a.hlist.length==0){return}}this.attachHeaderargu3(b,false,false)};SIPMessage.prototype.attachHeaderargu2=function(a,b){this.attachHeaderargu3(a,b,false)};SIPMessage.prototype.attachHeaderargu3=function(g,t,m){if(g==null){console.error("MessageFactoryImpl:attachHeaderargu3(): null header!");throw"MessageFactoryImpl:attachHeaderargu3(): null header!"}var j=null;if(SIPMessage.prototype.listMap.hasList(g)&&!(g instanceof SIPHeaderList)){var b=SIPMessage.prototype.listMap.getList(g);b.add(g);j=b}else{j=g}var k=j.getName().toLowerCase();var d=null;for(var e=0;e<this.nameTable.length;e++){if(this.nameTable[e][0]==k){d=e}}if(t){if(d!=null){this.nameTable.splice(d,1)}}else{if(d!=null&&!(j instanceof SIPHeaderList)){if(j instanceof ContentLength){var r=j;this.contentLengthHeader.setContentLength(r.getContentLength())}return}}var s=this.getHeader(g.getName());if(s!=null){var a=this.headers;var c=0;for(e=0;e<this.headers.length;e++){var f=this.headers[e];if(f!=s){a[c]=f;c=c+1}}this.headers=a}if(d==null){var p=new Array();p[0]=k;p[1]=j;this.nameTable.push(p);this.headers.push(j)}else{if(j instanceof SIPHeaderList){var q=this.nameTable[d][1];if(q!=null){q.concatenate(j,m)}else{p=new Array();p[0]=k;p[1]=j;this.nameTable.push(p)}}else{p=new Array();p[0]=k;p[1]=j;this.nameTable.push(p)}}if(j instanceof From){this.fromHeader=j}else{if(j instanceof ContentLength){this.contentLengthHeader=j}else{if(j instanceof To){this.toHeader=j}else{if(j instanceof CSeq){this.cSeqHeader=j}else{if(j instanceof CallID){this.callIdHeader=j}else{if(j instanceof MaxForwards){this.maxForwardsHeader=j}}}}}}};SIPMessage.prototype.setHeader=function(b){var c=b;if(c==null){console.error("MessageFactoryImpl:setHeader(): null header!");throw"MessageFactoryImpl:setHeader(): null header!"}if(c instanceof SIPHeaderList){var a=c;if(a.hlist.length==0){return}}this.removeHeader(c.getHeaderName());this.attachHeader(c,true,false)};SIPMessage.prototype.setHeaders=function(c){for(var a=0;a<c.length;a++){var b=c[a];this.attachHeader(b,false)}};SIPMessage.prototype.removeHeader=function(){if(arguments.length==1){var b=arguments[0];this.removeHeaderargu1(b)}else{if(arguments.length==2){b=arguments[0];var a=arguments[1];this.removeHeaderargu2(b,a)}}};SIPMessage.prototype.removeHeaderargu1=function(f){if(f==null){console.error("MessageFactoryImpl:removeHeaderargu1(): null header!");throw"MessageFactoryImpl:removeHeaderargu1(): null header!"}var b=f.toLowerCase();var e=null;var a=null;for(var c=0;c<this.nameTable.length;c++){if(this.nameTable[c][0]==b){a=c;e=this.nameTable[c][0]}}if(e==null){return}else{this.nameTable.splice(a,1)}if(e instanceof From){this.fromHeader=null}else{if(e instanceof To){this.toHeader=null}else{if(e instanceof CSeq){this.cSeqHeader=null}else{if(e instanceof CallID){this.callIdHeader=null}else{if(e instanceof MaxForwards){this.maxForwardsHeader=null}else{if(e instanceof ContentLength){this.contentLengthHeader=null}}}}}}for(c=0;c<this.headers.length;c++){var d=this.headers[c];if(d.getName().toLowerCase()==b){a=c}}this.headers.splice(a,1)};SIPMessage.prototype.removeHeaderargu2=function(f,h){var g=f.toLowerCase();var a=null;var d=null;var j=null;for(var e=0;e<this.nameTable.length;e++){if(this.nameTable[e][0]==g){d=e;a=this.nameTable[e][1]}}if(a==null){return}if(a instanceof SIPHeaderList){var b=a;if(h){b.removeFirst()}else{b.removeLast()}if(b.hlist.length==0){for(e=0;e<this.headers.length;e++){var c=this.headers[e];if(c.getName().toLowerCase()==g){j=e}}}this.nameTable.splice(d,1);this.headers.splice(j,1)}};SIPMessage.prototype.getTransactionId=function(){var b=new Via();if(this.getViaHeaders().hlist.length!=0){b=this.getViaHeaders().getFirst()}if(b!=null&&b.getBranch()!=null&&b.getBranch().toUpperCase().substr(0,7)==this.BRANCH_MAGIC_COOKIE_UPPER_CASE){if(this.getCSeq().getMethod()==(this.CANCEL)){return(b.getBranch()+":"+this.getCSeq().getMethod()).toLowerCase()}else{return b.getBranch().toLowerCase()}}else{var a="";var e=this.getFrom();var d=this.getTo();if(e.hasTag()){a=a+e.getTag()+"-"}var c=this.callIdHeader.getCallId();a=a+c+"-"+this.cSeqHeader.getSequenceNumber()+"-"+this.cSeqHeader.getMethod();if(b!=null){a=a+"-"+b.getSentBy().encode();if(!b.getSentBy().hasPort()){a=a+"-"+5060}}if(this.getCSeq().getMethod()==this.CANCEL){a=a+this.CANCEL}a=a.toString().toLowerCase().replace(":","-").replace("@","-")+Utils.prototype.getSignature();return a}};SIPMessage.prototype.hashCode=function(){if(this.callIdHeader==null){console.error("MessageFactoryImpl:hashCode(): invalid message! Cannot compute hashcode! call-id header is missing !");throw"MessageFactoryImpl:hashCode(): invalid message! Cannot compute hashcode! call-id header is missing !"}else{var c=0;var e=this.callIdHeader.getCallId();if(!(e==null||e.value=="")){for(var a=0;a<e.length;a++){c=c*31+e.charCodeAt(a);var b=2147483647;var d=-2147483648;if(c>b||c<d){c&=4294967295}}}return c}};SIPMessage.prototype.hasContent=function(){return this.messageContent!=null};SIPMessage.prototype.getHeaders=function(){if(arguments.length!=0){var d=arguments[0];if(d==null){console.error("MessageFactoryImpl:getHeaders(): headerName header!");throw"MessageFactoryImpl:getHeaders(): null headerName!"}var c=null;for(var b=0;b<this.nameTable.length;b++){if(this.nameTable[b][0]==d.toLowerCase()){c=this.nameTable[b][1]}}if(c==null){var a=new SIPHeaderList();return a.listIterator()}if(c instanceof SIPHeaderList){return c.listIterator()}else{return new HeaderIterator(this,c)}}else{return this.headers}};SIPMessage.prototype.getHeader=function(a){return this.getHeaderLowerCase(a.toLowerCase())};SIPMessage.prototype.getHeaderLowerCase=function(a){if(a==null){console.error("MessageFactoryImpl:getHeaderLowerCase(): null lowerCaseHeaderName !");throw"MessageFactoryImpl:getHeaderLowerCase(): null lowerCaseHeaderName!"}var c=null;for(var b=0;b<this.nameTable.length;b++){if(this.nameTable[b][0]==a){c=this.nameTable[b][1]}}if(c instanceof SIPHeaderList){return c.getFirst()}else{return c}};SIPMessage.prototype.getContentTypeHeader=function(){return this.getHeaderLowerCase(this.CONTENT_TYPE_LOWERCASE)};SIPMessage.prototype.getWWWAuthenticate=function(){return this.getHeaderLowerCase("www-authenticate")};SIPMessage.prototype.getProxyAuthenticate=function(){return this.getHeaderLowerCase("proxy-authenticate")};SIPMessage.prototype.getContentLengthHeader=function(){return this.getContentLength()};SIPMessage.prototype.getFrom=function(){return this.fromHeader};SIPMessage.prototype.getContactHeaders=function(){return this.getSIPHeaderListLowerCase(this.CONTACT_LOWERCASE)};SIPMessage.prototype.getContactHeader=function(){var a=this.getContactHeaders();if(a!=null){return a.getFirst()}else{return null}};SIPMessage.prototype.getViaHeaders=function(){return this.getSIPHeaderListLowerCase(this.VIA_LOWERCASE)};SIPMessage.prototype.setVia=function(b){if(b.classname=="Via"){var d=new ViaList();d.add(b)}else{d=new ViaList();for(var c=0;c<b.hlist.length;c++){var a=b.hlist[c];d.add(a)}}this.setHeader(d)};SIPMessage.prototype.getTopmostVia=function(){if(this.getViaHeaders()==null){return null}else{return this.getViaHeaders().getFirst()}};SIPMessage.prototype.getCSeq=function(){return this.cSeqHeader};SIPMessage.prototype.getAuthorization=function(){return this.getHeaderLowerCase(this.AUTHORIZATION_LOWERCASE)};SIPMessage.prototype.getProxyAuthorization=function(){return this.getHeaderLowerCase(this.PROXYAUTHORIZATION_LOWERCASE)};SIPMessage.prototype.getMaxForwards=function(){return this.maxForwardsHeader};SIPMessage.prototype.setMaxForwards=function(a){this.setHeader(a)};SIPMessage.prototype.getRouteHeaders=function(){return this.getSIPHeaderListLowerCase(this.ROUTE_LOWERCASE)};SIPMessage.prototype.getCallId=function(){return this.callIdHeader};SIPMessage.prototype.setCallId=function(a){if(typeof a=="object"){this.setHeader(a)}else{if(typeof a=="string"){if(this.callIdHeader==null){this.setHeader(new CallID())}this.callIdHeader.setCallId(a)}}};SIPMessage.prototype.getRecordRouteHeaders=function(){return this.getSIPHeaderListLowerCase(this.RECORDROUTE_LOWERCASE)};SIPMessage.prototype.getTo=function(){return this.toHeader};SIPMessage.prototype.setTo=function(a){this.setHeader(a)};SIPMessage.prototype.setFrom=function(a){this.setHeader(a)};SIPMessage.prototype.getContentLength=function(){return this.contentLengthHeader};SIPMessage.prototype.getMessageContent=function(){return this.messageContent};SIPMessage.prototype.getRawContent=function(){return this.messageContent};SIPMessage.prototype.setMessageContent=function(){if(arguments.length==1){var f=arguments[0];this.computeContentLength(f);this.messageContent=f}else{if(arguments.length==3){var d=arguments[0];var h=arguments[1];var e=arguments[2];var c=new ContentType(d,h);this.setHeader(c);this.messageContent=e;this.computeContentLength(e)}else{if(arguments.length==4){f=arguments[0];var a=arguments[1];var b=arguments[2];var g=arguments[3];this.computeContentLength(f);if((!b)){if((!a&&this.contentLengthHeader.getContentLength()!=g)||this.contentLengthHeader.getContentLength()<g){console.error("MessageFactoryImpl:setMessageContent(): invalid content length "+this.contentLengthHeader.getContentLength()+" / "+g,0);throw"MessageFactoryImpl:setMessageContent(): invalid content length "+this.contentLengthHeader.getContentLength()+" / "+g}}this.messageContent=f}}}};SIPMessage.prototype.setContent=function(b,a){if(b==null){console.error("MessageFactoryImpl:setContent(): null content !",0);throw"MessageFactoryImpl:setContent(): null content!"}this.setHeader(a);this.messageContent=b;this.computeContentLength(b)};SIPMessage.prototype.getContent=function(){if(this.messageContent!=null){return this.messageContent}else{return null}};SIPMessage.prototype.computeContentLength=function(d){var c=0;if(d!=null){if(d.constructor.name=="String"){var e=0;var b;for(var a=0;a<d.length;++a){b=d.charCodeAt(a);if(b<128){e=e+1}else{if(b<2048){e=e+2}else{if(b<65536){e=e+3}else{e=e+4}}}}c=e}else{if(d.constructor==Array){c=d.length}else{c=d.toString().length}}}this.contentLengthHeader.setContentLength(c)};SIPMessage.prototype.removeContent=function(){this.messageContent=null;this.contentLengthHeader.setContentLength(0)};SIPMessage.prototype.getHeaderAsFormattedString=function(b){var d=b.toLowerCase();var a=null;for(var c=0;c<this.nameTable.length;c++){if(this.nameTable[c][0]==d){a=c}}if(a!=null){return this.nameTable[a][1].toString()}else{return this.getHeader(b).toString()}};SIPMessage.prototype.getSIPHeaderListLowerCase=function(a){var b=null;for(var c=0;c<this.nameTable.length;c++){if(this.nameTable[c][0]==a){b=c}}if(b!=null){return this.nameTable[b][1]}else{return null}};SIPMessage.prototype.getHeaderList=function(e){var a=null;for(var b=0;b<this.nameTable.length;b++){if(this.nameTable[b][0]==e.toLowerCase()){a=b}}var d=this.nameTable[a][1];if(d==null){return null}else{if(d instanceof SIPHeaderList){return d.getHeaderList()}else{var c=new Array();c.push(d);return c}}};SIPMessage.prototype.hasHeader=function(c){var a=null;for(var b=0;b<this.nameTable.length;b++){if(this.nameTable[b][0]==c.toLowerCase()){a=b}}if(a!=null){return true}else{return false}};SIPMessage.prototype.hasFromTag=function(){return this.fromHeader!=null&&this.fromHeader.getTag()!=null};SIPMessage.prototype.hasToTag=function(){return this.toHeader!=null&&this.toHeader.getTag()!=null};SIPMessage.prototype.getFromTag=function(){return this.fromHeader==null?null:this.fromHeader.getTag()};SIPMessage.prototype.setFromTag=function(a){this.fromHeader.setTag(a)};SIPMessage.prototype.setToTag=function(a){this.toHeader.setTag(a)};SIPMessage.prototype.getToTag=function(){return this.toHeader==null?null:this.toHeader.getTag()};SIPMessage.prototype.getFirstLine=function(){};SIPMessage.prototype.addHeader=function(){if(typeof arguments[0]!="object"){var f=arguments[0];var e=f.trim()+"\n";try{var a=new ParserFactory();var g=a.createParser(f);var d=g.parse();this.attachHeader(d,false)}catch(c){console.error("SIPMessage:addHeader(): catched exception:"+c);this.unrecognizedHeaders.push(e)}}else{f=arguments[0];try{if((f instanceof ViaList)||(f instanceof RecordRouteList)){this.attachHeader(f,false,true)}else{this.attachHeader(f,false,false)}}catch(c){console.error("SIPMessage:addHeader(): catched exception:"+c);if(f instanceof ContentLength){var b=f;this.contentLengthHeader.setContentLength(b.getContentLength())}}}};SIPMessage.prototype.addUnparsed=function(a){this.unrecognizedHeaders.push(a)};SIPMessage.prototype.getUnrecognizedHeaders=function(){return this.unrecognizedHeaders};SIPMessage.prototype.getHeaderNames=function(){var a=new Array();for(var c=0;c<this.headers.length;c++){var d=this.headers[c];var b=d.getName();a.push(b)}return a};SIPMessage.prototype.getContentDisposition=function(){return this.getHeaderLowerCase(this.CONTENT_DISPOSITION_LOWERCASE)};SIPMessage.prototype.getExpires=function(){return this.getHeaderLowerCase(this.EXPIRES_LOWERCASE)};SIPMessage.prototype.setExpires=function(a){this.setHeader(a)};SIPMessage.prototype.setContentDisposition=function(a){this.setHeader(a)};SIPMessage.prototype.setContentLength=function(a){this.contentLengthHeader.setContentLength(a.getContentLength())};SIPMessage.prototype.setSize=function(a){this.size=a};SIPMessage.prototype.getSize=function(){return this.size};SIPMessage.prototype.addLast=function(a){if(a==null){console.error("SIPMessage:addLast(): null header arg!");throw"SIPMessage:addLast(): null header arg!"}this.attachHeader(a,false,false)};SIPMessage.prototype.addFirst=function(a){if(a==null){console.error("SIPMessage:addFirst(): null header arg!");throw"SIPMessage:addFirst(): null header arg!"}this.attachHeader(a,false,true)};SIPMessage.prototype.removeFirst=function(a){if(a==null){console.error("SIPMessage:removeFirst(): null headerName arg!");throw"SIPMessage:removeFirst(): null headerName arg!"}this.removeHeader(a,true)};SIPMessage.prototype.removeLast=function(a){if(a==null){console.error("SIPMessage:removeLast(): null headerName arg!");throw"SIPMessage:removeLast(): null headerName arg!"}this.removeHeader(a,false)};SIPMessage.prototype.setCSeq=function(a){this.setHeader(a)};SIPMessage.prototype.setApplicationData=function(a){this.applicationData=a};SIPMessage.prototype.getApplicationData=function(){return this.applicationData};SIPMessage.prototype.getMultipartMimeContent=function(){var b=new MultipartMimeContentImpl(this.getContentTypeHeader());var c=this.getRawContent();var a=new String(c);b.createContentList(a);return b};SIPMessage.prototype.getCallIdHeader=function(){return this.callIdHeader};SIPMessage.prototype.getFromHeader=function(){return this.fromHeader};SIPMessage.prototype.getToHeader=function(){return this.toHeader};SIPMessage.prototype.getTopmostViaHeader=function(){return this.getTopmostVia()};SIPMessage.prototype.getCSeqHeader=function(){return this.cSeqHeader};SIPMessage.prototype.getCharset=function(){var a=this.getContentTypeHeader();if(a!=null){var b=a.getCharset();return b!=null?b:this.contentEncodingCharset}else{return this.contentEncodingCharset}};SIPMessage.prototype.isNullRequest=function(){return this.nullRequest};SIPMessage.prototype.setNullRequest=function(){this.nullRequest=true};SIPMessage.prototype.setSIPVersion=function(){};SIPMessage.prototype.getSIPVersion=function(){};SIPMessage.prototype.toString=function(){};SIPMessage.prototype.getBytes=function(b){var c=new Array();b=new String(b);for(var a=0;a<b.length;a++){c[a]=b.charCodeAt(a)}return c};SIPMessage.prototype.getStackTransaction=function(){return this.stackTransaction};SIPMessage.prototype.setStackTransaction=function(a){this.stackTransaction=a};SIPMessage.prototype.addViaHeaderList=function(e){var b=new Array();var d=0;for(var a=0;a<this.headers.length;a++){b[d]=this.headers[a];d=d+1;if((this.headers[a] instanceof ViaList)){if(a==this.headers.length-1||!(this.headers[a] instanceof ViaList)){b[d]=e;d=d+1}if(!(this.headers[a-1] instanceof ViaList)&&a!=0){var c=new Array();c[0]=this.headers[a].getName().toLowerCase();c[1]=this.headers[a];this.nameTable.push(c)}}}if(d==a){b[d]=e;c=new Array();c[0]=e.getName().toLowerCase();c[1]=e;this.nameTable.push(c)}this.headers=b};function MessageFactoryImpl(){this.classname="MessageFactoryImpl";this.defaultContentEncodingCharset="UTF-8";this.userAgent=null;this.server=null}MessageFactoryImpl.prototype.CONTENTTYPEHEADER="Content-Type";MessageFactoryImpl.prototype.createRequest=function(){if(arguments.length==1){var k=arguments[0];return this.createRequestPrototype3(k)}else{if(arguments.length==8){var d=arguments[0];var a=arguments[1];var e=arguments[2];var b=arguments[3];var g=arguments[4];var h=arguments[5];var j=arguments[6];var c=arguments[7];return this.createRequestPrototype1(d,a,e,b,g,h,j,c)}else{if(arguments.length==10){if(arguments[8].classname=="ContentType"){d=arguments[0];a=arguments[1];e=arguments[2];b=arguments[3];g=arguments[4];h=arguments[5];j=arguments[6];c=arguments[7];var i=arguments[8];var f=arguments[9];return this.createRequestPrototype2(d,a,e,b,g,h,j,c,i,f)}}}}};MessageFactoryImpl.prototype.createRequestPrototype1=function(d,a,e,b,g,h,i,c){if(d==null||a==null||e==null||b==null||g==null||h==null||i==null||c==null){console.error("MessageFactoryImpl:createRequestPrototype1(): some parameters are missing, unable to create the request");throw"MessageFactoryImpl:createRequestPrototype1(): some parameters are missing, unable to create the request"}var f=new SIPRequest();f.setRequestURI(d);f.setMethod(a);f.setCallId(e);f.setCSeq(b);f.setFrom(g);f.setTo(h);f.setVia(i);f.setMaxForwards(c);if(this.userAgent!=null){f.setHeader(this.userAgent)}return f};MessageFactoryImpl.prototype.createRequestPrototype2=function(d,a,e,b,h,i,k,c,j,f){if(d==null||a==null||e==null||b==null||h==null||i==null||k==null||c==null||f==null||j==null){console.error("MessageFactoryImpl:createRequestPrototype2(): some parameters are missing, unable to create the request");throw"MessageFactoryImpl:createRequestPrototype2(): some parameters are missing, unable to create the request"}var g=new SIPRequest();g.setRequestURI(d);g.setMethod(a);g.setCallId(e);g.setCSeq(b);g.setFrom(h);g.setTo(i);g.setVia(k);g.setMaxForwards(c);g.setContent(f,j);if(this.userAgent!=null){g.setHeader(this.userAgent)}return g};MessageFactoryImpl.prototype.createRequestPrototype3=function(b){if(b==null||b.equals("")){var a=new SIPRequest();a.setNullRequest();return a}var d=new StringMsgParser();d.setStrict(this.strict);var c=d.parseSIPMessage(b);if(!(c instanceof SIPRequest)){console.error("MessageFactoryImpl:createRequestPrototype3(): parsing error");throw"MessageFactoryImpl:createRequestPrototype3(): parsing error"}return c};MessageFactoryImpl.prototype.createResponse=function(){if(arguments.length==1){var f=arguments[0];return this.createReponsePrototype9(f)}else{if(arguments.length==2){var d=arguments[0];var c=arguments[1];return this.createReponsePrototype6(d,c)}else{if(arguments.length==4){if(arguments[3].constructor!=Array){d=arguments[0];c=arguments[1];var j=arguments[2];var g=arguments[3];return this.createReponsePrototype4(d,c,j,g)}else{if(arguments[3].constructor==Array){d=arguments[0];c=arguments[1];j=arguments[2];g=arguments[3];return this.createReponsePrototype5(d,c,j,g)}}}else{if(arguments.length==7){d=arguments[0];var e=arguments[1];var a=arguments[2];var i=arguments[3];var h=arguments[4];var k=arguments[5];var b=arguments[6];return this.createReponsePrototype3(d,e,a,i,h,k,b)}else{if(arguments.length==9){if(arguments[8].classname=="ContentType"){if(arguments[7].constructor!=Array){d=arguments[0];e=arguments[1];a=arguments[2];i=arguments[3];h=arguments[4];k=arguments[5];b=arguments[6];g=arguments[7];j=arguments[8];return this.createReponsePrototype1(d,e,a,i,h,k,b,g,j)}else{if(arguments[7].constructor==Array){d=arguments[0];e=arguments[1];a=arguments[2];i=arguments[3];h=arguments[4];k=arguments[5];b=arguments[6];g=arguments[7];j=arguments[8];return this.createReponsePrototype2(d,e,a,i,h,k,b,g,j)}}}else{if(arguments[8].classname!="ContentType"){if(arguments[7].constructor!=Array){d=arguments[0];e=arguments[1];a=arguments[2];i=arguments[3];h=arguments[4];k=arguments[5];b=arguments[6];j=arguments[7];g=arguments[8];return this.createReponsePrototype7(d,e,a,i,h,k,b,j,g)}else{if(arguments[7].constructor==Array){d=arguments[0];e=arguments[1];a=arguments[2];i=arguments[3];h=arguments[4];k=arguments[5];b=arguments[6];j=arguments[7];g=arguments[8];return this.createReponsePrototype8(d,e,a,i,h,k,b,j,g)}}}}}}}}}};MessageFactoryImpl.prototype.createReponsePrototype1=function(e,f,a,i,j,l,d,h,k){if(f==null||a==null||i==null||j==null||l==null||d==null||h==null||k==null){console.error("MessageFactoryImpl:createReponsePrototype1(): some parameters are missing, unable to create the response");throw"MessageFactoryImpl:createReponsePrototype1(): some parameters are missing, unable to create the response"}var g=new SIPResponse();var c=new StatusLine();c.setStatusCode(e);var b=g.getReasonPhrase(e);c.setReasonPhrase(b);g.setStatusLine(c);g.setCallId(f);g.setCSeq(a);g.setFrom(i);g.setTo(j);g.setVia(l);g.setMaxForwards(d);g.setContent(h,k);if(this.userAgent!=null){g.setHeader(this.userAgent)}return g};MessageFactoryImpl.prototype.createReponsePrototype2=function(c,d,a,g,h,j,b,f,i){if(d==null||a==null||g==null||h==null||j==null||b==null||f==null||i==null){console.error("MessageFactoryImpl:createReponsePrototype2(): some parameters are missing, unable to create the response");throw"MessageFactoryImpl:createReponsePrototype2(): some parameters are missing, unable to create the response"}var e=new SIPResponse();e.setStatusCode(c);e.setCallId(d);e.setCSeq(a);e.setFrom(g);e.setTo(h);e.setVia(j);e.setMaxForwards(b);e.setHeader(i);e.setMessageContent(f);if(this.userAgent!=null){e.setHeader(this.userAgent)}return e};MessageFactoryImpl.prototype.createReponsePrototype3=function(d,c,e,h,g,a,b){if(c==null||e==null||h==null||g==null||a==null||b==null){console.error("MessageFactoryImpl:createReponsePrototype3(): some parameters are missing, unable to create the response");throw"MessageFactoryImpl:createReponsePrototype3(): some parameters are missing, unable to create the response"}var f=new SIPResponse();f.setStatusCode(d);f.setCallId(c);f.setCSeq(e);f.setFrom(h);f.setTo(g);f.setVia(a);f.setMaxForwards(b);if(this.userAgent!=null){f.setHeader(this.userAgent)}return f};MessageFactoryImpl.prototype.createReponsePrototype4=function(a,d,f,c){if(d==null||c==null||f==null){console.error("MessageFactoryImpl:createReponsePrototype4(): some parameters are missing, unable to create the response");throw"MessageFactoryImpl:createReponsePrototype4(): some parameters are missing, unable to create the response"}var b=d;var e=b.createResponse(a);e.setContent(c,f);if(this.server!=null){e.setHeader(this.server)}return e};MessageFactoryImpl.prototype.createReponsePrototype5=function(a,d,f,c){if(d==null||c==null||f==null){console.error("MessageFactoryImpl:createReponsePrototype5(): some parameters are missing, unable to create the response");throw"MessageFactoryImpl:createReponsePrototype5(): some parameters are missing, unable to create the response"}var b=d;var e=b.createResponse(a);e.setHeader(f);e.setMessageContent(c);if(this.server!=null){e.setHeader(this.server)}return e};MessageFactoryImpl.prototype.createReponsePrototype6=function(a,c){if(c==null){console.error("MessageFactoryImpl:createReponsePrototype6(): some parameters are missing, unable to create the response");throw"MessageFactoryImpl:createReponsePrototype6(): ome parameters are missing, unable to create the response"}var b=c;var d=b.createResponse(a);d.removeContent();d.removeHeader(this.CONTENTTYPEHEADER);if(this.server!=null){d.setHeader(this.server)}return d};MessageFactoryImpl.prototype.createReponsePrototype7=function(d,f,a,i,j,l,c,k,h){if(f==null||a==null||i==null||j==null||l==null||c==null||h==null||k==null){console.error("MessageFactoryImpl:createReponsePrototype7(): some parameters are missing, unable to create the response");throw"MessageFactoryImpl:createReponsePrototype7(): some parameters are missing, unable to create the response"}var g=new SIPResponse();var b=new StatusLine();b.setStatusCode(d);var e=g.getReasonPhrase(d);if(e==null){console.error("MessageFactoryImpl:createReponsePrototype7(): unknown statusCode "+d);throw"MessageFactoryImpl:createReponsePrototype7(): unknown statusCode "+d}b.setReasonPhrase(e);g.setStatusLine(b);g.setCallId(f);g.setCSeq(a);g.setFrom(i);g.setTo(j);g.setVia(l);g.setContent(h,k);if(this.userAgent!=null){g.setHeader(this.userAgent)}return g};MessageFactoryImpl.prototype.createReponsePrototype8=function(d,f,a,i,j,l,c,k,h){if(f==null||a==null||i==null||j==null||l==null||c==null||h==null||k==null){console.error("MessageFactoryImpl:createReponsePrototype8(): some parameters are missing, unable to create the response");throw"MessageFactoryImpl:createReponsePrototype8(): some parameters are missing, unable to create the response"}var g=new SIPResponse();var b=new StatusLine();b.setStatusCode(d);var e=g.getReasonPhrase(d);if(e==null){console.error("MessageFactoryImpl:createReponsePrototype8(): unknown statusCode "+d);throw"MessageFactoryImpl:createReponsePrototype8(): unknown statusCode "+d}b.setReasonPhrase(e);g.setStatusLine(b);g.setCallId(f);g.setCSeq(a);g.setFrom(i);g.setTo(j);g.setVia(l);g.setContent(h,k);if(this.userAgent!=null){g.setHeader(this.userAgent)}return g};MessageFactoryImpl.prototype.createReponsePrototype9=function(a){if(a==null){return new SIPResponse()}var c=new StringMsgParser();var b=c.parseSIPMessage(a);if(!(b instanceof SIPResponse)){console.error("MessageFactoryImpl:createReponsePrototype9(): parse error");throw"MessageFactoryImpl:createReponsePrototype9(): parse error"}return b};MessageFactoryImpl.prototype.setDefaultUserAgentHeader=function(a){this.userAgent=a};MessageFactoryImpl.prototype.setDefaultServerHeader=function(a){this.server=a};MessageFactoryImpl.prototype.getDefaultUserAgentHeader=function(){return this.userAgent};MessageFactoryImpl.prototype.getDefaultServerHeader=function(){return this.server};MessageFactoryImpl.prototype.setDefaultContentEncodingCharset=function(a){if(a==null){throw new NullPointerException("Null argument!")}this.defaultContentEncodingCharset=a};MessageFactoryImpl.prototype.getDefaultContentEncodingCharset=function(){return this.defaultContentEncodingCharset};MessageFactoryImpl.prototype.createMultipartMimeContent=function(c,h,j,f){var b=c.getParameter("boundary");var a=new MultipartMimeContentImpl(c);for(var d=0;d<h.length;d++){var e=new ContentType(h[d],j[d]);var g=new ContentImpl(f[d],b);g.setContentTypeHeader(e);a.add(g)}return a};MessageFactoryImpl.prototype.getBytes=function(b){var c=new Array();b=new String(b);for(var a=0;a<b.length;a++){c[a]=b.charCodeAt(a)}return c};MessageFactoryImpl.prototype.addHeader=function(a,b){a.addHeader(b);return a};function SIPRequest(){this.classname="SIPRequest";this.transactionPointer=null;this.requestLine=new RequestLine();this.messageChannel=null;this.inviteTransaction=null;this.unrecognizedHeaders=new Array();this.headers=new Array();this.nameTable=new Array();this.attachHeader(new ContentLength(0),false)}SIPRequest.prototype=new SIPMessage();SIPRequest.prototype.constructor=SIPRequest;SIPRequest.prototype.DEFAULT_USER="ip";SIPRequest.prototype.DEFAULT_TRANSPORT="tcp";SIPRequest.prototype.INVITE="INVITE";SIPRequest.prototype.BYE="BYE";SIPRequest.prototype.CANCEL="CANCEL";SIPRequest.prototype.ACK="ACK";SIPRequest.prototype.PRACK="PRACK";SIPRequest.prototype.INFO="INFO";SIPRequest.prototype.MESSAGE="MESSAGE";SIPRequest.prototype.NOTIFY="NOTIFY";SIPRequest.prototype.OPTIONS="OPTIONS";SIPRequest.prototype.PUBLISH="PUBLISH";SIPRequest.prototype.REFER="REFER";SIPRequest.prototype.REGISTER="REGISTER";SIPRequest.prototype.SUBSCRIBE="SUBSCRIBE";SIPRequest.prototype.UPDATE="UPDATE";SIPRequest.prototype.CSeqHeader="CSeq";SIPRequest.prototype.ToHeader="To";SIPRequest.prototype.CallIdHeader="Call-ID";SIPRequest.prototype.FromHeader="From";SIPRequest.prototype.ViaHeader="Via";SIPRequest.prototype.MaxForwardsHeader="Max-Forwards";SIPRequest.prototype.EventHeader="Event";SIPRequest.prototype.ContactHeader="Contact";SIPRequest.prototype.COLON=":";SIPRequest.prototype.targetRefreshMethods=new Array(SIPRequest.prototype.INVITE,SIPRequest.prototype.UPDATE,SIPRequest.prototype.SUBSCRIBE,SIPRequest.prototype.NOTIFY,SIPRequest.prototype.REFER);SIPRequest.prototype.canonicalRequestNameTable=new Array(SIPRequest.prototype.INVITE,SIPRequest.prototype.BYE,SIPRequest.prototype.CANCEL,SIPRequest.prototype.ACK,SIPRequest.prototype.PRACK,SIPRequest.prototype.INFO,SIPRequest.prototype.MESSAGE,SIPRequest.prototype.NOTIFY,SIPRequest.prototype.OPTIONS,SIPRequest.prototype.PRACK,SIPRequest.prototype.PUBLISH,SIPRequest.prototype.REFER,SIPRequest.prototype.REGISTER,SIPRequest.prototype.SUBSCRIBE,SIPRequest.prototype.UPDATE);SIPRequest.prototype.isTargetRefresh=function(b){for(var a=0;a<SIPRequest.prototype.targetRefreshMethods;a++){if(SIPRequest.prototype.targetRefreshMethods[a]==b){return true}}return false};SIPRequest.prototype.isDialogCreating=function(a){return SIPTransactionStack.prototype.isDialogCreated(a)};SIPRequest.prototype.getCannonicalName=function(b){for(var a=0;a<this.canonicalRequestNameTable;a++){if(this.canonicalRequestNameTable[a]==b){return b}}return b};SIPRequest.prototype.getRequestLine=function(){return this.requestLine};SIPRequest.prototype.setRequestLine=function(a){this.requestLine=a};SIPRequest.prototype.checkHeaders=function(){var c="Missing a required header : ";if(this.getCSeq()==null){console.error("SIPRequest:checkHeaders(): "+c+this.CSeqHeader);throw"SIPRequest:checkHeaders(): "+c+this.CSeqHeader}if(this.getTo()==null){console.error("SIPRequest:checkHeaders(): "+c+this.ToHeader);throw"SIPRequest:checkHeaders(): "+c+this.ToHeader}if(this.callIdHeader==null||this.callIdHeader.getCallId()==null||this.callIdHeader.getCallId()==""){console.error("SIPRequest:checkHeaders(): "+c+this.CallIdHeader);throw"SIPRequest:checkHeaders(): "+c+this.CallIdHeader}if(this.getFrom()==null){console.error("SIPRequest:checkHeaders(): "+c+this.FromHeader);throw"SIPRequest:checkHeaders(): "+c+this.FromHeader}if(this.getViaHeaders()==null){console.error("SIPRequest:checkHeaders(): "+c+this.ViaHeader);throw"SIPRequest:checkHeaders(): "+c+this.ViaHeader}if(this.getMaxForwards()==null){console.error("SIPRequest:checkHeaders(): "+c+this.MaxForwardsHeader);throw"SIPRequest:checkHeaders(): "+c+this.MaxForwardsHeader}if(this.getTopmostVia()==null){console.error("SIPRequest:checkHeaders(): no via header in request!");throw"SIPRequest:checkHeaders():  no via header in request!"}if(this.getMethod()==this.NOTIFY){if(this.getHeader(this.EventHeader)==null){console.error("SIPRequest:checkHeaders(): "+c+this.EventHeader);throw"SIPRequest:checkHeaders(): "+c+this.EventHeader}}else{if(this.getMethod()==this.PUBLISH){if(this.getHeader(this.EventHeader)==null){console.error("SIPRequest:checkHeaders(): "+c+this.EventHeader);throw"SIPRequest:checkHeaders(): "+c+this.EventHeader}}}if(this.requestLine.getMethod()==this.INVITE||this.requestLine.getMethod()==this.SUBSCRIBE||this.requestLine.getMethod()==this.REFER){if(this.getContactHeader()==null){if(this.getToTag()==null){console.error("SIPRequest:checkHeaders(): "+c+this.ContactHeader);throw"SIPRequest:checkHeaders(): "+c+this.ContactHeader}}if(this.requestLine.getUri() instanceof SipUri){var a=(this.requestLine.getUri()).getScheme();if("sips"==a.toLowerCase()){var b=this.getContactHeader().getAddress().getURI();if(b.getScheme()!="sips"){console.error("SIPRequest:checkHeaders(): scheme for contact should be sips:"+b);throw"SIPRequest:checkHeaders(): scheme for contact should be sips:"+b}}}}if(this.getContactHeader()==null&&(this.getMethod()==this.INVITE||this.getMethod()==this.REFER||this.getMethod()==this.SUBSCRIBE)){console.error("SIPRequest:checkHeaders(): Contact Header is Mandatory for a SIP INVITE");throw"SIPRequest:checkHeaders(): Scheme for contact should be sips:"+b}if(this.requestLine!=null&&this.requestLine.getMethod()!=null&&this.getCSeq().getMethod()!=null&&this.requestLine.getMethod()!=this.getCSeq().getMethod()){console.error("SIPRequest:checkHeaders(): CSEQ method mismatch with  Request-Line");throw"SIPRequest:checkHeaders(): CSEQ method mismatch with  Request-Line"}};SIPRequest.prototype.setDefaults=function(){if(this.requestLine==null){return}var c=this.requestLine.getMethod();if(c==null){return}var a=this.requestLine.getUri();if(a==null){return}if(c==this.REGISTER||c==this.INVITE){if(a instanceof SipUri){var b=a;b.setUserParam(this.DEFAULT_USER);b.setTransportParam(this.DEFAULT_TRANSPORT)}}};SIPRequest.prototype.setRequestLineDefaults=function(){var b=this.requestLine.getMethod();if(b==null){var a=this.getCSeq();if(a!=null){b=this.getCannonicalName(a.getMethod());this.requestLine.setMethod(b)}}};SIPRequest.prototype.getRequestURI=function(){if(this.requestLine==null){return null}else{return this.requestLine.getUri()}};SIPRequest.prototype.setRequestURI=function(a){if(a==null){console.error("SIPRequest:setRequestURI(): null request URI");throw"SIPRequest:setRequestURI(): null request URI"}if(this.requestLine==null){this.requestLine=new RequestLine()}this.requestLine.setUri(a);this.nullRequest=false};SIPRequest.prototype.setMethod=function(b){if(b==null){console.error("SIPRequest:setMethod(): null method");throw"SIPRequest:setMethod(): null method"}if(this.requestLine==null){this.requestLine=new RequestLine()}var a=this.getCannonicalName(b);this.requestLine.setMethod(a);if(this.cSeqHeader!=null){this.cSeqHeader.setMethod(a)}};SIPRequest.prototype.getMethod=function(){if(this.requestLine==null){return null}else{return this.requestLine.getMethod()}};SIPRequest.prototype.encode=function(){var a=null;if(this.requestLine!=null){this.setRequestLineDefaults();a=this.requestLine.encode()+this.superencode()}else{if(this.isNullRequest()){a="\r\n\r\n"}else{a=this.superencode()}}return a};SIPRequest.prototype.encodeMessage=function(){var a;if(this.requestLine!=null){this.setRequestLineDefaults();a=this.requestLine.encode()+this.encodeSIPHeaders()}else{if(this.isNullRequest()){a="\r\n\r\n"}else{a=this.encodeSIPHeaders()}}return a};SIPRequest.prototype.toString=function(){return this.encode()};SIPRequest.prototype.superencode=function(){var f="";for(var b=0;b<this.headers.length;b++){var a=this.headers[b];if(!(a instanceof ContentLength)){f=f+a.encode()}}for(b=0;b<this.unrecognizedHeaders.length;b++){var d=this.unrecognizedHeaders[b];f=f+d+this.NEWLINE}f=f+this.contentLengthHeader.encode()+this.NEWLINE;if(this.messageContentObject!=null){var c=this.getContent().toString();f=f+c}else{if(this.messageContent!=null||this.messageContentBytes!=null){var e="";if(this.messageContent!=null){e=this.messageContent}else{for(b=0;b<this.messageContentBytes.length;b++){e=e+this.messageContentBytes[b]}}f=f+e}}return f.toString()};SIPRequest.prototype.getMessageAsEncodedStrings=function(){var a=Object.getPrototypeOf(this).getMessageAsEncodedStrings();if(this.requestLine!=null){this.setRequestLineDefaults();a.addFirst(this.requestLine.encode())}return a};SIPRequest.prototype.getDialogId=function(){if(arguments.length==1){var a=arguments[0];return this.getDialogIdargu1(a)}else{if(arguments.length==2){a=arguments[0];var b=arguments[1];return this.getDialogIdargu2(a,b)}}};SIPRequest.prototype.getDialogIdargu1=function(b){var e=this.getCallId();var a=e.getCallId();var d=this.getFrom();var c=this.getTo();if(!b){if(d.getTag()!=null){a=a+this.COLON+d.getTag()}if(c.getTag()!=null){a=a+this.COLON+c.getTag()}}else{if(c.getTag()!=null){a=a+this.COLON+c.getTag()}if(d.getTag()!=null){a=a+this.COLON+d.getTag()}}return a.toString().toLowerCase()};SIPRequest.prototype.getDialogIdargu2=function(b,c){var e=this.getFrom();var d=this.getCallId();var a=d.getCallId();if(!b){if(e.getTag()!=null){a=a+this.COLON+e.getTag()}if(c!=null){a=a+this.COLON+c}}else{if(c!=null){a=a+this.COLON+c}if(e.getTag()!=null){a=a+this.COLON+e.getTag()}}return a.toString().toLowerCase()};SIPRequest.prototype.createResponse=function(){if(arguments.length==1){var c=arguments[0];return this.createResponseargu1(c)}else{if(arguments.length==2){c=arguments[0];var d=arguments[1];return this.createResponseargu2(c,d)}else{if(arguments.length==3){c=arguments[0];d=arguments[1];var b=arguments[2];var a=this.createResponseargu2(c,d);return this.createResponseargu3(a,b)}}}};SIPRequest.prototype.createResponseargu1=function(a){var c=new SIPResponse();var b=c.getReasonPhrase(a);return this.createResponseargu2(a,b)};SIPRequest.prototype.createResponseargu2=function(d,b){var c=new SIPResponse();var f=null;var j=null;try{c.setStatusCode(d)}catch(g){console.error("SIPRequest:createResponseargu2(): bad code "+d);throw"SIPRequest:createResponseargu2(): bad code "+d}if(b!=null){c.setReasonPhrase(b)}else{var h=new SIPResponse();c.setReasonPhrase(h.getReasonPhrase(d))}f=this.getHeaders();for(var e=0;e<f.length;e++){j=f[e];if(j instanceof To){if(!j.hasTag()){var a=new Date();var k=a.getTime();j.setTag(k)}}if(j instanceof ViaList){c.addViaHeaderList(j)}else{if(!(j instanceof ContactList)&&!(j instanceof UserAgent)){if(c.getStatusCode()==200){c.attachHeader(j,false)}else{if(!(j instanceof ContentLength)&&!(j instanceof ContentType)){c.attachHeader(j,false)}}}}}if(this.getMessageContent()!=null&&c.getStatusCode()==200){c.setMessageContent(this.getMessageContent())}if(MessageFactoryImpl.prototype.getDefaultServerHeader()!=null){c.setHeader(MessageFactoryImpl.prototype.getDefaultServerHeader())}if(c.getStatusCode()==100){c.getTo().removeParameter("tag")}if(c.getStatusCode()==480&&c.getHeaders("recordroute")!=null){c.removeHeader("record-route")}return c};SIPRequest.prototype.createResponseargu3=function(b,a){b.addContactUseragent(a);return b};SIPRequest.prototype.mustCopyRR=function(a){if(a>100&&a<300){return this.isDialogCreating(this.getMethod())&&this.getToTag()==null}else{return false}};SIPRequest.prototype.createCancelRequest=function(){if(this.getMethod()!=this.INVITE){console.error("SIPRequest:createCancelRequest(): Attempt to create CANCEL for "+this.getMethod());throw"SIPRequest:createCancelRequest(): Attempt to create CANCEL for "+this.getMethod()}var a=new SIPRequest();a.setRequestLine(this.requestLine);a.setMethod(this.CANCEL);a.setHeader(this.callIdHeader);a.setHeader(this.toHeader);a.setHeader(this.cSeqHeader);a.getCSeq().setMethod(this.CANCEL);a.setHeader(this.fromHeader);a.addFirst(this.getTopmostVia());a.setHeader(this.maxForwardsHeader);if(this.getRouteHeaders()!=null){a.setHeader(this.getRouteHeaders())}if(MessageFactoryImpl.prototype.getDefaultUserAgentHeader()!=null){a.setHeader(MessageFactoryImpl.prototype.getDefaultUserAgentHeader())}return a};SIPRequest.prototype.createAckRequest=function(){if(arguments.length==1){var a=arguments[0];return this.createAckRequest_argu1(a)}else{return this.createACKRequest_argu0()}};SIPRequest.prototype.createAckRequest_argu1=function(e){var a=new SIPRequest();var d=null;a.setRequestLine(this.requestLine);a.setMethod(this.ACK);var f=this.getHeaders();for(var c=0;c<f.length;c++){d=f[c];if(d instanceof RouteList){continue}else{if(d instanceof ProxyAuthorization){continue}else{if(d instanceof ContentLength){d.setContentLength(0)}else{if(d instanceof ContentType){continue}else{if(d instanceof CSeq){var b=d;b.setMethod(this.ACK);d=b}else{if(d instanceof To){if(e!=null){d=e}else{d=d}}else{if(d instanceof ContactList||d instanceof Expires){continue}else{if(d instanceof ViaList){d=d.getFirst()}else{d=d}}}}}}}}a.attachHeader(d,false)}if(MessageFactoryImpl.prototype.getDefaultUserAgentHeader()!=null){a.setHeader(MessageFactoryImpl.prototype.getDefaultUserAgentHeader())}return a};SIPRequest.prototype.createErrorAck=function(d){var a=new SIPRequest();var b=new RequestLine();b.setMethod(this.ACK);b.setUri(this.requestLine.getUri());var c=new CSeq();c.setMethod(this.ACK);c.setSeqNumber(this.cSeqHeader.getSequenceNumber());a.setRequestLine(b);a.setMethod(this.ACK);a.setHeader(this.callIdHeader);a.setHeader(this.maxForwardsHeader);a.setHeader(this.fromHeader);a.setHeader(d);a.addFirst(this.getTopmostVia());a.setHeader(c);if(this.getRouteHeaders()!=null){a.setHeader(this.getRouteHeaders())}if(MessageFactoryImpl.prototype.getDefaultUserAgentHeader()!=null){a.setHeader(MessageFactoryImpl.prototype.getDefaultUserAgentHeader())}return a};SIPRequest.prototype.createSIPRequest=function(l,b){var c=new SIPRequest();c.requestLine=l;var d=this.getHeaders();var e=null;var n=null;for(var a=0;a<d.length;a++){var p=d[a];if(p instanceof CSeq){var g=p;p=g;g.setMethod(l.getMethod())}else{if(p.classname=="ViaList"){var m=p.getFirst();p=m}else{if(p instanceof To){var j=p;if(b){p=new From(j)}else{p=j}}else{if(p instanceof From){var h=p;if(b){p=new To(h)}else{p=h}}else{if(p instanceof ContentLength){var k=p;k.setContentLength(0);p=k}else{if(!(p instanceof CallID)&&!(p instanceof MaxForwards)&&!(p instanceof Expires)&&!(p instanceof UserAgent)&&!(p instanceof AllowList)&&!(p instanceof ContactList)){continue}}}}}}c.attachHeader(p,false)}if(MessageFactoryImpl.prototype.getDefaultUserAgentHeader()!=null){c.setHeader(MessageFactoryImpl.prototype.getDefaultUserAgentHeader())}return c};SIPRequest.prototype.createBYERequest=function(a){var b=this.requestLine;this.requestLine.setMethod("BYE");return this.createSIPRequest(b,a)};SIPRequest.prototype.createACKRequest_argu0=function(){var a=this.requestLine;this.requestLine.setMethod(this.ACK);return this.createSIPRequest(a,false)};SIPRequest.prototype.getViaHost=function(){var a=this.getViaHeaders().getFirst();return a.getHost()};SIPRequest.prototype.getViaPort=function(){var a=this.getViaHeaders().getFirst();if(a.hasPort()){return a.getPort()}else{return 5060}};SIPRequest.prototype.getFirstLine=function(){if(this.requestLine==null){return null}else{return this.requestLine.encode()}};SIPRequest.prototype.setSIPVersion=function(a){if(a==null||(a.toLowerCase()!=("SIP/2.0").toLowerCase())){console.error("SIPRequest:setSIPVersion(): bad sipVersion",0);throw"SIPRequest:setSIPVersion(): bad sipVersion"}this.requestLine.setSipVersion(a)};SIPRequest.prototype.getSIPVersion=function(){return this.requestLine.getSipVersion()};SIPRequest.prototype.getTransaction=function(){return this.transactionPointer};SIPRequest.prototype.setTransaction=function(a){this.transactionPointer=a};SIPRequest.prototype.getMessageChannel=function(){return this.messageChannel};SIPRequest.prototype.setMessageChannel=function(a){this.messageChannel=a};SIPRequest.prototype.getMergeId=function(){var d=this.getFromTag();var b=this.cSeqHeader.toString();var c=this.callIdHeader.getCallId();var e=this.getRequestURI().toString();if(d!=null){var a="";a=(a+e+":"+d+":"+b+":"+c).toString();return a}else{return null}};SIPRequest.prototype.setInviteTransaction=function(a){this.inviteTransaction=a};SIPRequest.prototype.getInviteTransaction=function(){return this.inviteTransaction};SIPRequest.prototype.fortest=function(){var b=this.requestLine.encode();for(var d=0;d<this.headers.length;d++){var c=this.headers[d];if(!(c instanceof ContentLength)){var a=c.encode();b=b+a}}return b};function SIPResponse(){this.classname="SIPResponse";this.statusLine=new StatusLine();this.nameTable=new Array();this.unrecognizedHeaders=new Array();this.headers=new Array();this.attachHeader(new ContentLength(0),false)}SIPResponse.prototype=new SIPMessage();SIPResponse.prototype.constructor=SIPResponse;SIPResponse.prototype.TRYING=100;SIPResponse.prototype.RINGING=180;SIPResponse.prototype.CALL_IS_BEING_FORWARDED=181;SIPResponse.prototype.QUEUED=182;SIPResponse.prototype.SESSION_PROGRESS=183;SIPResponse.prototype.OK=200;SIPResponse.prototype.ACCEPTED=202;SIPResponse.prototype.MULTIPLE_CHOICES=300;SIPResponse.prototype.MOVED_PERMANENTLY=301;SIPResponse.prototype.MOVED_TEMPORARILY=302;SIPResponse.prototype.USE_PROXY=305;SIPResponse.prototype.ALTERNATIVE_SERVICE=380;SIPResponse.prototype.BAD_REQUEST=400;SIPResponse.prototype.UNAUTHORIZED=401;SIPResponse.prototype.PAYMENT_REQUIRED=402;SIPResponse.prototype.FORBIDDEN=403;SIPResponse.prototype.NOT_FOUND=404;SIPResponse.prototype.METHOD_NOT_ALLOWED=405;SIPResponse.prototype.NOT_ACCEPTABLE=406;SIPResponse.prototype.PROXY_AUTHENTICATION_REQUIRED=407;SIPResponse.prototype.REQUEST_TIMEOUT=408;SIPResponse.prototype.GONE=410;SIPResponse.prototype.TEMPORARILY_UNAVAILABLE=480;SIPResponse.prototype.REQUEST_ENTITY_TOO_LARGE=413;SIPResponse.prototype.REQUEST_URI_TOO_LONG=414;SIPResponse.prototype.UNSUPPORTED_MEDIA_TYPE=415;SIPResponse.prototype.UNSUPPORTED_URI_SCHEME=416;SIPResponse.prototype.BAD_EXTENSION=420;SIPResponse.prototype.EXTENSION_REQUIRED=421;SIPResponse.prototype.INTERVAL_TOO_BRIEF=423;SIPResponse.prototype.CALL_OR_TRANSACTION_DOES_NOT_EXIST=481;SIPResponse.prototype.LOOP_DETECTED=482;SIPResponse.prototype.TOO_MANY_HOPS=483;SIPResponse.prototype.ADDRESS_INCOMPLETE=484;SIPResponse.prototype.AMBIGUOUS=485;SIPResponse.prototype.BUSY_HERE=486;SIPResponse.prototype.REQUEST_TERMINATED=487;SIPResponse.prototype.NOT_ACCEPTABLE_HERE=488;SIPResponse.prototype.BAD_EVENT=489;SIPResponse.prototype.REQUEST_PENDING=491;SIPResponse.prototype.SERVER_INTERNAL_ERROR=500;SIPResponse.prototype.UNDECIPHERABLE=493;SIPResponse.prototype.NOT_IMPLEMENTED=501;SIPResponse.prototype.BAD_GATEWAY=502;SIPResponse.prototype.SERVICE_UNAVAILABLE=503;SIPResponse.prototype.SERVER_TIMEOUT=504;SIPResponse.prototype.VERSION_NOT_SUPPORTED=505;SIPResponse.prototype.MESSAGE_TOO_LARGE=513;SIPResponse.prototype.BUSY_EVERYWHERE=600;SIPResponse.prototype.DECLINE=603;SIPResponse.prototype.DOES_NOT_EXIST_ANYWHERE=604;SIPResponse.prototype.SESSION_NOT_ACCEPTABLE=606;SIPResponse.prototype.CONDITIONAL_REQUEST_FAILED=412;SIPResponse.prototype.CSeq="CSeq";SIPResponse.prototype.To="To";SIPResponse.prototype.From="From";SIPResponse.prototype.Via="Via";SIPResponse.prototype.CallID="Call-ID";SIPResponse.prototype.COLON=":";SIPResponse.prototype.CANCEL="CANCEL";SIPResponse.prototype.ACK="ACK";SIPResponse.prototype.getReasonPhrase=function(){if(arguments.length==1){var a=arguments[0];return this.getReasonPhrase_argu1(a)}else{return this.getReasonPhrase_argu0()}};SIPResponse.prototype.getReasonPhrase_argu1=function(b){var a=null;switch(b){case this.TRYING:a="Trying";break;case this.RINGING:a="Ringing";break;case this.CALL_IS_BEING_FORWARDED:a="Call is being forwarded";break;case this.QUEUED:a="Queued";break;case this.SESSION_PROGRESS:a="Session progress";break;case this.OK:a="OK";break;case this.ACCEPTED:a="Accepted";break;case this.MULTIPLE_CHOICES:a="Multiple choices";break;case this.MOVED_PERMANENTLY:a="Moved permanently";break;case this.MOVED_TEMPORARILY:a="Moved Temporarily";break;case this.USE_PROXY:a="Use proxy";break;case this.ALTERNATIVE_SERVICE:a="Alternative service";break;case this.BAD_REQUEST:a="Bad request";break;case this.UNAUTHORIZED:a="Unauthorized";break;case this.PAYMENT_REQUIRED:a="Payment required";break;case this.FORBIDDEN:a="Forbidden";break;case this.NOT_FOUND:a="Not found";break;case this.METHOD_NOT_ALLOWED:a="Method not allowed";break;case this.NOT_ACCEPTABLE:a="Not acceptable";break;case this.PROXY_AUTHENTICATION_REQUIRED:a="Proxy Authentication required";break;case this.REQUEST_TIMEOUT:a="Request timeout";break;case this.GONE:a="Gone";break;case this.TEMPORARILY_UNAVAILABLE:a="Temporarily Unavailable";break;case this.REQUEST_ENTITY_TOO_LARGE:a="Request entity too large";break;case this.REQUEST_URI_TOO_LONG:a="Request-URI too large";break;case this.UNSUPPORTED_MEDIA_TYPE:a="Unsupported media type";break;case this.UNSUPPORTED_URI_SCHEME:a="Unsupported URI Scheme";break;case this.BAD_EXTENSION:a="Bad extension";break;case this.EXTENSION_REQUIRED:a="Etension Required";break;case this.INTERVAL_TOO_BRIEF:a="Interval too brief";break;case this.CALL_OR_TRANSACTION_DOES_NOT_EXIST:a="Call leg/Transaction does not exist";break;case this.LOOP_DETECTED:a="Loop detected";break;case this.TOO_MANY_HOPS:a="Too many hops";break;case this.ADDRESS_INCOMPLETE:a="Address incomplete";break;case this.AMBIGUOUS:a="Ambiguous";break;case this.BUSY_HERE:a="Busy here";break;case this.REQUEST_TERMINATED:a="Request Terminated";break;case this.NOT_ACCEPTABLE_HERE:a="Not Acceptable here";break;case this.BAD_EVENT:a="Bad Event";break;case this.REQUEST_PENDING:a="Request Pending";break;case this.SERVER_INTERNAL_ERROR:a="Server Internal Error";break;case this.UNDECIPHERABLE:a="Undecipherable";break;case this.NOT_IMPLEMENTED:a="Not implemented";break;case this.BAD_GATEWAY:a="Bad gateway";break;case this.SERVICE_UNAVAILABLE:a="Service unavailable";break;case this.SERVER_TIMEOUT:a="Gateway timeout";break;case this.VERSION_NOT_SUPPORTED:a="SIP version not supported";break;case this.MESSAGE_TOO_LARGE:a="Message Too Large";break;case this.BUSY_EVERYWHERE:a="Busy everywhere";break;case this.DECLINE:a="Decline";break;case this.DOES_NOT_EXIST_ANYWHERE:a="Does not exist anywhere";break;case this.SESSION_NOT_ACCEPTABLE:a="Session Not acceptable";break;case this.CONDITIONAL_REQUEST_FAILED:a="Conditional request failed";break;default:a="Unknown Status"}return a};SIPResponse.prototype.setStatusCode=function(a){if(a<100||a>699){console.error("SIPResponse:setStatusCode(): bad status code");throw"SIPResponse:setStatusCode(): bad status code"}if(this.statusLine==null){this.statusLine=new StatusLine()}this.statusLine.setStatusCode(a)};SIPResponse.prototype.getStatusLine=function(){return this.statusLine};SIPResponse.prototype.getStatusCode=function(){return this.statusLine.getStatusCode()};SIPResponse.prototype.setReasonPhrase=function(a){if(a==null){console.error("SIPResponse:setReasonPhrase(): bad reason phrase");throw"SIPResponse:setReasonPhrase(): bad reason phrase"}if(this.statusLine==null){this.statusLine=new StatusLine()}this.statusLine.setReasonPhrase(a)};SIPResponse.prototype.getReasonPhrase_argu0=function(){if(this.statusLine==null||this.statusLine.getReasonPhrase()==null){return""}else{return this.statusLine.getReasonPhrase()}};SIPResponse.prototype.isFinalResponse=function(a){if(a==null){a=this.statusLine.getStatusCode()}if(a>=200&&a<700){return true}else{return false}};SIPResponse.prototype.setStatusLine=function(a){this.statusLine=a};SIPResponse.prototype.checkHeaders=function(){if(this.getCSeq()==null){console.error("SIPResponse:checkHeaders(): "+this.CSeq+" is missing ",0);throw"SIPResponse:checkHeaders(): "+this.CSeq+" is missing "}if(this.getTo()==null){console.error("SIPResponse:checkHeaders(): "+this.To+" is missing ",0);throw"SIPResponse:checkHeaders(): "+this.To+" is missing "}if(this.getFrom()==null){console.error("SIPResponse:checkHeaders(): "+this.From+" is missing ",0);throw"SIPResponse:checkHeaders(): "+this.From+" is missing "}if(this.getViaHeaders()==null){console.error("SIPResponse:checkHeaders(): "+this.Via+" is missing ",0);throw"SIPResponse:checkHeaders(): "+this.Via+" is missing "}if(this.getCallId()==null){console.error("SIPResponse:checkHeaders(): "+this.CallID+" is missing ",0);throw"SIPResponse:checkHeaders(): "+this.CallID+" is missing "}if(this.getStatusCode()>699){console.error("SIPResponse:checkHeaders(): unknown error code!"+this.getStatusCode(),0);throw"SIPResponse:checkHeaders(): unknown error code!"+this.getStatusCode()}};SIPResponse.prototype.encode=function(){var a;if(this.statusLine!=null){a=this.statusLine.encode()+this.superencode()}else{a=this.superencode()}return a};SIPResponse.prototype.encodeMessage=function(){var a;if(this.statusLine!=null){a=this.statusLine.encode()+this.encodeSIPHeaders()}else{a=this.encodeSIPHeaders()}return a};SIPResponse.prototype.superencode=function(){var f="";for(var b=0;b<this.headers.length;b++){var a=this.headers[b];if(!(a instanceof ContentLength)){f=f+a.encode()}}for(b=0;b<this.unrecognizedHeaders.length;b++){var d=this.unrecognizedHeaders[b];f=f+d+this.NEWLINE}f=f+this.contentLengthHeader.encode()+this.NEWLINE;if(this.messageContentObject!=null){var c=this.getContent().toString();f=f+c}else{if(this.messageContent!=null||this.messageContentBytes!=null){var e="";if(this.messageContent!=null){e=this.messageContent}else{for(b=0;b<this.messageContentBytes.length;b++){e=e+this.messageContentBytes[b]}}f=f+e}}return f.toString()};SIPResponse.prototype.getMessageAsEncodedStrings=function(){var b=Object.getPrototypeOf(this).getMessageAsEncodedStrings();if(this.statusLine!=null){var a=new Array();a[0]=this.statusLine.encode();for(var c=0;c<this.retval.length;c++){a[c+1]=this.retval[c]}b=a}return b};SIPResponse.prototype.encodeAsBytes=function(d){var b=new Array();if(this.statusLine!=null){b=this.getBytes(this.statusLine.encode())}var c=Object.getPrototypeOf(this).encodeAsBytes(d);var a=new Array();a=b.concat(c);return a};SIPResponse.prototype.getDialogId=function(){if(arguments.length==1){var a=arguments[0];return this.getDialogIdargu1(a)}else{if(arguments.length==2){a=arguments[0];var b=arguments[1];return this.getDialogIdargu2(a,b)}}};SIPResponse.prototype.getDialogIdargu1=function(b){var e=this.getCallId();var a=e.getCallId();var d=this.getFrom();var c=this.getTo();if(!b){if(d.getTag()!=null){a=a+this.COLON+d.getTag()}if(c.getTag()!=null){a=a+this.COLON+c.getTag()}}else{if(c.getTag()!=null){a=a+this.COLON+c.getTag()}if(d.getTag()!=null){a=a+this.COLON+d.getTag()}}return a.toString().toLowerCase()};SIPResponse.prototype.getDialogIdargu2=function(b,c){var e=this.getFrom();var d=this.getCallId();var a=d.getCallId();if(!b){if(e.getTag()!=null){a=a+this.COLON+e.getTag()}if(c!=null){a=a+this.COLON+c}}else{if(c!=null){a=a+this.COLON+c}if(e.getTag()!=null){a=a+this.COLON+e.getTag()}}return a.toString().toLowerCase()};SIPResponse.prototype.setBranch=function(a,c){var b;if(c==this.ACK){if(this.statusLine.getStatusCode()>=300){b=this.getTopmostVia().getBranch()}else{b=Utils.prototype.generateBranchId()}}else{if(c==this.CANCEL){b=this.getTopmostVia().getBranch()}else{return}}a.setBranch(b)};SIPResponse.prototype.getFirstLine=function(){if(this.statusLine==null){return null}else{return this.statusLine.encode()}};SIPResponse.prototype.setSIPVersion=function(a){this.statusLine.setSipVersion(a)};SIPResponse.prototype.getSIPVersion=function(){return this.statusLine.getSipVersion()};SIPResponse.prototype.toString=function(){if(this.statusLine==null){return""}else{return this.statusLine.encode()+Object.getPrototypeOf(this).encode()}};SIPResponse.prototype.createRequest=function(c,k,b,h,j){var f=new SIPRequest();var a=b.getMethod();var d=this.getCallId();f.setMethod(a);f.setRequestURI(c);this.setBranch(k,a);f.setHeader(k);f.setHeader(h);f.setHeader(j);f.setHeader(b);f.setHeader(d);f.attachHeader(new MaxForwards(70),false);var g=f.getHeaders();for(var e=0;e<g.length;e++){var l=g[e];if(this.isResponseHeader(l)||l instanceof ViaList||l instanceof CSeq||l instanceof ContentType||l instanceof ContentLength||l instanceof RecordRouteList||l instanceof ContactList||l instanceof ContentLength||l instanceof Reason||l instanceof ReasonList){continue}if(l instanceof To){l=j}else{if(l instanceof From){l=h}}f.attachHeader(l,false)}if(MessageFactoryImpl.prototype.getDefaultUserAgentHeader()!=null){f.setHeader(MessageFactoryImpl.prototype.getDefaultUserAgentHeader())}return f};SIPResponse.prototype.getBytes=function(b){var c=new Array();b=new String(b);for(var a=0;a<b.length;a++){c[a]=b.charCodeAt(a)}return c};SIPResponse.prototype.addContactUseragent=function(c){var a=c.getContactHeader();var b=c.getHeader("User-Agent");this.addHeader(a);this.addHeader(b)};SIPResponse.prototype.fortest=function(){var b=this.statusLine.encode();for(var d=0;d<this.headers.length;d++){var c=this.headers[d];if(!(c instanceof ContentLength)){var a=c.encode();b=b+a}}return b};function HopImpl(){this.classname="HopImpl";this.host=null;this.port=null;this.transport=SipStackImpl.prototype.DEFAULT_WS_TRANSPORT;this.defaultRoute=null;this.uriRoute=null;if(arguments.length==1){var a=arguments[0];if(a==null){console.error("HopImpl:HopImpl(): null arg!");throw"HopImpl:HopImpl(): null arg!"}var c=a.indexOf("]");var f=a.indexOf(":",c);var e=a.indexOf("/",f);if(f>0){this.host=a.substring(0,f);var b;if(e>0){b=a.substring(f+1,e);this.transport=a.substring(e+1)}else{b=a.substring(f+1)}this.port=b-0}else{if(e>0){this.host=a.substring(0,e);this.transport=a.substring(e+1);this.port=8080}else{this.host=a;this.port=8080}}if(this.host==null||this.host.length==0){console.error("HopImpl:HopImpl(): no host!");throw"HopImpl:HopImpl(): no host!"}this.host=this.host.trim();this.transport=this.transport.trim();if((c>0)&&this.host.charAt(0)!="["){console.error("HopImpl:HopImpl(): bad IPv6 reference spec");throw"HopImpl:HopImpl(): bad IPv6 reference spec"}if((this.transport.toLowerCase()!="tcp")&&(this.transport.toLowerCase()!="ws")&&(this.transport.toLowerCase()!="wss")){console.error("HopImpl:HopImpl(): bad transport string "+this.transport);throw"HopImpl:HopImpl(): bad transport string "+this.transport}}else{if(arguments.length==3){var h=arguments[0];var g=arguments[1];var d=arguments[2];this.host=h;if(this.host.indexOf(":")>=0){if(this.host.indexOf("[")<0){this.host="["+this.host+"]"}}this.port=g;this.transport=d}}}HopImpl.prototype.toString=function(){return this.host+":"+this.port+"/"+this.transport};HopImpl.prototype.getHost=function(){return this.host};HopImpl.prototype.getPort=function(){return this.port};HopImpl.prototype.getTransport=function(){return this.transport};HopImpl.prototype.isURIRoute=function(){return this.uriRoute};HopImpl.prototype.setURIRouteFlag=function(){this.uriRoute=true};function SIPTransactionStack(){this.classname="SIPTransactionStack";this.messageProcessors=new Array();this.sipMessageFactory=null;this.activeClientTransactionCount=0;this.mergeTable=new Array();this.defaultRouter=null;this.needsLogging=null;this.stackName=null;this.router=null;this.maxConnections=-1;this.useRouterForAll=null;this.readTimeout=-1;this.outboundProxy=null;this.routerPath=null;this.isAutomaticDialogSupportEnabled=null;this.forkedEvents=new Array();this.generateTimeStampHeader=null;this.cancelClientTransactionChecked=true;this.remoteTagReassignmentAllowed=true;this.logStackTraceOnMessageSend=true;this.stackDoesCongestionControl=true;this.checkBranchId=false;this.isAutomaticDialogErrorHandlingEnabled=true;this.isDialogTerminatedEventDeliveredForNullDialog=false;this.serverTransactionTable=new Array();this.clientTransactionTable=new Array();this.terminatedServerTransactionsPendingAck=new Array();this.forkedClientTransactionTable=new Array();this.dialogTable=new Array();this.earlyDialogTable=new Array();this.pendingTransactions=new Array();this.unlimitedServerTransactionTableSize=true;this.unlimitedClientTransactionTableSize=true;this.serverTransactionTableHighwaterMark=5000;this.serverTransactionTableLowaterMark=4000;this.clientTransactionTableHiwaterMark=1000;this.clientTransactionTableLowaterMark=800;this.rfc2543Supported=true;this.maxForkTime=0;this.toExit=false;this.isBackToBackUserAgent=false;this.maxListenerResponseTime=-1;this.non2XXAckPassedToListener=null;this.maxMessageSize=null;this.addressResolver=new DefaultAddressResolver();this.stackAddress=null}SIPTransactionStack.prototype.BASE_TIMER_INTERVAL=500;SIPTransactionStack.prototype.CONNECTION_LINGER_TIME=8;SIPTransactionStack.prototype.BRANCH_MAGIC_COOKIE_LOWER_CASE="z9hg4bk";SIPTransactionStack.prototype.TRYING=100;SIPTransactionStack.prototype.RINGING=180;SIPTransactionStack.prototype.dialogCreatingMethods=new Array("REFER","INVITE","SUBSCRIBE","REGISTER");SIPTransactionStack.prototype.reInit=function(){this.messageProcessors=new Array();this.pendingTransactions=new Array();this.clientTransactionTable=new Array();this.serverTransactionTable=new Array();this.mergeTable=new Array();this.dialogTable=new Array();this.earlyDialogTable=new Array();this.terminatedServerTransactionsPendingAck=new Array();this.forkedClientTransactionTable=new Array();this.activeClientTransactionCount=0};SIPTransactionStack.prototype.addExtensionMethod=function(b){if(b!="NOTIFY"){var a=null;for(var c=0;c<SIPTransactionStack.prototype.dialogCreatingMethods.length;c++){if(SIPTransactionStack.prototype.dialogCreatingMethods[c]==b.trim().toUpperCase()){a=c}}if(a==null){SIPTransactionStack.prototype.dialogCreatingMethods.push(b.trim().toUpperCase())}}};SIPTransactionStack.prototype.removeDialog=function(e){console.log("SIPTransactionStack.prototype.removeDialog(): id="+e.getDialogId());var g=e.getDialogId();var c=e.getEarlyDialogId();if(c!=null){var b=null;for(var d=0;d<this.earlyDialogTable.length;d++){if(this.earlyDialogTable[d][0]==c){b=d}}this.earlyDialogTable.splice(b,1);var b=null;for(d=0;d<this.dialogTable.length;d++){if(this.dialogTable[d][0]==c){b=d}}if(b!=null){this.dialogTable.splice(b,1)}}if(g!=null){var a=null;for(d=0;d<this.dialogTable.length;d++){if(this.dialogTable[d][0]==g){a=this.dialogTable[d][1]}}if(a==e){var b=null;for(d=0;d<this.dialogTable.length;d++){if(this.dialogTable[d][0]==g){b=d}}if(b!=null){this.dialogTable.splice(b,1)}}if(!e.testAndSetIsDialogTerminatedEventDelivered()){var f=new DialogTerminatedEvent(e.getSipProvider(),e);e.getSipProvider().handleEvent(f,null)}}};SIPTransactionStack.prototype.findSubscribeTransaction=function(h,j){var b=null;var f=h.getTo().getTag();if(f==null){return b}var a=h.getHeader("Event");if(a==null){return b}for(var d=0;d<this.clientTransactionTable.length;d++){var g=this.clientTransactionTable[d][1];if(g.getMethod()!="SUBSCRIBE"){continue}var c=g.from.getTag();var e=g.event;if(e==null){continue}if(c.toLowerCase()==f.toLowerCase()&&e!=null&&a.match(e)&&h.getCallId().getCallId().toLowerCase()==g.callId.getCallId().toLowerCase()){b=g;return b}}return b};SIPTransactionStack.prototype.removeTransactionPendingAck=function(e){var c=e.getRequest().getTopmostVia().getBranch();var a=null;for(var b=0;b<this.terminatedServerTransactionsPendingAck.length;b++){if(this.terminatedServerTransactionsPendingAck[b][0]==c){a=b}}if(a!=null){var d=true}else{d=false}if(c!=null&&d){a=null;for(b=0;b<this.terminatedServerTransactionsPendingAck.length;b++){if(this.terminatedServerTransactionsPendingAck[b][0]==c){a=b}}if(a!=null){this.terminatedServerTransactionsPendingAck.splice(a,1)}return true}else{return false}};SIPTransactionStack.prototype.removeTransactionHash=function(e){var d=e.getOriginalRequest();if(d==null){return}if(e instanceof SIPClientTransaction){var c=e.getTransactionId();var a=null;for(var b=0;b<this.clientTransactionTable.length;b++){if(this.clientTransactionTable[b][0]==c){a=b}}this.clientTransactionTable.splice(a,1)}else{if(e instanceof SIPServerTransaction){c=e.getTransactionId();a=null;for(b=0;b<this.serverTransactionTable.length;b++){if(this.serverTransactionTable[b][0]==c){a=b}}this.serverTransactionTable.splice(a,1)}}};SIPTransactionStack.prototype.removePendingTransaction=function(c){var a=null;for(var b=0;b<this.pendingTransactions.length;b++){if(this.pendingTransactions[b][0]==c.getTransactionId()){a=b}}if(a!=null){this.pendingTransactions.splice(a,1)}};SIPTransactionStack.prototype.isAlive=function(){if(!this.toExit){return true}else{return false}};SIPTransactionStack.prototype.findCancelTransaction=function(f,c){if(c){for(var a=0;a<this.serverTransactionTable.length;a++){var d=this.serverTransactionTable[a][1];var e=d;if(e.doesCancelMatchTransaction(f)){return e}}}else{for(a=0;a<this.clientTransactionTable.length;a++){d=this.clientTransactionTable[a][1];var b=d;if(b.doesCancelMatchTransaction(f)){return b}}}return null};SIPTransactionStack.prototype.getDialog=function(b){var a=null;for(var d=0;d<this.dialogTable.length;d++){if(this.dialogTable[d][0]==b){a=d}}if(a!=null){var c=this.dialogTable[a][1];return c}else{return null}};SIPTransactionStack.prototype.isDialogCreated=function(b){for(var a=0;a<SIPTransactionStack.prototype.dialogCreatingMethods.length;a++){if(SIPTransactionStack.prototype.dialogCreatingMethods[a]==b){return true}}return false};SIPTransactionStack.prototype.isRfc2543Supported=function(){return this.rfc2543Supported};SIPTransactionStack.prototype.createDialog=function(){if(arguments.length==1){var b=arguments[0];return this.createDialogargu1(b)}else{if(arguments.length==2){if(arguments[0].classname=="SipProviderImpl"){var a=arguments[0];c=arguments[1];return new SIPDialog(a,c)}else{b=arguments[0];var c=arguments[1];return this.createDialogargu2(b,c)}}}};SIPTransactionStack.prototype.createDialogargu1=function(f){var c=null;if(f instanceof SIPClientTransaction){var b=f.getRequest().getDialogId(false);var a=null;for(var e=0;e<this.earlyDialogTable.length;e++){if(this.earlyDialogTable[e][0]==b){a=e}}if(a!=null){var d=this.earlyDialogTable[a][1];if(d.getState()==null||d.getState()=="EARLY"){c=d}else{c=new SIPDialog(f);this.earlyDialogTable[a][1]=c}}else{c=new SIPDialog(f);var g=new Array();g[0]=b;g[1]=c;this.earlyDialogTable.push(g)}}else{c=new SIPDialog(f)}return c};SIPTransactionStack.prototype.createDialogargu2=function(e,f){var c=e.getRequest().getDialogId(false);var b=null;var a=null;for(var d=0;d<this.earlyDialogTable.length;d++){if(this.earlyDialogTable[d][0]==c){a=d}}if(a!=null){b=this.earlyDialogTable[a][1];if(f.isFinalResponse()){this.earlyDialogTable.splice(a,1)}}else{b=new SIPDialog(e,f)}return b};SIPTransactionStack.prototype.createRawMessageChannel=function(){var a=null;for(var b=0;b<this.messageProcessors.length;b++){var c=this.messageProcessors[b];if(c.getTransport()==this.transport){a=c.createMessageChannel();break}}return a};SIPTransactionStack.prototype.isNon2XXAckPassedToListener=function(){if(this.non2XXAckPassedToListener){return true}else{return false}};SIPTransactionStack.prototype.isTransactionPendingAck=function(d){var c=d.getRequest().getTopmostVia().getBranch();var a=null;for(var b=0;b<this.terminatedServerTransactionsPendingAck.length;b++){if(this.terminatedServerTransactionsPendingAck[b][0]==c){a=b}}if(a!=null){return true}else{return false}};SIPTransactionStack.prototype.setNon2XXAckPassedToListener=function(a){this.non2XXAckPassedToListener=a};SIPTransactionStack.prototype.addForkedClientTransaction=function(b){var a=null;for(var c=0;c<this.forkedClientTransactionTable.length;c++){if(this.forkedClientTransactionTable[c][0]==b.getTransactionId()){a=c;this.forkedClientTransactionTable[c][1]=b}}if(a==null){var d=new Array();d[0]=b.getTransactionId();d[1]=b;this.forkedClientTransactionTable.push(d)}};SIPTransactionStack.prototype.getForkedTransaction=function(c){var a=null;for(var b=0;b<this.forkedClientTransactionTable.length;b++){if(this.forkedClientTransactionTable[b][0]==c){a=b}}if(a!=null){return this.forkedClientTransactionTable[a][1]}else{return null}};SIPTransactionStack.prototype.addTransactionPendingAck=function(d){var c=d.getRequest().getTopmostVia().getBranch();if(c!=null){var a=null;for(var b=0;b<this.terminatedServerTransactionsPendingAck.length;b++){if(this.forkedClientTransactionTable[b][0]==c){a=b;this.forkedClientTransactionTable[b][1]=d}}if(a==null){var e=new Array();e[0]=c;e[1]=d;this.forkedClientTransactionTable.push(e)}}};SIPTransactionStack.prototype.findTransactionPendingAck=function(c){var a=null;for(var b=0;b<this.terminatedServerTransactionsPendingAck.length;b++){if(this.terminatedServerTransactionsPendingAck[b][0]==c.getTopmostVia().getBranch()){a=b}}if(a==null){return null}else{return this.terminatedServerTransactionsPendingAck[a][1]}};SIPTransactionStack.prototype.putDialog=function(d){var b=d.getDialogId();var a=null;for(var c=0;c<this.dialogTable.length;c++){if(this.dialogTable[c][0]==b){a=c}}if(a!=null){return}d.setStack(this);var e=new Array();e[0]=b;e[1]=d;this.dialogTable.push(e)};SIPTransactionStack.prototype.findPendingTransaction=function(b){var a=null;for(var c=0;c<this.pendingTransactions.length;c++){if(this.dialogTable[c][0]==b.getTransactionId()){a=c}}if(a==null){return null}else{return this.pendingTransactions[a][1]}};SIPTransactionStack.prototype.putPendingTransaction=function(c){var a=null;for(var b=0;b<this.pendingTransactions.length;b++){if(this.pendingTransactions[b][0]==c.getTransactionId()){a=b;this.pendingTransactions[b][1]=c}}if(a==null){var d=new Array();d[0]=c.getTransactionId();d[1]=c;this.pendingTransactions.push(d)}};SIPTransactionStack.prototype.removePendingTransaction=function(c){var a=null;for(var b=0;b<this.pendingTransactions.length;b++){if(this.pendingTransactions[b][0]==c.getTransactionId()){a=b}}this.pendingTransactions.splice(a,1)};SIPTransactionStack.prototype.getServerTransactionTableSize=function(){return this.serverTransactionTable.length};SIPTransactionStack.prototype.getClientTransactionTableSize=function(){return this.clientTransactionTable.length};SIPTransactionStack.prototype.findTransaction=function(g,f){var a=null;if(f){var c=g.getTopmostVia();if(c.getBranch()!=null){var e=g.getTransactionId();for(var d=0;d<this.serverTransactionTable.length;d++){if(this.serverTransactionTable[d][0]==e){a=this.serverTransactionTable[d][1]}}if(e.substring(0,7).toLowerCase()=="z9hg4bk"){return a}}for(d=0;d<this.serverTransactionTable.length;d++){var h=this.serverTransactionTable[d][1];if(h.isMessagePartOfTransaction(g)){a=h;return a}}}else{c=g.getTopmostVia();if(c.getBranch()!=null){e=g.getTransactionId();for(d=0;d<this.clientTransactionTable.length;d++){if(this.clientTransactionTable[d][0]==e){a=this.clientTransactionTable[d][1]}}if(e.substring(0,7).toLowerCase()=="z9hg4bk"){return a}}for(d=0;d<this.serverTransactionTable.length;d++){var b=this.clientTransactionTable[d][1];if(b.isMessagePartOfTransaction(g)){a=b;return a}}}return a};SIPTransactionStack.prototype.removeFromMergeTable=function(d){var c=d.getRequest().getMergeId();var a=null;if(c!=null){for(var b=0;b<this.mergeTable.length;b++){if(this.mergeTable[b][0]==c){a=b}}if(a!=null){this.mergeTable.splice(a,1)}}};SIPTransactionStack.prototype.putInMergeTable=function(d,c){var e=c.getMergeId();var a=null;if(e!=null){for(var b=0;b<this.mergeTable.length;b++){if(this.mergeTable[b][0]==e){this.mergeTable[b][1]=d;a=b}}if(a==null){var f=new Array();f[0]=e;f[1]=d;this.mergeTable.push(f)}}};SIPTransactionStack.prototype.addTransactionHash=function(e){var d=e.getOriginalRequest();if(e instanceof SIPClientTransaction){this.activeClientTransactionCount++;var a=null;var c=d.getTransactionId();for(var b=0;b<this.clientTransactionTable.length;b++){if(this.clientTransactionTable[b][0]==c){a=b;this.clientTransactionTable[b][1]=e}}if(a==null){var f=new Array();f[0]=c;f[1]=e;this.clientTransactionTable.push(f)}}else{a=null;c=d.getTransactionId();for(b=0;b<this.serverTransactionTable.length;b++){if(this.serverTransactionTable[b][0]==c){a=b;this.serverTransactionTable[b][1]=e}}if(a==null){f=new Array();f[0]=c;f[1]=e;this.serverTransactionTable.push(f)}}};SIPTransactionStack.prototype.setMessageFactory=function(a){this.sipMessageFactory=a};SIPTransactionStack.prototype.checkBranchIdFunction=function(){return this.checkBranchId};SIPTransactionStack.prototype.addMessageProcessor=function(c){var a=null;for(var b=0;b<this.messageProcessors.length;b++){if(this.messageProcessors[b]==c){a=b}}if(a==null){this.messageProcessors.push(c)}};SIPTransactionStack.prototype.findMergedTransaction=function(g){if(g.getMethod()!="INVITE"){return null}var f=g.getMergeId();var a=null;for(var e=0;e<this.mergeTable.length;e++){if(this.mergeTable[e][0]==f){a=this.mergeTable[e][1]}}if(f==null){return null}else{if(a!=null&&!a.isMessagePartOfTransaction(g)){return a}else{for(e=0;e<this.dialogTable.length;e++){var d=this.dialogTable[e][1];var b=d;if(b.getFirstTransaction()!=null&&b.getFirstTransaction() instanceof SIPServerTransaction){var h=b.getFirstTransaction();var c=b.getFirstTransaction().getOriginalRequest();if((!h.isMessagePartOfTransaction(g))&&g.getMergeId()==c.getMergeId()){return b.getFirstTransaction()}}}return null}}};SIPTransactionStack.prototype.mapTransaction=function(a){if(a.isMapped){return}this.addTransactionHash(a);a.isMapped=true};SIPTransactionStack.prototype.createTransaction=function(a,c,b){var d=null;if(c==null){return null}d=this.createClientTransaction(a,c);d.setViaPort(b.getPort());d.setViaHost(b.getHost());this.addTransactionHash(d);return d};SIPTransactionStack.prototype.createClientTransaction=function(b,c){var a=new SIPClientTransaction(this,c);a.setOriginalRequest(b);return a};SIPTransactionStack.prototype.addTransaction=function(a){if(a instanceof SIPServerTransaction){a.map()}this.addTransactionHash(a)};SIPTransactionStack.prototype.transactionErrorEvent=function(a){var b=a.getSource();if(a.getErrorID()==2){b.setState("TERMINATED");if(b instanceof SIPServerTransaction){b.collectionTime=0}b.disableTimeoutTimer()}};SIPTransactionStack.prototype.dialogErrorEvent=function(b){var a=b.getSource();if(a!=null){a.delet()}};SIPTransactionStack.prototype.stopStack=function(){this.pendingTransactions=new Array();this.toExit=true;var b=this.getMessageProcessors();for(var a=0;a<b.length;a++){this.removeMessageProcessor(b[a]);this.clientTransactionTable=new Array();this.serverTransactionTable=new Array();this.dialogTable=new Array()}};SIPTransactionStack.prototype.getMaxMessageSize=function(){return this.maxMessageSize};SIPTransactionStack.prototype.getNextHop=function(a){if(this.useRouterForAll){if(this.router!=null){return this.router.getNextHop(a)}else{return null}}else{if(a.getRequestURI().isSipURI()||a.getRouteHeaders()!=null){return this.defaultRouter.getNextHop(a)}else{if(this.router!=null){return this.router.getNextHop(a)}else{return null}}}};SIPTransactionStack.prototype.setStackName=function(a){this.stackName=a};SIPTransactionStack.prototype.setHostAddress=function(a){if(a.indexOf(":")!=a.lastIndexOf(":")&&a.trim().charAt(0)!="["){this.stackAddress="["+a+"]"}else{this.stackAddress=a}this.stackInetAddress=a};SIPTransactionStack.prototype.getHostAddress=function(){return this.stackAddress};SIPTransactionStack.prototype.setRouter=function(a){this.router=a};SIPTransactionStack.prototype.getRouter=function(){if(arguments.length==0){this.getRouterargu0()}else{var a=arguments[0];this.getRouterargu1(a)}};SIPTransactionStack.prototype.getRouterargu0=function(){return this.router};SIPTransactionStack.prototype.getRouterargu1=function(a){if(a.getRequestLine()==null){return this.defaultRouter}else{if(this.useRouterForAll){return this.router}else{if(a.getRequestURI().getScheme()=="sip"||a.getRequestURI().getScheme()=="sips"){return this.defaultRouter}else{if(this.router!=null){return this.router}else{return this.defaultRouter}}}}};SIPTransactionStack.prototype.removeMessageProcessor=function(b){var a=null;for(var c=0;c<this.messageProcessors.lengt;c++){if(this.messageProcessors[c]==b){a=c}}if(a!=null){this.messageProcessors.splice(a,1);b.stop()}};SIPTransactionStack.prototype.getMessageProcessors=function(){return this.messageProcessors};SIPTransactionStack.prototype.isEventForked=function(c){var a=null;for(var b=0;b<this.forkedEvents.length;b++){if(this.forkedEvents[b]==c){a=b}}if(a!=null){return true}else{return false}};SIPTransactionStack.prototype.getActiveClientTransactionCount=function(){return this.activeClientTransactionCount};SIPTransactionStack.prototype.isCancelClientTransactionChecked=function(){return this.cancelClientTransactionChecked};SIPTransactionStack.prototype.isRemoteTagReassignmentAllowed=function(){return this.remoteTagReassignmentAllowed};SIPTransactionStack.prototype.getDialogs=function(){if(arguments.length==0){return this.getDialogsargu0()}else{var a=arguments[0];return this.getDialogsargu1(a)}};SIPTransactionStack.prototype.getDialogsargu0=function(){var d=new Array();for(var c=0;c<this.dialogTable.length;c++){var b=null;for(var a=0;a<d.legnth;a++){if(d[a]==this.dialogTable[c][1]){b=c}}if(b==null){d.push(this.dialogTable[c][1])}}for(c=0;c<this.earlyDialogTable.length;c++){b=null;for(a=0;a<d.legnth;a++){if(d[a]==this.earlyDialogTable[c][1]){b=c}}if(b==null){d.push(this.earlyDialogTable[c][1])}}return d};SIPTransactionStack.prototype.getDialogsargu1=function(f){var e=new Array();if("EARLY"==f){for(var d=0;d<this.earlyDialogTable.length;d++){var b=null;for(var a=0;a<e.legnth;a++){if(e[a]==this.earlyDialogTable[d][1]){b=d}}if(b==null){e.push(this.earlyDialogTable[d][1])}}}else{for(d=0;d<this.dialogTable.length;d++){var c=this.dialogTable[d][1];if(c.getState()!=null&&c.getState()==f){b=null;for(a=0;a<e.legnth;a++){if(e[a]==c){b=d}}if(b==null){e.push(c)}}}}return e};SIPTransactionStack.prototype.setDeliverDialogTerminatedEventForNullDialog=function(){this.isDialogTerminatedEventDeliveredForNullDialog=true};SIPTransactionStack.prototype.getAddressResolver=function(){return this.addressResolver};function SIPTransactionErrorEvent(b,a){this.classname="SIPTransactionErrorEvent";this.source=b;this.errorID=a}SIPTransactionErrorEvent.prototype.TIMEOUT_ERROR=1;SIPTransactionErrorEvent.prototype.TRANSPORT_ERROR=64;SIPTransactionErrorEvent.prototype.TIMEOUT_RETRANSMIT=64;SIPTransactionErrorEvent.prototype.getErrorID=function(){return this.errorID};SIPTransactionErrorEvent.prototype.getSource=function(){return this.source};function DefaultRouter(){this.classname="DefaultRouter";this.sipStack=null;this.defaultRoute=null;if(arguments.length!=0){var d=arguments[0];var a=arguments[1];var c=8080;var b="WSS";if(arguments.length>=4){if(arguments[2]!=null){c=arguments[2]}if(arguments[3]!=null){b=arguments[3]}}this.sipStack=d;if(a!=null){this.defaultRoute=this.sipStack.getAddressResolver().resolveAddress(new HopImpl(a,c,b))}}}DefaultRouter.prototype.getNextHop=function(e){var f=e;var h=f.getRequestLine();if(h==null){return this.defaultRoute}var d=h.getUri();if(d==null){console.error("DefaultRouter:getNextHop(): bad message: Null requestURI");throw"ViaParser:getNextHop():  bad message: Null requestURI"}var i=f.getRouteHeaders();if((i!=null)&&(i.getFirst()!=null)){var g=i.getFirst();var c=g.getAddress().getURI();if(c.isSipURI()){var b=c;if(!b.hasLrParam()){this.fixStrictRouting(f)}var a=this.createHop(b,e);return a}else{console.error("DefaultRouter:getNextHop(): first Route not a SIP URI");throw"DefaultRouter:getNextHop(): first Route not a SIP URI"}}else{if(d.isSipURI()&&d.getMAddrParam()!=null){a=this.createHop(d,e);return a}else{if(this.defaultRoute!=null){return this.defaultRoute}else{if(d.isSipURI()){a=this.createHop(d,e);return a}else{return null}}}}};DefaultRouter.prototype.fixStrictRouting=function(d){var a=d.getRouteHeaders();var e=a.getFirst();var c=e.getAddress().getURI();a.removeFirst();var f=new AddressImpl();f.setAddress(d.getRequestURI());var b=new Route(f);a.add(b);d.setRequestURI(c)};DefaultRouter.prototype.createHop=function(e,d){var g=e.getTransportParam();if(g==null){var b=d.getHeader("Via");g=b.getTransport()}var a=null;if(e.getPort()!=-1){a=e.getPort()}else{a=5060}var c=e.getMAddrParam()!=null?e.getMAddrParam():e.getHost();var f=this.sipStack.getAddressResolver();return f.resolveAddress(new HopImpl(c,a,g))};DefaultRouter.prototype.getOutboundProxy=function(){return this.defaultRoute};DefaultRouter.prototype.getNextHops=function(c){try{var b=new Array();b.push(this.getNextHop(c));return b()}catch(a){console.error("DefaultRouter:getNextHops(): catched exception:"+a);return null}};function WSMessageChannel(a,b){this.classname="WSMessageChannel";this.wsurl=b;if(this.wsurl.toLowerCase().indexOf("ws://")==0){this.transport="WS"}else{if(this.wsurl.toLowerCase().indexOf("wss://")==0){this.transport="WSS"}else{throw"WSMessageChannel:createWebSocket(): bad Websocket Url";console.warn("WSMessageChannel:createWebSocket(): bad Websocket Url")}}this.messageProcessor=a;this.myAddress=this.messageProcessor.sipStack.getHostAddress();this.websocket=this.createWebSocket();this.wsMsgParser=new WSMsgParser(this)}WSMessageChannel.prototype.isReliable=function(){return true};WSMessageChannel.prototype.createWebSocket=function(){this.websocket=new WebSocket(this.wsurl,"sip");this.websocket.binaryType="arraybuffer";var a=this;this.websocket.onclose=function(){console.warn("WSMessageChannel:createWebSocket(): the websocket is closed");a.messageProcessor.sipStack.sipListener.processDisconnected();a.websocket=null};this.websocket.onopen=function(){console.info("WSMessageChannel:createWebSocket(): the websocket is opened");a.messageProcessor.sipStack.sipListener.processConnected()};this.websocket.onerror=function(b){console.error("WSMessageChannel:createWebSocket(): websocket connection has failed:"+b);a.messageProcessor.sipStack.sipListener.processConnectionError(b)};this.websocket.onmessage=function(c){if(c.data instanceof ArrayBuffer){var b=String.fromCharCode.apply(null,new Uint8Array(c.data));a.wsMsgParser.parsermessage(b)}else{if(typeof(c.data)=="string"){a.wsMsgParser.parsermessage(c.data)}else{console.error("WSMessageChannel:onmessage(): bad data object type, event ignored")}}};return this.websocket};WSMessageChannel.prototype.close=function(){this.websocket.close();this.websocket=null};WSMessageChannel.prototype.getSIPStack=function(){return this.messageProcessor.sipStack};WSMessageChannel.prototype.getTransport=function(){return this.transport};WSMessageChannel.prototype.sendMessage=function(b){if(b instanceof SIPRequest){this.requestsent=b}if(typeof b!="string"){var a=b.encode();b=a}this.websocket.send(b);console.info("SIP message sent: "+b)};WSMessageChannel.prototype.getViaHeader=function(){var a;a=new Via();a.setTransport(this.getTransport());a.setSentBy(this.getHostPort());return a};WSMessageChannel.prototype.getViaHost=function(){return this.myAddress};WSMessageChannel.prototype.getViaHostPort=function(){var a=new HostPort();a.setHost(new Host(this.getViaHost()));return a};WSMessageChannel.prototype.getPeerAddress=function(){if(this.peerAddress!=null){return this.peerAddress}else{return getHost()}};WSMessageChannel.prototype.getHost=function(){return this.sipStack.getHostAddress()};WSMessageChannel.prototype.createBadReqRes=function(b){var c=512;c=c+"SIP/2.0 400 Bad Request";if(!this.copyViaHeaders(b,c)){return null}if(!this.copyHeader(this.CSeqHeader,b,c)){return null}if(!this.copyHeader(this.CallIdHeader,b,c)){return null}if(!this.copyHeader(this.FromHeader,b,c)){return null}if(!this.copyHeader(this.ToHeader,b,c)){return null}var d=c.indexOf(ToHeader.NAME);if(d!=-1&&c.indexOf("tag",d)==-1){c=c+";tag=badreq"}var e=MessageFactoryImpl.prototype.getDefaultServerHeader();if(e!=null){c=c+"\r\n"+e.toString()}var a=b.length();var f=new ContentType("message","sipfrag");c=c+"\r\n"+f.toString();var g=new ContentLength(a);c=c+"\r\n"+g.toString();c=c+"\r\n\r\n"+b;return c.toString()};WSMessageChannel.prototype.copyHeader=function(d,a,c){var e=a.indexOf(d);if(e!=-1){var b=a.indexOf("\r\n",e);if(b!=-1){c=c+a.substring(e-2,b);return true}}return false};WSMessageChannel.prototype.copyViaHeaders=function(a,c){var e=a.indexOf(this.ViaHeader);var d=false;while(e!=-1){var b=a.indexOf("\r\n",e);if(b!=-1){c=c+a.substring(e-2,b);d=true;e=a.indexOf(this.ViaHeader,b)}else{return false}}return d};WSMessageChannel.prototype.getMessageProcessor=function(){return this.messageProcessor};WSMessageChannel.prototype.isSecure=function(){return false};WSMessageChannel.prototype.getWebSocket=function(){return this.websocket};function WSMessageProcessor(b,a){this.classname="WSMessageProcessor";this.sipStack=b;this.wsMessageChannel=new WSMessageChannel(this,a);this.sentByHostPort=new HostPort();this.sentByHostPort.setHost(new Host(this.sipStack.getHostAddress()));this.sentBy=null;this.sentBySet=null}WSMessageProcessor.prototype.getTransport=function(){return this.wsMessageChannel.getTransport()};WSMessageProcessor.prototype.getMessageChannel=function(){return this.wsMessageChannel};WSMessageProcessor.prototype.getSIPStack=function(){return this.sipStack};WSMessageProcessor.prototype.getInfoApp=function(){return this.infoApp};WSMessageProcessor.prototype.stop=function(){this.isRunning=false;this.wsMessageChannels.close()};WSMessageProcessor.prototype.getMaximumMessageSize=function(){return 2147483647};WSMessageProcessor.prototype.getViaHeader=function(){var a=new Via();if(this.sentByHostPort!=null){a.setSentBy(this.sentByHostPort);a.setTransport(this.getTransport())}else{var b=new Host();b.setHostname(this.sipStack.getHostAddress());a.setHost(b);a.setTransport(this.getTransport())}a.setBranch(Utils.prototype.generateBranchId());return a};WSMessageProcessor.prototype.getDefaultTargetPort=function(){return 5060};WSMessageProcessor.prototype.isSecure=function(){return false};WSMessageProcessor.prototype.getListeningPoint=function(){return this.listeningPoint};WSMessageProcessor.prototype.setListeningPoint=function(a){this.listeningPoint=a};WSMessageProcessor.prototype.initialize=function(b,a){this.sipStack=a;this.infoApp=b};WSMessageProcessor.prototype.setSentBy=function(c){var d=c.indexOf(":");if(d==-1){this.sentByHostPort=new HostPort();this.sentByHostPort.setHost(new Host(c))}else{this.sentByHostPort=new HostPort();this.sentByHostPort.setHost(new Host(c.substring(0,d)));var e=c.substring(d+1);try{var a=e;this.sentByHostPort.setPort(a)}catch(b){console.error("WSMessageProcessor:setSentBy(): bad format encountered at ",d);throw"WSMessageProcessor:setSentBy(): bad format encountered at "+d}}this.sentBySet=true;this.sentBy=c};WSMessageProcessor.prototype.getSentBy=function(){if(this.sentBy==null&&this.sentByHostPort!=null){this.sentBy=this.sentByHostPort.toString()}return this.sentBy};WSMessageProcessor.prototype.getPort=function(){return this.port};WSMessageProcessor.prototype.getDefaultPort=function(){var a=5060;return a};function SIPDialog(){this.classname="SIPDialog";this.dialogTerminatedEventDelivered=null;this.stackTrace=null;this.method=null;this.isAssigned=null;this.reInviteFlag=null;this.applicationData=null;this.originalRequest=null;this.lastResponse=null;this.firstTransaction=null;this.lastTransaction=null;this.dialogId=null;this.earlyDialogId=null;this.localSequenceNumber=0;this.remoteSequenceNumber=-1;this.myTag=null;this.hisTag=null;this.routeList=new RouteList();this.sipStack=null;this.dialogState=this.NULL_STATE;this.ackSeen=false;this.lastAckSent=null;this.lastAckReceived=null;this.ackProcessed=false;this.nextSeqno=null;this.retransmissionTicksLeft=null;this.prevRetransmissionTicks=null;this.originalLocalSequenceNumber=null;this.ackLine=null;this.auditTag=0;this.localParty=null;this.remoteParty=null;this.callIdHeader=null;this.serverTransactionFlag=null;this.sipProvider=null;this.terminateOnBye=true;this.byeSent=null;this.remoteTarget=null;this.eventHeader=null;this.lastInviteOkReceived=null;this.reInviteWaitTime=100;this.isAcknowledged=null;this.highestSequenceNumberAcknowledged=-1;this.isBackToBackUserAgent=null;this.sequenceNumberValidation=true;this.eventListeners=new Array();this.firstTransactionSecure=null;this.firstTransactionSeen=null;this.firstTransactionMethod=null;this.firstTransactionId=null;this.firstTransactionIsServerTransaction=null;this.firstTransactionPort=5060;this.contactHeader=null;this.timer=null;this.inviteTransaction=null;if(arguments[0].classname=="SipProviderImpl"){this.terminateOnBye=true;this.routeList=new RouteList();this.dialogState=this.NULL_STATE;this.localSequenceNumber=0;this.remoteSequenceNumber=-1;this.sipProvider=arguments[0];if(arguments.length==2){c=arguments[1];this.sipStack=this.sipProvider.getSipStack();this.setLastResponse(null,c);this.localSequenceNumber=c.getCSeq().getSeqNumber();this.originalLocalSequenceNumber=this.localSequenceNumber;this.myTag=c.getFrom().getTag();this.hisTag=c.getTo().getTag();this.localParty=c.getFrom().getAddress();this.remoteParty=c.getTo().getAddress();this.method=c.getCSeq().getMethod();this.callIdHeader=c.getCallId();this.serverTransactionFlag=false;this.isBackToBackUserAgent=this.sipStack.isBackToBackUserAgent;this.addEventListener(this.sipStack)}}else{var b=arguments[0];this.sipProvider=b.getSipProvider();this.firstTransactionSeen=false;this.terminateOnBye=true;this.routeList=new RouteList();this.dialogState=this.NULL_STATE;this.localSequenceNumber=0;this.remoteSequenceNumber=-1;var a=b.getRequest();this.callIdHeader=a.getCallId();this.earlyDialogId=a.getDialogId(false);if(b==null){console.error("SIPDialog:SIPDialog(): null transcation argument");throw"SIPDialog:SIPDialog(): null transcation argument"}this.sipStack=b.sipStack;if(this.sipProvider==null){console.error("SIPDialog:SIPDialog(): null sip provider argument");throw"SIPDialog:SIPDialog(): null sip provider argument"}this.addTransaction(b);if(arguments.length==2){var c=arguments[1];if(c==null){console.error("SIPDialog:SIPDialog(): null sip response argument");throw"SIPDialog:SIPDialog(): null sip response argument"}this.setLastResponse(b,c);this.isBackToBackUserAgent=this.sipStack.isBackToBackUserAgent}this.isBackToBackUserAgent=this.sipStack.isBackToBackUserAgent;this.addEventListener(this.sipStack)}}SIPDialog.prototype.NULL_STATE=-1;SIPDialog.prototype.EARLY_STATE=0;SIPDialog.prototype.CONFIRMED_STATE=1;SIPDialog.prototype.TERMINATED_STATE=2;SIPDialog.prototype.DIALOG_LINGER_TIME=8;SIPDialog.prototype.TimeStampHeader="Timestamp";SIPDialog.prototype.TIMER_H=64;SIPDialog.prototype.TIMER_J=64;SIPDialog.prototype.BASE_TIMER_INTERVAL=500;SIPDialog.prototype.lingerTimeout=function(){if(this.eventListeners!=null){this.eventListeners=null}this.sipStack.removeDialog(this)};SIPDialog.prototype.deferredDeleteTimeout=function(){throw"bug"};SIPDialog.prototype.dialogTimeout=function(){if((!this.ackSeen)&&(this.dialogTransactionTimeout!=null)){var a=this.dialogTransactionTimeout.getLastResponse();if(a.getStatusCode()==200){this.dialogTransactionTimeout.fireTimer()}}if(this.isAckSeen()||this.dialogState==2){this.dialogTransactionTimeout=null;clearInterval(this.timer)}};SIPDialog.prototype.deleteIfNoAckSentTimeout=function(e){this.seqno=e;if(this.highestSequenceNumberAcknowledged<e){this.dialogDeleteIfNoAckSentTask=null;if(!this.isBackToBackUserAgent){if(this.sipProvider.getSipListener() instanceof SipListener){this.raiseErrorEvent(SIPDialogErrorEvent.DIALOG_ACK_NOT_SENT_TIMEOUT)}else{this.delet()}}else{if(this.sipProvider.getSipListener() instanceof SipListener){this.raiseErrorEvent(SIPDialogErrorEvent.DIALOG_ACK_NOT_SENT_TIMEOUT)}else{try{var d=this.createRequest("BYE");if(MessageFactoryImpl.prototype.getDefaultUserAgentHeader()!=null){d.addHeader(MessageFactoryImpl.prototype.getDefaultUserAgentHeader())}var c=new Reason();c.setProtocol("SIP");c.setCause(1025);c.setText("Timed out waiting to send ACK");d.addHeader(c);var b=this.getSipProvider().getNewClientTransaction(d);this.sendRequest(b);return}catch(a){console.error("SIPDialog:DialogDeleteIfNoAckSentTask(): catched exception:"+a);this.delet()}}}}};SIPDialog.prototype.ackReceived=function(a){if(this.ackSeen){return}var b=this.getInviteTransaction();if(b!=null){if(b.getCSeq()==a.getCSeq().getSeqNumber()){this.ackSeen=true;this.setLastAckReceived(a);this.setRemoteTag(a.getFromTag());this.setLocalTag(a.getToTag());this.setDialogId(a.getDialogId(true));this.addRoute(a);this.setState(this.CONFIRMED_STATE);this.sipStack.putDialog(this)}}};SIPDialog.prototype.isTerminatedOnBye=function(){if(this.terminateOnBye){return true}else{return false}};SIPDialog.prototype.setState=function(b){this.dialogState=b;if(b==this.TERMINATED_STATE){var a=this;this.timer=setTimeout(function(){a.lingerTimeout()},this.DIALOG_LINGER_TIME*1000)}};SIPDialog.prototype.getLocalTag=function(){return this.myTag};SIPDialog.prototype.isAckSeen=function(){return this.ackSeen};SIPDialog.prototype.getLastAckSent=function(){return this.lastAckSent};SIPDialog.prototype.resendAck=function(){if(this.getLastAckSent()!=null){if(this.getLastAckSent().getHeader(this.TimeStampHeader)!=null&&this.sipStack.generateTimeStampHeader){var a=new TimeStamp();var b=new Date();a.setTimeStamp(b.getTime());this.getLastAckSent().setHeader(a)}this.sendAck(this.getLastAckSent(),false)}};SIPDialog.prototype.getMethod=function(){return this.method};SIPDialog.prototype.isBackToBackUserAgent=function(){return this.isBackToBackUserAgent};SIPDialog.prototype.getState=function(){var a=null;if(this.dialogState==this.NULL_STATE){a=null}if(this.dialogState==0){a="EARLY"}else{if(this.dialogState==1){a="CONFIRMED"}else{if(this.dialogState==2){a="TERMINATED"}}}return a};SIPDialog.prototype.delet=function(){this.setState(this.TERMINATED_STATE)};SIPDialog.prototype.isTerminatedOnBye=function(){return this.terminateOnBye};SIPDialog.prototype.getLastResponse=function(){return this.lastResponse};SIPDialog.prototype.setLastResponse=function(a,e){this.callIdHeader=e.getCallId();var c=e.getStatusCode();if(c==100){return}this.lastResponse=e;this.setAssigned();if(this.getState()=="TERMINATED"){if(e.getCSeq().getMethod()=="INVITE"&&c==200){this.lastInviteOkReceived=Math.max(e.getCSeq().getSeqNumber(),this.lastInviteOkReceived)}return}var g=e.getCSeq().getMethod();if(a==null||a instanceof SIPClientTransaction){if(this.sipStack.isDialogCreated(g)){if(this.getState()==null&&(100<=c&&c<=199)){this.setState(this.EARLY_STATE);if((e.getToTag()!=null||this.sipStack.rfc2543Supported)&&this.getRemoteTag()==null){this.setRemoteTag(e.getToTag());this.setDialogId(e.getDialogId(false));this.sipStack.putDialog(this);this.addRoute(e)}}else{if(this.getState()!=null&&this.getState()=="EARLY"&&100<=c&&c<=199){if(g==this.getMethod()&&a!=null&&(e.getToTag()!=null||this.sipStack.rfc2543Supported)){this.setRemoteTag(e.getToTag());this.setDialogId(e.getDialogId(false));this.sipStack.putDialog(this);this.addRoute(e)}}else{if(200<=c&&c<=299){if(g==this.getMethod()&&(e.getToTag()!=null||this.sipStack.rfc2543Supported)&&this.getState()!="CONFIRMED"){this.setRemoteTag(e.getToTag());this.setDialogId(e.getDialogId(false));this.sipStack.putDialog(this);this.addRoute(e);this.setState(this.CONFIRMED_STATE)}if(g=="INVITE"){this.lastInviteOkReceived=Math.max(e.getCSeq().getSeqNumber(),this.lastInviteOkReceived)}}else{if(c>=300&&c<=699&&(this.getState()==null||(g==this.getMethod()&&this.getState()=="EARLY"))){this.setState(this.TERMINATED_STATE)}}}}if(this.getState()!="CONFIRMED"&&this.getState()!="TERMINATED"){if(this.originalRequest!=null){var j=this.originalRequest.getRecordRouteHeaders();if(j!=null){for(var d=j.length;d>=0;d--){var b=j[d];var h=this.routeList.getFirst();if(h!=null&&b.getAddress()==h.getAddress()){this.routeList.removeFirst()}else{break}}}}}}else{if(g=="NOTIFY"&&(this.getMethod()=="SUBSCRIBE"||this.getMethod()=="REFER")&&e.getStatusCode()/100==2&&this.getState()==null){this.setDialogId(e.getDialogId(true));this.sipStack.putDialog(this);this.setState(this.CONFIRMED_STATE)}else{if(g=="BYE"&&c/100==2&&this.isTerminatedOnBye()){this.setState(this.TERMINATED_STATE)}}}}else{if(g=="BYE"&&c/100==2&&this.isTerminatedOnBye()){this.setState(this.TERMINATED_STATE)}else{var f=false;if(this.getLocalTag()==null&&e.getTo().getTag()!=null&&this.sipStack.isDialogCreated(g)&&g==this.getMethod()){this.setLocalTag(e.getTo().getTag());f=true}if(c/100!=2){if(c/100==1){if(f){this.setState(this.EARLY_STATE);this.setDialogId(e.getDialogId(true));this.sipStack.putDialog(this)}}else{if(!this.isReInvite()&&this.getState()!=this.CONFIRMED){this.setState(SIPDialog.TERMINATED_STATE)}}}else{if(this.dialogState<=this.EARLY_STATE&&(g=="INVITE"||g=="SUBSCRIBE"||g=="REFER")){this.setState(this.CONFIRMED_STATE)}if(f){this.setDialogId(e.getDialogId(true));this.sipStack.putDialog(this)}}}}};SIPDialog.prototype.getDialogId=function(){if(this.dialogId==null&&this.lastResponse!=null){this.dialogId=this.lastResponse.getDialogId(this.isServer())}return this.dialogId};SIPDialog.prototype.isAssignedFunction=function(){return this.isAssigned};SIPDialog.prototype.setResponseTags=function(b){if(this.getLocalTag()!=null||this.getRemoteTag()!=null){return}var a=b.getFromTag();if(a!=null){if(a==this.getLocalTag()){b.setToTag(this.getRemoteTag())}else{if(a==this.getRemoteTag()){b.setToTag(this.getLocalTag())}}}};SIPDialog.prototype.getSipProvider=function(){return this.sipProvider};SIPDialog.prototype.sendAck=function(e){var f=e;if(!f.getMethod()=="ACK"){console.error("SIPDialog:sendAck(): bad request method -- should be ACK");throw"SIPDialog:sendAck(): bad request method -- should be ACK"}if(this.getState()==null||this.getState()=="EARLY"){console.error("SIPDialog:sendAck(): bad dialog state "+this.getState());throw"SIPDialog:sendAck(): bad dialog state "+this.getState()}if(this.getCallId().getCallId()!=e.getCallId().getCallId()){console.error("SIPDialog:sendAck(): bad call ID in request");throw"SIPDialog:sendAck(): bad call ID in request"}try{if(this.getLocalTag()!=null){f.getFrom().setTag(this.getLocalTag())}if(this.getRemoteTag()!=null){f.getTo().setTag(this.getRemoteTag())}}catch(c){console.error("SIPDialog:sendAck(): catched exception:"+c);throw"SIPDialog:sendAck(): catched exception:"+c}var a=this.sipStack.getNextHop(f);if(a==null){console.error("SIPDialog:sendAck(): no route!");throw"SIPDialog:sendAck(): no route!"}var b=this.sipProvider.getListeningPoint(a.getTransport());if(b==null){console.error("SIPDialog:sendAck(): no listening point for this provider registered at "+a+"; transport == "+a.getTransport());throw"SIPDialog:sendAck(): no listening point for this provider registered at "+a+"; transport == "+a.getTransport()}var d=b.getMessageProcessor().getMessageChannel();this.setLastAckSent(f);d.sendMessage(f);this.isAcknowledged=true;this.highestSequenceNumberAcknowledged=Math.max(this.highestSequenceNumberAcknowledged,f.getCSeq().getSeqNumber());if(this.dialogDeleteTask!=null){}this.ackSeen=true};SIPDialog.prototype.getRemoteTag=function(){return this.hisTag};SIPDialog.prototype.isServer=function(){if(this.firstTransactionSeen==false){return this.serverTransactionFlag}else{return this.firstTransactionIsServerTransaction}};SIPDialog.prototype.addTransaction=function(b){var a=b.getOriginalRequest();if(this.firstTransactionSeen&&this.firstTransactionId!=(b.getBranchId())&&b.getMethod()==this.firstTransactionMethod){this.reInviteFlag=true}if(this.firstTransactionSeen==false){this.storeFirstTransactionInfo(this,b);if(a.getMethod()=="SUBSCRIBE"){this.eventHeader=a.getHeader("Event")}this.setLocalParty(a);this.setRemoteParty(a);this.setCallId(a);if(this.originalRequest==null){this.originalRequest=a}if(this.method==null){this.method=a.getMethod()}if(b instanceof SIPServerTransaction){this.hisTag=a.getFrom().getTag()}else{this.setLocalSequenceNumber(a.getCSeq().getSeqNumber());this.originalLocalSequenceNumber=this.localSequenceNumber;this.myTag=a.getFrom().getTag()}}else{if(b.getMethod()==this.firstTransactionMethod&&this.firstTransactionIsServerTransaction!=b.isServerTransaction()){this.storeFirstTransactionInfo(this,b);this.setLocalParty(a);this.setRemoteParty(a);this.setCallId(a);this.originalRequest=a;this.method=a.getMethod()}}if(b instanceof SIPServerTransaction){this.setRemoteSequenceNumber(a.getCSeq().getSeqNumber())}this.lastTransaction=b};SIPDialog.prototype.storeFirstTransactionInfo=function(d,f){d.firstTransaction=f;d.firstTransactionSeen=true;d.firstTransactionIsServerTransaction=f.isServerTransaction();d.firstTransactionSecure=true;d.firstTransactionId=f.getBranchId();d.firstTransactionMethod=f.getMethod();if(d.isServer()){var b=f;var a=b.getLastResponse();d.contactHeader=a!=null?a.getContactHeader():null}else{var c=f;if(c!=null){var e=c.getOriginalRequest();d.contactHeader=e.getContactHeader()}}};SIPDialog.prototype.setLocalParty=function(a){if(!this.isServer()){this.localParty=a.getFrom().getAddress()}else{this.localParty=a.getTo().getAddress()}};SIPDialog.prototype.setRemoteParty=function(a){if(!this.isServer()){this.remoteParty=a.getTo().getAddress()}else{this.remoteParty=a.getFrom().getAddress()}};SIPDialog.prototype.setCallId=function(a){this.callIdHeader=a.getCallId()};SIPDialog.prototype.setLocalSequenceNumber=function(a){this.localSequenceNumber=a};SIPDialog.prototype.getLocalParty=function(){return this.localParty};SIPDialog.prototype.getRemoteParty=function(){return this.remoteParty};SIPDialog.prototype.addEventListener=function(b){var a=null;for(var c=0;c<this.eventListeners;c++){if(this.eventListeners[c]==b){a=c}}if(a==null){this.eventListeners.push(b)}};SIPDialog.prototype.setAssigned=function(){this.isAssigned=true};SIPDialog.prototype.testAndSetIsDialogTerminatedEventDelivered=function(){var a=this.dialogTerminatedEventDelivered;this.dialogTerminatedEventDelivered=true;return a};SIPDialog.prototype.getFirstTransaction=function(){return this.firstTransaction};SIPDialog.prototype.isClientDialog=function(){var a=this.getFirstTransaction();if(a instanceof SIPClientTransaction){return true}else{return false}};SIPDialog.prototype.addRoute=function(){if(arguments[0] instanceof SIPResponse){var c=arguments[0];this.addRouteResponse(c)}else{if(arguments[0] instanceof SIPRequest){var a=arguments[0];this.addRouteRequest(a)}else{var b=arguments[0];this.addRouteList(b)}}};SIPDialog.prototype.addRouteResponse=function(c){if(c.getStatusCode()==100){return}else{if(this.dialogState==2){return}else{if(this.dialogState==1){if(200<=c.getStatusCode()&&c.getStatusCode()<=299&&!this.isServer()){var a=c.getContactHeaders();if(a!=null&&SIPRequest.prototype.isTargetRefresh(c.getCSeq().getMethod())){this.setRemoteTarget(a.getFirst())}}return}}}if(!this.isServer()){if(this.getState()!="CONFIRMED"&&this.getState()!="TERMINATED"){var b=c.getRecordRouteHeaders();if(b!=null){this.addRoute(b)}else{this.routeList=new RouteList()}}if(a!=null){this.setRemoteTarget(a.getFirst())}}};SIPDialog.prototype.addRouteRequest=function(b){if(this.dialogState=="CONFIRMED"&&SIPRequest.prototype.isTargetRefresh(b.getMethod())){this.doTargetRefresh(b)}if(this.dialogState=="CONFIRMED"||this.dialogState=="TERMINATED"){return}if(b.getToTag()!=null){return}var c=b.getRecordRouteHeaders();if(c!=null){this.addRoute(c)}else{this.routeList=new RouteList()}var a=b.getContactHeaders();if(a!=null){this.setRemoteTarget(a.getFirst())}};SIPDialog.prototype.addRouteList=function(d){if(this.isClientDialog()){this.routeList=new RouteList();for(var c=d.getHeaderList().length-1;c>=0;c--){var b=d.getHeaderList()[c];var a=new Route();a.setAddress(b.getAddress());a.setParameters(b.getParameters());this.routeList.add(a)}}else{this.routeList=new RouteList();for(c=0;c<d.getHeaderList().length;c++){var b=d.getHeaderList()[c];var a=new Route();a.setAddress(b.getAddress());a.setParameters(b.getParameters());this.routeList.add(a)}}};SIPDialog.prototype.setRemoteTarget=function(a){this.remoteTarget=a.getAddress()};SIPDialog.prototype.getRouteList=function(){return this.routeList};SIPDialog.prototype.setRouteList=function(a){this.routeList=a};SIPDialog.prototype.setStack=function(a){this.sipStack=a};SIPDialog.prototype.getStack=function(){return this.sipStack};SIPDialog.prototype.removeEventListener=function(b){var a=null;for(var c=0;c<this.eventListeners.length;c++){if(this.eventListeners[c]==b){a=c}}this.eventListeners.splice(a,1)};SIPDialog.prototype.setApplicationData=function(a){this.applicationData=a};SIPDialog.prototype.getApplicationData=function(){return this.applicationData};SIPDialog.prototype.requestConsumed=function(){this.nextSeqno=this.getRemoteSeqNumber()+1};SIPDialog.prototype.isRequestConsumable=function(a){if(a.getMethod()=="ACK"){console.error("SIPDialog:isRequestConsumable(): Illegal method");throw"SIPDialog:isRequestConsumable(): Illegal method"}if(!this.isSequnceNumberValidation()){return true}if(Number(this.remoteSequenceNumber)<=Number(a.getCSeq().getSeqNumber())){return true}else{return false}};SIPDialog.prototype.doDeferredDelete=function(){var a=this;this.timer=setTimeout(function(){a.deferredDeleteTimeout()},this.TIMER_H*this.BASE_TIMER_INTERVAL)};SIPDialog.prototype.isAckSent=function(a){if(this.getLastTransaction()==null){return true}if(this.getLastTransaction() instanceof SIPClientTransaction){if(this.getLastAckSent()==null){return false}else{return a<=this.getLastAckSent().getCSeq().getSeqNumber()}}else{return true}};SIPDialog.prototype.getRouteSet=function(){if(this.routeList==null){this.routeList=new Array();return this.routeList}else{return this.getRouteList()}};SIPDialog.prototype.setDialogId=function(a){this.dialogId=a};SIPDialog.prototype.createFromNOTIFY=function(e,a){var c=new SIPDialog(a);c.serverTransactionFlag=false;c.lastTransaction=e;storeFirstTransactionInfo(c,e);c.terminateOnBye=false;c.localSequenceNumber=e.getCSeq();var b=a.getRequest();c.remoteSequenceNumber=b.getCSeq().getSeqNumber();c.setDialogId(b.getDialogId(true));c.setLocalTag(b.getToTag());c.setRemoteTag(b.getFromTag());c.setLastResponse(e,e.getLastResponse());c.localParty=b.getTo().getAddress();c.remoteParty=b.getFrom().getAddress();c.addRoute(b);c.setState(this.CONFIRMED_STATE);return c};SIPDialog.prototype.isReInvite=function(){return this.reInviteFlag};SIPDialog.prototype.setRemoteTag=function(a){if(this.hisTag!=null&&a!=null&&a!=this.hisTag){if(this.getState()!="EARLY"){return}else{if(this.sipStack.isRemoteTagReassignmentAllowed()){var b=false;if(this.sipStack.getDialog(this.dialogId)==this){this.sipStack.removeDialog(this);b=true}this.dialogId=null;this.hisTag=a;if(b){this.sipStack.putDialog(this)}}}}else{if(a!=null){this.hisTag=a}}};SIPDialog.prototype.getLastTransaction=function(){return this.lastTransaction};SIPDialog.prototype.getInviteTransaction=function(){return this.inviteTransaction};SIPDialog.prototype.setInviteTransaction=function(a){this.inviteTransaction=a};SIPDialog.prototype.setLocalSequenceNumber=function(a){if(a<=this.localSequenceNumber){console.error("SIPDialog:setLocalSequenceNumber(): sequence number should not decrease !");throw"SIPDialog:setLocalSequenceNumber(): sequence number should not decrease !"}this.localSequenceNumber=a};SIPDialog.prototype.setRemoteSequenceNumber=function(a){this.remoteSequenceNumber=a};SIPDialog.prototype.incrementLocalSequenceNumber=function(){++this.localSequenceNumber};SIPDialog.prototype.getOriginalLocalSequenceNumber=function(){return this.originalLocalSequenceNumber};SIPDialog.prototype.getLocalSeqNumber=function(){return this.localSequenceNumber};SIPDialog.prototype.getRemoteSeqNumber=function(){return this.remoteSequenceNumber};SIPDialog.prototype.setLocalTag=function(a){this.myTag=a};SIPDialog.prototype.getCallId=function(){return this.callIdHeader};SIPDialog.prototype.getRemoteTarget=function(){return this.remoteTarget};SIPDialog.prototype.isSecure=function(){return this.firstTransactionSecure};SIPDialog.prototype.createRequest=function(){if(arguments.length==1){var b=arguments[0];return this.createRequestargu1(b)}else{b=arguments[0];var a=arguments[1];return this.createRequestargu2(b,a)}};SIPDialog.prototype.createRequestargu1=function(a){if(a=="ACK"){console.error("SIPDialog:createRequestargu1(): invalid method specified for createRequest:"+a);throw"SIPDialog:createRequestargu1(): invalid method specified for createRequest:"+a}if(this.lastResponse!=null){return this.createRequest(a,this.lastResponse)}else{console.error("SIPDialog:createRequestargu1(): dialog not yet established -- no response!");throw"SIPDialog:createRequestargu1(): dialog not yet established -- no response!"}};SIPDialog.prototype.createRequestargu2=function(a,e){if(a==null||e==null){console.error("SIPDialog:createRequestargu2(): null argument");throw"SIPDialog:createRequestargu2(): null argument"}if(a=="CANCEL"){console.error("SIPDialog:createRequestargu2(): invalid request");throw"SIPDialog:createRequestargu2(): invalid request"}if(this.getState()==null||(this.getState()=="TERMINATED"&&a.toUpperCase()!="BYE")||(this.isServer()&&this.getState()=="EARLY"&&a.toUpperCase()=="BYE")){console.error("SIPDialog:createRequestargu2(): dialog  "+this.getDialogId()+" not yet established or terminated "+this.getState());throw"SIPDialog:createRequestargu2(): dialog  "+this.getDialogId()+" not yet established or terminated "+this.getState()}var c=null;if(this.isServer()){var g=this.getInviteTransaction().getOriginalRequest().getContactHeader();c=g.getAddress().getURI()}else{c=e.getContactHeader().getAddress().getURI()}var b=new CSeq();b.setMethod(a);b.setSeqNumber(this.getLocalSeqNumber()+1);if(a=="SUBSCRIBE"){if(this.eventHeader!=null){f.addHeader(this.eventHeader)}}var d=this.sipProvider.getListeningPoint(e.getTopmostVia().getTransport());if(d==null){console.error("SIPDialog:createRequestargu2(): cannot find listening point for transport "+e.getTopmostVia().getTransport());throw"SIPDialog:createRequestargu2(): cannot find listening point for transport "+e.getTopmostVia().getTransport()}var j=d.getViaHeader();var i=new From();i.setAddress(this.localParty);var h=new To();h.setAddress(this.remoteParty);if(this.getLocalTag()!=null){i.setTag(this.getLocalTag())}else{i.removeTag()}if(this.getRemoteTag()!=null){h.setTag(this.getRemoteTag())}else{h.removeTag()}var f=e.createRequest(c,j,b,i,h);if(SIPRequest.prototype.isTargetRefresh(a)){var g=this.sipProvider.getListeningPoint(e.getTopmostVia().getTransport()).createContactHeader();g.getAddress().getURI().setSecure(this.isSecure());f.setHeader(g)}this.updateRequest(f);return f};SIPDialog.prototype.sendRequest=function(e){var f=e.getOriginalRequest();if(e==null){console.error("SIPDialog:sendRequest(): null parameter");throw"SIPDialog:sendRequest(): null parameter"}if(f.getMethod()=="ACK"||f.getMethod()=="CANCEL"){console.error("SIPDialog:sendRequest(): bad request method. "+f.getMethod());throw"SIPDialog:sendRequest(): bad request method. "+f.getMethod()}if(this.byeSent&&this.isTerminatedOnBye()&&f.getMethod()!="BYE"){console.error("SIPDialog:sendRequest(): cannot send request; BYE already sent");throw"SIPDialog:sendRequest(): cannot send request; BYE already sent"}if(f.getTopmostVia()==null){var a=e.getOutgoingViaHeader();f.addHeader(a)}if(this.getCallId().getCallId().toLowerCase()!=f.getCallId().getCallId().toLowerCase()){console.error("SIPDialog:sendRequest(): bad call ID in request");throw"SIPDialog:sendRequest(): bad call ID in request"}e.setDialog(this,this.dialogId);this.addTransaction(e);e.isMapped=true;var h=f.getFrom();var g=f.getTo();if(this.getLocalTag()!=null&&h.getTag()!=null&&h.getTag()!=this.getLocalTag()){console.error("SIPDialog:sendRequest(): from tag mismatch expecting  "+this.getLocalTag());throw"SIPDialog:sendRequest(): from tag mismatch expecting  "+this.getLocalTag()}if(this.getLocalTag()==null&&f.getMethod()=="NOTIFY"){if(this.getMethod()!="SUBSCRIBE"){console.error("SIPDialog:sendRequest(): trying to send NOTIFY without SUBSCRIBE Dialog!");throw"SIPDialog:sendRequest(): trying to send NOTIFY without SUBSCRIBE Dialog!"}this.setLocalTag(h.getTag())}if(this.getLocalTag()!=null){h.setTag(this.getLocalTag())}if(this.getRemoteTag()!=null){g.setTag(this.getRemoteTag())}var d=this.sipStack.getChannel();if(d==null){var c=this.sipStack.getRouter(f).getOutboundProxy();if(c==null){console.error("SIPDialog:sendRequest(): no route found!");throw"SIPDialog:sendRequest(): no route found!"}d=this.sipStack.createRawMessageChannel(this.getSipProvider().getListeningPoint(c.getTransport()).getHostAddress(),this.firstTransactionPort,c);if(d!=null){e.setEncapsulatedChannel(d)}}else{e.setEncapsulatedChannel(d)}if(d!=null){d.useCount++}f.getCSeq().setSeqNumber(this.getLocalSeqNumber());try{e.sendMessage(f);if(f.getMethod()=="BYE"){this.byeSent=true;if(this.isTerminatedOnBye()){this.setState(this.TERMINATED_STATE)}}}catch(b){console.error("SIPDialog:sendRequest():  catched execption, error sending message",b);throw"SIPDialog:sendRequest():  catched execption, error sending message"}};SIPDialog.prototype.startTimer=function(b){if(this.dialogTransactionTimeout==b){return}this.ackSeen=false;if(this.dialogTransactionTimeout!=null){this.dialogTransactionTimeout=b}else{this.dialogTransactionTimeout=b;var a=this;this.timer=a.timer=setInterval(function(){a.dialogTimeout()},a.BASE_TIMER_INTERVAL);console.error("SIPDialog:startTimer(): that.timer=setInterval()="+this.timer)}};SIPDialog.prototype.stopTimer=function(){if(this.dialogTransactionTimeout!=null){clearInterval(this.timer);this.dialogTransactionTimeout=null}};SIPDialog.prototype.updateRequest=function(a){var b=this.getRouteList();if(!b.isEmpty()){a.setHeader(b)}else{a.removeHeader("Route")}if(MessageFactoryImpl.prototype.getDefaultUserAgentHeader()!=null){a.setHeader(MessageFactoryImpl.prototype.getDefaultUserAgentHeader())}};SIPDialog.prototype.createAck=function(e){if(this.method!="INVITE"){console.error("SIPDialog:createAck(): dialog was not created with an INVITE"+this.method);throw"SIPDialog:createAck(): dialog was not created with an INVITE"+this.method}if(e<=0){console.error("SIPDialog:createAck(): bad cseq <= 0");throw"SIPDialog:createAck(): bad cseq <= 0"}if(this.remoteTarget==null){console.error("SIPDialog:createAck(): cannot create ACK - no remote Target!");throw"SIPDialog:createAck(): cannot create ACK - no remote Target!"}if(this.lastInviteOkReceived<e){console.error("SIPDialog:createAck(): dialog not yet established -- no OK response!");throw"SIPDialog:createAck(): dialog not yet established -- no OK response!"}try{var l=null;if(this.routeList!=null&&!this.routeList.isEmpty()){var a=this.routeList.getFirst();l=a.getAddress().getURI()}else{l=this.remoteTarget.getURI()}var b=l.getTransportParam();if(b==null){b="WSS"}var f=this.sipProvider.getListeningPoint(b);if(f==null){console.error("SIPDialog:createAck(): cannot create ACK - no ListeningPoint for transport towards next hop found:"+b);throw"SIPDialog:createAck(): cannot create ACK - no ListeningPoint for transport towards next hop found:"+b}var i=new SIPRequest();i.setMethod("ACK");i.setRequestURI(getRemoteTarget().getURI());i.setCallId(this.callIdHeader);i.setCSeq(new CSeq(e,"ACK"));var c=new Array();var m=this.lastResponse.getTopmostVia();m.removeParameters();if(this.originalRequest!=null&&this.originalRequest.getTopmostVia()!=null){var d=this.originalRequest.getTopmostVia().getParameters();if(d!=null&&d.size()>0){m.setParameters(d.clone())}}m.setBranch(Utils.prototype.generateBranchId());c.add(m);i.setVia(c);var k=new From();k.setAddress(this.localParty);k.setTag(this.myTag);i.setFrom(k);var j=new To();j.setAddress(this.remoteParty);if(this.hisTag!=null){j.setTag(this.hisTag)}i.setTo(j);i.setMaxForwards(new MaxForwards(70));if(this.originalRequest!=null){var g=this.originalRequest.getAuthorization();if(g!=null){i.setHeader(g)}}this.updateRequest(i);return i}catch(h){console.error("SIPDialog:createAck(): catched unexpected exception ",h);throw"SIPDialog:createAck(): catched unexpected exception"}};SIPDialog.prototype.setSipProvider=function(a){this.sipProvider=a};SIPDialog.prototype.doTargetRefresh=function(c){var b=c.getContactHeaders();if(b!=null){var a=b.getFirst();this.setRemoteTarget(a)}};SIPDialog.prototype.createReliableProvisionalResponse=function(e){if(!(this.firstTransactionIsServerTransaction)){console.error("SIPDialog:createReliableProvisionalResponse(): not a Server Dialog!");throw"SIPDialog:createReliableProvisionalResponse(): not a Server Dialog!"}if(e<=100||e>199){console.error("SIPDialog:createReliableProvisionalResponse(): bad status code ");throw"SIPDialog:createReliableProvisionalResponse(): bad status code "}var f=this.originalRequest;if(f.getMethod()!="INVITE"){console.error("SIPDialog:createReliableProvisionalResponse(): bad method");throw"SIPDialog:createReliableProvisionalResponse(): bad method"}var g=f.getHeaders("Supported");if(g==null&&!optionPresent(g,"100rel")){g=f.getHeaders("Require");if(g==null&&!optionPresent(g,"100rel")){console.error("SIPDialog:createReliableProvisionalResponse(): no Supported/Require 100rel header in the request");throw"SIPDialog:createReliableProvisionalResponse(): no Supported/Require 100rel header in the request"}}var b=f.createResponse(e);var c=new Require();c.setOptionTag("100rel");b.addHeader(c);var a=new RSeq();a.setSeqNumber("1L");var d=f.getRecordRouteHeaders();if(d!=null){var h=d;b.setHeader(h)}return b};SIPDialog.prototype.sendReliableProvisionalResponse=function(g){if(!this.isServer()){console.error("SIPDialog:sendReliableProvisionalResponse(): not a Server Dialog!");throw"SIPDialog:sendReliableProvisionalResponse(): not a Server Dialog!"}var h=g;if(g.getStatusCode()==100){console.error("SIPDialog:sendReliableProvisionalResponse(): cannot send 100 as a reliable provisional response");throw"SIPDialog:sendReliableProvisionalResponse(): cannot send 100 as a reliable provisional response"}if(g.getStatusCode()/100>2){console.error("SIPDialog:sendReliableProvisionalResponse(): response code is not a 1xx response - should be in the range 101 to 199 ");throw"SIPDialog:sendReliableProvisionalResponse(): response code is not a 1xx response - should be in the range 101 to 199 "}if(h.getToTag()==null){console.error("SIPDialog:sendReliableProvisionalResponse(): badly formatted response -- To tag mandatory for Reliable Provisional Response");throw"SIPDialog:sendReliableProvisionalResponse(): badly formatted response -- To tag mandatory for Reliable Provisional Response"}var c=g.getHeaders("Require");var f=false;if(c!=null){for(var d=0;d<c.length&&!f;d++){var a=c[d];if(a.getOptionTag().toLowerCase()=="100rel"){f=true}}}if(!f){var b=new Require("100rel");g.addHeader(b)}var e=this.getFirstTransaction();this.setLastResponse(e,h);this.setDialogId(h.getDialogId(true));e.sendReliableProvisionalResponse(g)};SIPDialog.prototype.terminateOnBye=function(a){this.terminateOnBye=a};SIPDialog.prototype.getMyContactHeader=function(){return this.contactHeader};SIPDialog.prototype.handleAck=function(){return true};SIPDialog.prototype.setEarlyDialogId=function(a){this.earlyDialogId=a};SIPDialog.prototype.getEarlyDialogId=function(){return this.earlyDialogId};SIPDialog.prototype.optionPresent=function(a,d){for(var c=0;c<a.length;c++){var b=a[c];if(b!=null&&d.toLowerCase()==b.getOptionTag().toLowerCase()){return true}}return false};SIPDialog.prototype.setLastAckReceived=function(a){this.lastAckReceived=a};SIPDialog.prototype.getLastAckReceived=function(){return this.lastAckReceived};SIPDialog.prototype.setLastAckSent=function(a){this.lastAckSent=a};SIPDialog.prototype.isAtleastOneAckSent=function(){return this.isAcknowledged};SIPDialog.prototype.isBackToBackUserAgent=function(){return this.isBackToBackUserAgent};SIPDialog.prototype.doDeferredDeleteIfNoAckSent=function(b){if(this.dialogDeleteIfNoAckSentTimer==null){var a=this;this.dialogDeleteIfNoAckSentTimer=setTimeout(function(){a.deleteIfNoAckSentTimeout(b)},this.TIMER_J*this.BASE_TIMER_INTERVAL)}};SIPDialog.prototype.setBackToBackUserAgent=function(){this.isBackToBackUserAgent=true};SIPDialog.prototype.getEventHeader=function(){return this.eventHeader};SIPDialog.prototype.setEventHeader=function(a){this.eventHeader=a};SIPDialog.prototype.setServerTransactionFlag=function(a){this.serverTransactionFlag=a};SIPDialog.prototype.setReInviteFlag=function(a){this.reInviteFlag=a};SIPDialog.prototype.isSequnceNumberValidation=function(){return this.sequenceNumberValidation};SIPDialog.prototype.disableSequenceNumberValidation=function(){this.sequenceNumberValidation=false};SIPDialog.prototype.raiseErrorEvent=function(d){var a=null;var c=new SIPDialogErrorEvent(this,d);for(var b=0;b<this.eventListeners.length;b++){a=this.eventListeners[b];a.dialogErrorEvent(c)}this.eventListeners=new Array();if(d!=SIPDialogErrorEvent.DIALOG_ACK_NOT_SENT_TIMEOUT&&d!=SIPDialogErrorEvent.DIALOG_ACK_NOT_RECEIVED_TIMEOUT&&d!=SIPDialogErrorEvent.DIALOG_REINVITE_TIMEOUT){this.delet()}this.stopTimer()};function SIPDialogErrorEvent(a,b){this.classname="SIPDialogErrorEvent";this.errorID=b;this.source=a}SIPDialogErrorEvent.prototype.DIALOG_ACK_NOT_RECEIVED_TIMEOUT=1;SIPDialogErrorEvent.prototype.DIALOG_ACK_NOT_SENT_TIMEOUT=2;SIPDialogErrorEvent.prototype.DIALOG_REINVITE_TIMEOUT=3;SIPDialogErrorEvent.prototype.getErrorID=function(){return this.errorID};SIPDialogErrorEvent.prototype.getSource=function(){return this.source};function SIPDialogEventListener(a){this.classname="SIPDialogEventListener"}SIPDialogEventListener.prototype.dialogErrorEvent=function(){};function SIPTransaction(b,a){this.classname="SIPTransaction";this.toListener=null;this.applicationData=null;this.lastResponse=null;this.isMapped=null;this.transactionId=null;this.auditTag=0;this.sipStack=b;this.originalRequest=null;this.encapsulatedChannel=a;this.disableTimeoutTimer();this.eventListeners=new Array();this.addEventListener(b);this.transactionTimerStarted=false;this.branch=null;this.method=null;this.cSeq=null;this.currentState=null;this.timeoutTimerTicksLeft=null;this.from=null;this.to=null;this.event=null;this.callId=null;this.collectionTime=null;this.toTag=null;this.fromTag=null;this.terminatedEventDelivered=null}SIPTransaction.prototype.constructor=SIPTransaction;SIPTransaction.prototype.BASE_TIMER_INTERVAL=500;SIPTransaction.prototype.T4=5000/SIPTransaction.prototype.BASE_TIMER_INTERVAL;SIPTransaction.prototype.T2=4000/SIPTransaction.prototype.BASE_TIMER_INTERVAL;SIPTransaction.prototype.TIMER_I=SIPTransaction.prototype.T4;SIPTransaction.prototype.TIMER_K=SIPTransaction.prototype.T4;SIPTransaction.prototype.TIMER_D=32000/SIPTransaction.prototype.BASE_TIMER_INTERVAL;SIPTransaction.prototype.T1=1;SIPTransaction.prototype.TIMER_A=1;SIPTransaction.prototype.TIMER_B=64;SIPTransaction.prototype.TIMER_J=64;SIPTransaction.prototype.TIMER_F=64;SIPTransaction.prototype.TIMER_H=64;SIPTransaction.prototype.INITIAL_STATE=null;SIPTransaction.prototype.TRYING_STATE="TRYING";SIPTransaction.prototype.CALLING_STATE="CALLING";SIPTransaction.prototype.PROCEEDING_STATE="PROCEEDING";SIPTransaction.prototype.COMPLETED_STATE="COMPLETED";SIPTransaction.prototype.CONFIRMED_STATE="CONFIRMED";SIPTransaction.prototype.TERMINATED_STATE="TERMINATED";SIPTransaction.prototype.MAXIMUM_RETRANSMISSION_TICK_COUNT=8;SIPTransaction.prototype.TIMEOUT_RETRANSMIT=3;SIPTransaction.prototype.CONNECTION_LINGER_TIME=8;SIPTransaction.prototype.lingerTimer=function(){var a=this.getSIPStack();a.removeTransaction(this)};SIPTransaction.prototype.getBranchId=function(){return this.branch};SIPTransaction.prototype.setOriginalRequest=function(a){var b=null;if(this.originalRequest!=null&&(this.originalRequest.getTransactionId()!=a.getTransactionId())){this.sipStack.removeTransactionHash(this)}this.originalRequest=a;this.method=a.getMethod();this.from=a.getFrom();this.to=a.getTo();this.toTag=this.to.getTag();this.fromTag=this.from.getTag();this.callId=a.getCallId();this.cSeq=a.getCSeq().getSeqNumber();this.event=a.getHeader("Event");this.transactionId=a.getTransactionId();this.originalRequest.setTransaction(this);b=a.getViaHeaders().getFirst().getBranch();if(b!=null){this.setBranch(b)}else{this.setBranch(a.getTransactionId())}};SIPTransaction.prototype.getOriginalRequest=function(){return this.originalRequest};SIPTransaction.prototype.getRequest=function(){return this.originalRequest};SIPTransaction.prototype.isInviteTransaction=function(){if(this.getMethod()=="INVITE"){return true}else{return false}};SIPTransaction.prototype.isCancelTransaction=function(){if(this.getMethod()=="CANCEL"){return true}else{return false}};SIPTransaction.prototype.isByeTransaction=function(){if(this.getMethod()=="BYE"){return true}else{return false}};SIPTransaction.prototype.getMessageChannel=function(){return this.encapsulatedChannel};SIPTransaction.prototype.setBranch=function(a){this.branch=a};SIPTransaction.prototype.getBranch=function(){if(this.branch==null){this.branch=this.getOriginalRequest().getTopmostVia().getBranch()}return this.branch};SIPTransaction.prototype.getMethod=function(){return this.method};SIPTransaction.prototype.getCSeq=function(){return this.cSeq};SIPTransaction.prototype.setState=function(a){if(this.currentState=="COMPLETED"){if(a!="TERMINATED"&&a!="CONFIRMED"){a="COMPLETED"}}if(this.currentState=="CONFIRMED"){if(a!="TERMINATED"){a="CONFIRMED"}}if(this.currentState!="TERMINATED"){this.currentState=a}else{a=this.currentState}currentState=a};SIPTransaction.prototype.getState=function(){return this.currentState};SIPTransaction.prototype.enableTimeoutTimer=function(a){this.timeoutTimerTicksLeft=a};SIPTransaction.prototype.disableTimeoutTimer=function(){this.timeoutTimerTicksLeft=-1};SIPTransaction.prototype.fireTimer=function(){if(this.timeoutTimerTicksLeft!=-1){if(--this.timeoutTimerTicksLeft==0){this.fireTimeoutTimer()}}};SIPTransaction.prototype.isTerminated=function(){if(this.getState()=="TERMINATED"){return true}else{return false}};SIPTransaction.prototype.getKey=function(){return this.encapsulatedChannel.getKey()};SIPTransaction.prototype.getSIPStack=function(){return this.sipStack};SIPTransaction.prototype.getTransport=function(){return this.encapsulatedChannel.getTransport()};SIPTransaction.prototype.isReliable=function(){return true};SIPTransaction.prototype.getViaHeader=function(){var a=WSMessageChannel.prototype.getViaHeader.call(this);a.setBranch(this.branch);return a};SIPTransaction.prototype.sendMessage=function(a){this.encapsulatedChannel.sendMessage(a)};SIPTransaction.prototype.addEventListener=function(b){if(b){var a=null;for(var c=0;c<this.eventListeners.length;c++){if(this.eventListeners[c]==b){a=c}}if(a==null){this.eventListeners.push(b)}}};SIPTransaction.prototype.removeEventListener=function(b){var a=null;for(var c=0;c<this.eventListeners.length;c++){if(this.eventListeners[c]==b){this.eventListeners.splice(a,1);return}}};SIPTransaction.prototype.raiseErrorEvent=function(a){var b=null;var d=new SIPTransactionErrorEvent(this,a);for(var c=0;c<this.eventListeners.length;c++){b=this.eventListeners[c];b.transactionErrorEvent(d)}if(a!=this.TIMEOUT_RETRANSMIT){this.eventListeners=new Array();this.setState("TERMINATED");if(this instanceof SIPServerTransaction&&this.isByeTransaction()&&this.getDialog()!=null){this.getDialog().setState("TERMINATED")}}};SIPTransaction.prototype.isServerTransaction=function(){if(this instanceof SIPServerTransaction){return true}else{return false}};SIPTransaction.prototype.getDialog=function(){};SIPTransaction.prototype.setDialog=function(b,a){};SIPTransaction.prototype.getViaHost=function(){return this.getViaHeader().getHost()};SIPTransaction.prototype.getLastResponse=function(){return this.lastResponse};SIPTransaction.prototype.getResponse=function(){return this.lastResponse};SIPTransaction.prototype.getTransactionId=function(){return this.transactionId};SIPTransaction.prototype.hashCode=function(){if(this.transactionId==null){return -1}else{var d=0;var a=this.transactionId;if(!(a==null||a.value=="")){for(var b=0;b<a.length;b++){d=d*31+a.charCodeAt(b);var c=2147483647;var e=-2147483648;if(d>c||d<e){d&=4294967295}}}return d}};SIPTransaction.prototype.getViaPort=function(){return this.getViaHeader().getPort()};SIPTransaction.prototype.getPort=function(){return this.encapsulatedChannel.getPort()};SIPTransaction.prototype.doesCancelMatchTransaction=function(e){var c;var a;var d;var b=false;if(this.getOriginalRequest()==null||this.getMethod()=="CANCEL"){return false}c=e.getViaHeaders();if(c!=null){a=c.getFirst();d=a.getBranch();if(d!=null){if(d.toLowerCase().substring(0,7)!="z9hg4bk"){d=null}}if(d!=null&&this.getBranch()!=null){if(((this.getBranch().toLowerCase()==d.toLowerCase())&&(a.getSentBy().equals(this.getOriginalRequest().getViaHeaders().getFirst().getSentBy())))||(e.getCallId().toString()==this.getOriginalRequest().getCallId())){b=true}}else{if(this.getOriginalRequest().getRequestURI()==e.getRequestURI()&&this.getOriginalRequest().getTo()==e.getTo()&&this.getOriginalRequest().getFrom()==e.getFrom()&&this.getOriginalRequest().getCallId().getCallId()==e.getCallId().getCallId()&&this.getOriginalRequest().getCSeq().getSeqNumber()==e.getCSeq().getSeqNumber()&&a==this.getOriginalRequest().getViaHeaders().getFirst()){b=true}}}if(b){this.setPassToListener()}return b};SIPTransaction.prototype.close=function(){this.encapsulatedChannel.close()};SIPTransaction.prototype.isSecure=function(){return this.encapsulatedChannel.isSecure()};SIPTransaction.prototype.getMessageProcessor=function(){return this.encapsulatedChannel.getMessageProcessor()};SIPTransaction.prototype.setApplicationData=function(a){this.applicationData=a};SIPTransaction.prototype.getApplicationData=function(){return this.applicationData};SIPTransaction.prototype.setEncapsulatedChannel=function(a){this.encapsulatedChannel=a};SIPTransaction.prototype.getSipProvider=function(){return this.getMessageProcessor().getListeningPoint().getProvider()};SIPTransaction.prototype.raiseIOExceptionEvent=function(){this.setState("TERMINATED")};SIPTransaction.prototype.passToListener=function(){return this.toListener};SIPTransaction.prototype.setPassToListener=function(){this.toListener=true};SIPTransaction.prototype.testAndSetTransactionTerminatedEvent=function(){var a=!this.terminatedEventDelivered;this.terminatedEventDelivered=true;return a};SIPTransaction.prototype.startTransactionTimer=function(){};SIPTransaction.prototype.isMessagePartOfTransaction=function(){};function SIPClientTransaction(b,a){this.classname="SIPClientTransaction";this.encapsulatedChannel=a;this.wsurl=this.encapsulatedChannel.wsurl;this.disableTimeoutTimer();this.sipStack=b;this.infoApp=b.infoApp;this.addEventListener(b);this.originalRequest=null;this.setBranch(Utils.prototype.generateBranchId());this.notifyOnRetransmit=false;this.timeoutIfStillInCallingState=false;this.setEncapsulatedChannel(a);this.messageProcessor=a.messageProcessor;this.sipDialogs=new Array();this.lastRequest=null;this.viaPort=null;this.viaHost=null;this.respondTo=null;this.defaultDialog=null;this.nextHop=null;this.callingStateTimeoutCount=null;this.timer=null;this.oldmessage=null}SIPClientTransaction.prototype=new SIPTransaction();SIPClientTransaction.prototype.constructor=SIPClientTransaction;SIPClientTransaction.prototype.BRANCH_MAGIC_COOKIE_LOWER_CASE="z9hg4bk";SIPClientTransaction.prototype.MAXIMUM_RETRANSMISSION_TICK_COUNT=8;SIPClientTransaction.prototype.COMPLETED="COMPLETED";SIPClientTransaction.prototype.PROCEEDING="PROCEEDING";SIPClientTransaction.prototype.CALLING="CALLING";SIPClientTransaction.prototype.TERMINATED="TERMINATED";SIPClientTransaction.prototype.ACK="ACK";SIPClientTransaction.prototype.INVITE="INVITE";SIPClientTransaction.prototype.TRYING="TRYING";SIPClientTransaction.prototype.CANCEL="CANCEL";SIPClientTransaction.prototype.BYE="BYE";SIPClientTransaction.prototype.SUBSCRIBE="SUBSCRIBE";SIPClientTransaction.prototype.NOTIFY="NOTIFY";SIPClientTransaction.prototype.TIMER_B=64;SIPClientTransaction.prototype.TIMER_D=SIPTransaction.prototype.TIMER_D;SIPClientTransaction.prototype.TIMER_F=64;SIPClientTransaction.prototype.TIMER_K=SIPTransaction.prototype.T4;SIPClientTransaction.prototype.TIMER_J=64;SIPClientTransaction.prototype.TimeStampHeader="Timestamp";SIPClientTransaction.prototype.RouteHeader="Route";SIPClientTransaction.prototype.RETRANSMIT="RETRANSMIT";SIPClientTransaction.prototype.TRANSPORT_ERROR=2;SIPClientTransaction.prototype.TIMEOUT_ERROR=1;SIPClientTransaction.prototype.EARLY="EARLY";SIPClientTransaction.prototype.CONNECTION_LINGER_TIME=8;SIPClientTransaction.prototype.BASE_TIMER_INTERVAL=500;SIPClientTransaction.prototype.setResponseInterface=function(a){this.respondTo=a};SIPClientTransaction.prototype.getRequestChannel=function(){return this};SIPClientTransaction.prototype.isMessagePartOfTransaction=function(e){var c=e.getViaHeaders();var b=false;var d=c.getFirst().getBranch();if(this.getBranch()!=null&&d!=null&&this.getBranch().toLowerCase().substring(0,7)==(this.BRANCH_MAGIC_COOKIE_LOWER_CASE)&&d.toLowerCase().substring(0,7)==(this.BRANCH_MAGIC_COOKIE_LOWER_CASE)){var a=true}else{a=false}if(this.COMPLETED==this.getState()){if(a){if(this.getBranch()().toLowerCase()==c.getFirst().getBranch().toLowerCase()&&this.getMethod()==e.getCSeq().getMethod()){b=true}else{b=false}}else{if(this.getBranch()==e.getTransactionId()){b=true}else{b=false}}}else{if(!this.isTerminated()){if(a){if(c!=null){if(this.getBranch().toLowerCase()==c.getFirst().getBranch().toLowerCase()){if(this.getOriginalRequest().getCSeq().getMethod()==e.getCSeq().getMethod()){b=true}else{b=false}}}}else{if(this.getBranch()!=null){if(this.getBranch().toLowerCase()==e.getTransactionId().toLowerCase()){b=true}else{b=false}}else{if(this.getOriginalRequest().getTransactionId().toLowerCase()==e.getTransactionId().toLowerCase()){b=true}else{b=false}}}}}return b};SIPClientTransaction.prototype.sendMessage=function(d){var b=d;var c=b.getViaHeaders().getFirst();c.setBranch(this.getBranch());if(this.PROCEEDING==this.getState()||this.CALLING==this.getState()){if(b.getMethod()==this.ACK){if(this.isReliable()){this.setState(this.TERMINATED)}else{this.setState(this.COMPLETED)}SIPTransaction.prototype.sendMessage.call(this,b);return}}try{this.lastRequest=b;if(this.getState()==null){this.setOriginalRequest(b);if(b.getMethod()==this.INVITE){this.setState(this.CALLING)}else{if(b.getMethod()==this.ACK){this.setState(this.TERMINATED)}else{this.setState(this.TRYING)}}if(this.isInviteTransaction()){this.enableTimeoutTimer(this.TIMER_B)}else{this.enableTimeoutTimer(this.TIMER_F)}}SIPTransaction.prototype.sendMessage.call(this,b)}catch(a){console.error("SIPClientTransaction:sendMessage(): catched exception:"+a);this.setState(this.TERMINATED)}this.isMapped=true;this.startTransactionTimer()};SIPClientTransaction.prototype.processResponse=function(){if(arguments.length==2){var e=arguments[0];var d=arguments[1];this.processResponseargu2(e,d)}else{var a=arguments[0];var c=arguments[1];var b=arguments[2];this.processResponseargu3(a,c,b)}};SIPClientTransaction.prototype.processResponseargu2=function(f,h){var g=null;var a=f.getCSeq().getMethod();var i=f.getDialogId(false);if(a==this.CANCEL&&this.lastRequest!=null){var d=this.lastRequest.getInviteTransaction();if(d!=null){g=d.defaultDialog}}else{g=this.getDialog(i)}if(g==null){var b=f.getStatusCode();if((b>100&&b<300)&&(f.getToTag()!=null||this.sipStack.isRfc2543Supported())&&this.sipStack.isDialogCreated(a)){if(this.defaultDialog!=null){if(f.getFromTag()!=null){var e=this.defaultDialog.getLastResponse();var c=this.defaultDialog.getDialogId();if(e==null||a==this.SUBSCRIBE&&c==i&&e.getCSeq().getMethod()==this.NOTIFY){this.defaultDialog.setLastResponse(this,f);g=this.defaultDialog}else{g=this.sipStack.getDialog(i);if(g==null){if(this.defaultDialog.isAssignedFunction()){g=this.sipStack.createDialog(this,f)}}}if(g!=null){this.setDialog(g,g.getDialogId())}}else{console.error("SIPClientTransaction:processResponseargu2(): response without from-tag "+f);throw"SIPClientTransaction:processResponseargu2(): response without from-tag "+f}}else{if(this.sipStack.isAutomaticDialogSupportEnabled){g=this.sipStack.createDialog(this,f);this.setDialog(g,g.getDialogId())}}}else{g=this.defaultDialog}}else{g.setLastResponse(this,f)}this.processResponse(f,h,g)};SIPClientTransaction.prototype.processResponseargu3=function(a,d,c){if(this.getState()==null){return}if((this.COMPLETED==this.getState()||this.TERMINATED==this.getState())&&a.getStatusCode()/100==1){return}this.lastResponse=a;try{if(this.isInviteTransaction()){this.inviteClientTransaction(a,d,c)}else{this.nonInviteClientTransaction(a,d,c)}}catch(b){console.error("SIPClientTransaction:processResponseargu3(): catched exception:"+b);this.setState(this.TERMINATED)}};SIPClientTransaction.prototype.nonInviteClientTransaction=function(a,d,b){var c=a.getStatusCode();if(this.TRYING==this.getState()){if(c==401||c==407){if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}}else{if(100<=c&&c<=199){this.setState(this.PROCEEDING);this.enableTimeoutTimer(this.TIMER_F);if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}}else{if(200<=c&&c<=699){if(!this.isReliable()){this.setState(this.COMPLETED);this.enableTimeoutTimer(this.TIMER_K)}else{this.setState(this.TERMINATED);this.sipStack.removeTransaction(this);clearInterval(this.timer)}if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}}}}}else{if(this.PROCEEDING==this.getState()){if(100<=c&&c<=199){if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}}else{if(200<=c&&c<=699){if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}this.disableTimeoutTimer();if(!this.isReliable()){this.setState(this.COMPLETED);this.enableTimeoutTimer(this.TIMER_K)}else{this.setState(this.TERMINATED)}}}}}};SIPClientTransaction.prototype.inviteClientTransaction=function(a,d,b){var c=a.getStatusCode();if(this.TERMINATED==this.getState()){var e=false;if(b!=null){}if(b!=null&&b.isAckSeen()&&b.getLastAckSent()!=null){if(b.getLastAckSent().getCSeq().getSeqNumber()==a.getCSeq().getSeqNumber()&&a.getFromTag()==b.getLastAckSent().getFromTag()){e=true}}if(b!=null&&!e&&a.getCSeq().getMethod()==b.getMethod()){b.resendAck()}this.sipStack.removeTransaction(this);clearInterval(this.timer);return}else{if(this.CALLING==this.getState()){if(200<=c&&c<=299){this.disableTimeoutTimer();this.setState(this.TERMINATED);if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}}else{if(c==401||c==407){if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}}else{if(100<=c&&c<=199){this.disableTimeoutTimer();this.setState(this.PROCEEDING);if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}}else{if(300<=c&&c<=699){this.sendMessage(this.createErrorAck());if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}if(!this.isReliable()){this.setState(this.COMPLETED);this.enableTimeoutTimer(this.TIMER_D)}else{this.setState(this.TERMINATED)}}}}}}else{if(this.PROCEEDING==this.getState()){if(100<=c&&c<=199){if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}}else{if(200<=c&&c<=299){this.setState(this.TERMINATED);this.sipStack.removeTransaction(this);clearInterval(this.timer);if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}}else{if(300<=c&&c<=699){this.sendMessage(this.createErrorAck());if(!this.isReliable()){this.setState(this.COMPLETED);this.enableTimeoutTimer(this.TIMER_D)}else{this.setState(this.TERMINATED);this.sipStack.removeTransaction(this);clearInterval(this.timer)}if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}}}}}else{if(this.COMPLETED==this.getState()){this.setState(this.TERMINATED);this.sipStack.removeTransaction(this);clearInterval(this.timer);if(300<=c&&c<=699){this.sendMessage(this.createErrorAck())}}}}}};SIPClientTransaction.prototype.sendRequest=function(){var d=this.getOriginalRequest();if(this.getState()!=null){console.error("SIPClientTransaction:sendRequest(): request already sent");throw"SIPClientTransaction:sendRequest(): request already sent"}try{d.checkHeaders()}catch(c){console.error("SIPClientTransaction:sendRequest(): "+c);throw"SIPClientTransaction:sendRequest(): "+c}try{if(this.getMethod()==this.CANCEL&&this.sipStack.isCancelClientTransactionChecked()){var b=this.sipStack.findCancelTransaction(this.getOriginalRequest(),false);if(b==null){console.error("SIPClientTransaction:sendRequest(): could not find original tx to cancel. RFC 3261 9.1");throw"SIPClientTransaction:sendRequest(): could not find original tx to cancel. RFC 3261 9.1"}else{if(b.getState()==null){console.error("SIPClientTransaction:sendRequest(): state is null no provisional response yet -- cannot cancel RFC 3261 9.1");throw"SIPClientTransaction:sendRequest(): state is null no provisional response yet -- cannot cancel RFC 3261 9.1"}else{if(b.getMethod()!=this.INVITE){console.error("SIPClientTransaction:sendRequest(): cannot cancel non-invite requests RFC 3261 9.1");throw"SIPClientTransaction:sendRequest(): cannot cancel non-invite requests RFC 3261 9.1"}}}}else{if(this.getMethod()==this.BYE||this.getMethod()==this.NOTIFY){var a=this.sipStack.getDialog(this.getOriginalRequest().getDialogId(false));if(this.getSipProvider().isAutomaticDialogSupportEnabled()&&a!=null){console.error("SIPClientTransaction:sendRequest(): Dialog is present and AutomaticDialogSupport is enabled for the provider -- Send the Request using the Dialog.sendRequest(transaction)");throw"SIPClientTransaction:sendRequest(): Dialog is present and AutomaticDialogSupport is enabled for the provider -- Send the Request using the Dialog.sendRequest(transaction)"}}}if(this.getMethod()==this.INVITE){a=this.getDefaultDialog()}this.isMapped=true;this.sendMessage(d)}catch(c){this.setState(this.TERMINATED);console.error("SIPClientTransaction:sendRequest(): catched exception:"+c);throw"SIPClientTransaction:sendRequest(): catched exception:"+c}};SIPClientTransaction.prototype.fireTimeoutTimer=function(){clearInterval(this.timer);var b=this.getDialog();if(this.CALLING==this.getState()||this.TRYING==this.getState()||this.PROCEEDING==this.getState()){if(b!=null&&(b.getState()==null||b.getState()==this.EARLY)){if(this.getSIPStack().isDialogCreated(this.getOriginalRequest().getMethod())){b.delet()}}else{if(b!=null){if(this.getOriginalRequest().getMethod().toLowerCase()==this.BYE.toLowerCase()&&b.isTerminatedOnBye()){b.delet()}}}}if(this.COMPLETED!=this.getState()){this.raiseErrorEvent(this.TIMEOUT_ERROR);if(this.getOriginalRequest().getMethod().toLowerCase()==this.CANCEL.toLowerCase()){var a=this.getOriginalRequest().getInviteTransaction();if(a!=null&&a.getDialog()!=null&&(a.getState()==this.CALLING||a.getState()==this.PROCEEDING)){a.setState(this.TERMINATED)}}}else{this.setState(this.TERMINATED)}};SIPClientTransaction.prototype.createCancel=function(){var a=this.getOriginalRequest();if(a==null){console.error("SIPClientTransaction:createCancel(): bad state "+this.getState());throw"SIPClientTransaction:createCancel(): bad state "+this.getState()}if(a.getMethod()!=this.INVITE){console.error("SIPClientTransaction:createCancel(): only INIVTE may be cancelled");throw"SIPClientTransaction:createCancel(): only INIVTE may be cancelled"}if(a.getMethod().toLowerCase()==this.ACK.toLowerCase()){console.error("SIPClientTransaction:createCancel(): cannot Cancel ACK!");throw"SIPClientTransaction:createCancel(): cannot Cancel ACK!"}else{var b=a.createCancelRequest();b.setInviteTransaction(this);return b}};SIPClientTransaction.prototype.createAck=function(){var k=this.getOriginalRequest();if(k==null){console.error("SIPClientTransaction:createAck(): bad state "+getState());throw"SIPClientTransaction:createAck(): bad state "+getState()}if(this.getMethod().toLowerCase()==this.ACK.toLowerCase()){console.error("SIPClientTransaction:createAck(): cannot ACK an ACK!");throw"SIPClientTransaction:createAck(): cannot ACK an ACK!"}else{if(this.lastResponse==null){console.error("SIPClientTransaction:createAck(): bad Transaction state");throw"SIPClientTransaction:createAck(): bad Transaction state"}else{if(this.lastResponse.getStatusCode()<200){console.error("SIPClientTransaction:createAck() : cannot ACK a provisional response!");throw"SIPClientTransaction:createAck(): cannot ACK a provisional response!"}}}var c=k.createAckRequest(this.lastResponse.getTo());var f=this.lastResponse.getRecordRouteHeaders();if(f==null){if(this.lastResponse.getContactHeaders()!=null&&this.lastResponse.getStatusCode()/100!=3){var g=this.lastResponse.getContactHeaders().getFirst();var a=g.getAddress().getURI();c.setRequestURI(a)}return c}c.removeHeader(this.RouteHeader);var h=new RouteList();for(var e=f.getHeaderList().length-1;e>=0;e--){var d=f.getHeaderList()[e];var j=new Route();j.setAddress(d.getAddress());j.setParameters(d.getParameters());h.add(j)}g=null;if(this.lastResponse.getContactHeaders()!=null){g=this.lastResponse.getContactHeaders().getFirst()}if(!h.getFirst().getAddress().getURI().hasLrParam()){j=null;if(g!=null){j=new Route();j.setAddress(g.getAddress())}var b=h.getFirst();h.removeFirst();a=b.getAddress().getURI();c.setRequestURI(a);if(j!=null){h.add(j)}c.addHeader(h)}else{if(g!=null){a=g.getAddress().getURI();c.setRequestURI(a);c.addHeader(h)}}return c};SIPClientTransaction.prototype.createErrorAck=function(){var a=this.getOriginalRequest();if(a==null){console.error("SIPClientTransaction:createErrorAck(): bad state "+getState());throw"SIPClientTransaction:createErrorAck(): bad state "+getState()}if(this.getMethod()!=this.INVITE){console.error("SIPClientTransaction:createErrorAck(): can only ACK an INVITE!");throw"SIPClientTransaction:createErrorAck(): can only ACK an INVITE!"}else{if(this.lastResponse==null){console.error("SIPClientTransaction:createErrorAck(): bad Transaction state");throw"SIPClientTransaction:createErrorAck():  bad Transaction state"}else{if(this.lastResponse.getStatusCode()<200){console.error("SIPClientTransaction:createErrorAck(): cannot ACK a provisional response!");throw"SIPClientTransaction:createErrorAck(): cannot ACK a provisional response!"}}}return a.createErrorAck(this.lastResponse.getTo())};SIPClientTransaction.prototype.setViaPort=function(a){this.viaPort=a};SIPClientTransaction.prototype.setViaHost=function(a){this.viaHost=a};SIPClientTransaction.prototype.getViaPort=function(){return this.viaPort};SIPClientTransaction.prototype.getViaHost=function(){return this.viaHost};SIPClientTransaction.prototype.getOutgoingViaHeader=function(){return this.getMessageProcessor().getViaHeader()};SIPClientTransaction.prototype.clearState=function(){};SIPClientTransaction.prototype.setState=function(a){if(a==this.TERMINATED&&this.isReliable()){this.collectionTime=this.TIMER_J}SIPTransaction.prototype.setState.call(this,a)};SIPClientTransaction.prototype.startTransactionTimer=function(){if(this.transactionTimerStarted==false){this.transactionTimerStarted=true;if(this.timer==null){var a=this;this.timer=setInterval(function(){if(a.isTerminated()){var b=a.getSIPStack();b.removeTransaction(a)}else{a.fireTimer()}},this.BASE_TIMER_INTERVAL)}}};SIPClientTransaction.prototype.terminate=function(){this.setState(this.TERMINATED)};SIPClientTransaction.prototype.checkFromTag=function(c){var b=this.getRequest().getFromTag();var a=c.getFrom().getTag();if(this.defaultDialog!=null){if(b==null&&a==null){return false}if(b==null^a==null){return false}if(b!=null&&a!=null&&b.toLowerCase()!=a.toLowerCase()){return false}}return true};SIPClientTransaction.prototype.getDialog=function(){if(arguments.length==0){return this.getDialogargu0()}else{if(arguments.length==1){var a=arguments[0];return this.getDialogargu1(a)}}};SIPClientTransaction.prototype.getDialogargu0=function(){var b=null;if(this.lastResponse!=null&&this.lastResponse.getFromTag()!=null&&this.lastResponse.getToTag()!=null&&this.lastResponse.getStatusCode()!=100){var a=this.lastResponse.getDialogId(false);b=this.getDialog(a)}if(b==null){b=this.defaultDialog}return b};SIPClientTransaction.prototype.getDialogargu1=function(b){var a=null;for(var c=0;c<this.sipDialogs.length;c++){if(this.sipDialogs[c][0]==b){a=this.sipDialogs[c][1]}}return a};SIPClientTransaction.prototype.setDialog=function(c,b){if(c==null){console.error("SIPClientTransaction:setDialog(): bad dialog argument");throw"SIPClientTransaction:setDialog(): bad dialog argument"}if(this.defaultDialog==null){this.defaultDialog=c}if(b!=null&&c.getDialogId()!=null){var a=null;for(var d=0;d<this.sipDialogs.length;d++){if(this.sipDialogs[d][0]==b){a=d}}if(a!=null){this.sipDialogs[a][1]=c}else{var e=new Array();e[0]=b;e[1]=c;this.sipDialogs.push(e)}}};SIPClientTransaction.prototype.getDefaultDialog=function(){return this.defaultDialog};SIPClientTransaction.prototype.setNextHop=function(a){this.nextHop=a};SIPClientTransaction.prototype.getNextHop=function(){return this.nextHop};SIPClientTransaction.prototype.alertIfStillInCallingStateBy=function(a){this.timeoutIfStillInCallingState=true;this.callingStateTimeoutCount=a};function SIPServerTransaction(b,a){this.classname="SIPServerTransaction";this.auditTag=0;this.sipStack=b;this.originalRequest=null;this.encapsulatedChannel=a;this.disableTimeoutTimer();this.addEventListener(b);this.timert=null;this.timer=null;if(b.maxListenerResponseTime!=-1){this.timer=setTimeout(this.listenerExecutionMaxTimer(),b.maxListenerResponseTime*1000)}this.rseqNumber=(Math.random()*1000);this.requestOf=null;this.dialog=null;this.pendingReliableResponse=null;this.provisionalResponseTask=null;this.isAckSeen=null;this.pendingSubscribeTransaction=null;this.inviteTransaction=null}SIPServerTransaction.prototype=new SIPTransaction();SIPServerTransaction.prototype.constructor=SIPServerTransaction;SIPServerTransaction.prototype.TERMINATED_STATE=2;SIPServerTransaction.prototype.TIMEOUT_ERROR=1;SIPServerTransaction.prototype.RECEIVED="received";SIPServerTransaction.prototype.INVITE="INVITE";SIPServerTransaction.prototype.CANCEL="CANCEL";SIPServerTransaction.prototype.BRANCH="branch";SIPServerTransaction.prototype.BRANCH_MAGIC_COOKIE_LOWER_CASE="z9hg4bk";SIPServerTransaction.prototype.TIMER_H=64;SIPServerTransaction.prototype.TIMER_J=64;SIPServerTransaction.prototype.TIMER_I=SIPTransaction.prototype.TIMER_I;SIPServerTransaction.prototype.CONNECTION_LINGER_TIME=8;SIPServerTransaction.prototype.BASE_TIMER_INTERVAL=500;SIPServerTransaction.prototype.ExpiresHeader="Expires";SIPServerTransaction.prototype.ContactHeader="Contact";SIPServerTransaction.prototype.listenerExecutionMaxTimer=function(){if(this.getState()==null){this.terminate();var a=this.getSIPStack();a.removePendingTransaction(this);a.removeTransaction(this)}};SIPServerTransaction.prototype.setRequestInterface=function(a){this.requestOf=a};SIPServerTransaction.prototype.getResponseChannel=function(){return this};SIPServerTransaction.prototype.isMessagePartOfTransaction=function(e){var f=false;var a=e.getCSeq().getMethod();if(a==this.INVITE||!this.isTerminated()){var g=e.getViaHeaders();if(g!=null){var d=g.getFirst();var c=d.getBranch();if(c!=null){if(c.toLowerCase().substring(0,7)!=this.BRANCH_MAGIC_COOKIE_LOWER_CASE){c=null}}if(c!=null&&this.getBranch()!=null){if(a==this.CANCEL){if(this.getMethod()==this.CANCEL&&this.getBranch().toLowerCase()==c.toLowerCase()&&d.getSentBy()==this.getOriginalRequest().getViaHeaders().getFirst().getSentBy()){f=true}else{f=false}}else{if(this.getBranch().toLowerCase()==c.toLowerCase()&&d.getSentBy()==this.getOriginalRequest().getViaHeaders().getFirst().getSentBy()){f=true}else{f=false}}}else{var i=SIPTransaction.prototype.fromTag;var l=e.getFrom().getTag();if(i==null||l==null){var k=true}else{k=false}var m=SIPTransaction.prototype.toTag;var h=e.getTo().getTag();if(m==null||h==null){var j=true}else{j=false}if(e instanceof SIPResponse){var b=true}else{b=false}if(e.getCSeq().getMethod().toLowerCase()==this.CANCEL.toLowerCase()&&getOriginalRequest().getCSeq().getMethod().toLowerCase()!=this.CANCEL.toLowerCase()){f=false}else{if((b||this.getOriginalRequest().getRequestURI()==e.getRequestURI())&&(k||i!=null&&i.toLowerCase()==l.toLowerCase())&&(j||m!=null&&m.toLowerCase()==h.toLowerCase())&&this.getOriginalRequest().getCallId().getCallId().toLowerCase()==e.getCallId().getCallId().toLowerCase()&&this.getOriginalRequest().getCSeq().getSeqNumber()==e.getCSeq().getSeqNumber()&&((e.getCSeq().getMethod()!=(this.CANCEL))||this.getOriginalRequest().getMethod()==e.getCSeq().getMethod())&&d==getOriginalRequest().getViaHeaders().getFirst()){f=true}}}}}return f};SIPServerTransaction.prototype.isTransactionMapped=function(){return this.isMapped};SIPServerTransaction.prototype.processRequest=function(b,c){var d=false;if(this.getRealState()==null){this.setOriginalRequest(b);this.setState("TRYING");d=true;this.setPassToListener()}else{if(this.isInviteTransaction()&&"COMPLETED"==this.getRealState()&&b.getMethod()=="ACK"){this.setState("CONFIRMED");if(!this.isReliable()){this.enableTimeoutTimer(this.TIMER_I)}else{this.setState("TERMINATED")}if(this.sipStack.isNon2XXAckPassedToListener()){this.requestOf.processRequest(b,this)}return}else{if(b.getMethod()==this.getMethod()){if("PROCEEDING"==this.getRealState()||"COMPLETED"==this.getRealState()){if(this.lastResponse!=null){SIPTransaction.prototype.sendMessage.call(this,this.lastResponse)}}else{if(b.getMethod()=="ACK"){if(this.requestOf!=null){this.requestOf.processRequest(b,this)}}}return}}}if("COMPLETED"!=this.getRealState()&&"TERMINATED"!=this.getRealState()&&this.requestOf!=null){if(this.getMethod()==b.getMethod()){if(d){this.requestOf.processRequest(b,this)}}else{if(this.requestOf!=null){this.requestOf.processRequest(b,this)}}}else{if(this.getSIPStack().isDialogCreated(this.getMethod())&&this.getRealState()=="TERMINATED"&&b.getMethod()=="ACK"&&this.requestOf!=null){var a=this.dialog;if(a==null||!a.ackProcessed){if(a!=null){a.ackReceived(b);a.ackProcessed=true}this.requestOf.processRequest(b,this)}}else{if(b.getMethod()=="CANCEL"){this.sendMessage(b.createResponse("OK"))}}}};SIPServerTransaction.prototype.sendMessage=function(d){var a=d;var c=a.getStatusCode();if(this.getOriginalRequest().getTopmostVia().getBranch()!=null){a.getTopmostVia().setBranch(this.getBranch())}else{a.getTopmostVia().removeParameter(ParameterNames.BRANCH)}if(!this.getOriginalRequest().getTopmostVia().hasPort()){a.getTopmostVia().removePort()}if(!a.getCSeq().getMethod()==this.getMethod()){this.sendResponseSRT(a);return}if(this.getRealState()=="TRYING"){if(c<=199&&c>=100){this.setState("PROCEEDING")}else{if(200<=c&&c<=699){if(!this.isInviteTransaction()){if(!this.isReliable()){this.setState("COMPLETED");this.enableTimeoutTimer(this.TIMER_J)}else{this.setState("TERMINATED")}}else{if(c<=299&&c>=200){this.disableTimeoutTimer();this.collectionTime=this.TIMER_J;this.setState("TERMINATED")}else{this.setState("COMPLETED");this.enableTimeoutTimer(this.TIMER_H)}}}}}else{if(this.getRealState()=="PROCEEDING"){if(this.isInviteTransaction()){if(c<=299&&c>=100){this.disableTimeoutTimer();this.collectionTime=this.TIMER_J;this.setState("TERMINATED")}else{if(300<=c&&c<=699){this.setState("COMPLETED");this.enableTimeoutTimer(this.TIMER_H)}}}else{if(200<=c&&c<=699){this.setState("COMPLETED");if(!this.isReliable()){this.enableTimeoutTimer(this.TIMER_J)}else{this.setState("TERMINATED")}}}}else{if("COMPLETED"==this.getRealState()){return}}}try{this.lastResponse=a;this.sendResponseSRT(a)}catch(b){this.setState("TERMINATED");this.collectionTime=0;console.error("SIPServerTransaction:sendMessage(): catched exception:"+b)}};SIPServerTransaction.prototype.getViaHost=function(){return this.getMessageChannel().getViaHost()};SIPServerTransaction.prototype.getViaPort=function(){return this.getMessageChannel().getViaPort()};SIPServerTransaction.prototype.fireTimeoutTimer=function(){clearTimeout(this.timer);if(this.getMethod()=="INVITE"&&this.sipStack.removeTransactionPendingAck(this)){return}var a=this.dialog;if(this.getSIPStack().isDialogCreated(this.getOriginalRequest().getMethod())&&("CALLING"==this.getRealState()||"TRYING"==this.getRealState())){a.setState(this.TERMINATED_STATE)}else{if(this.getOriginalRequest().getMethod()=="BYE"){if(a!=null&&a.isTerminatedOnBye()){a.setState(this.TERMINATED_STATE)}}}if("COMPLETED"==this.getRealState()&&this.isInviteTransaction()){this.raiseErrorEvent(this.TIMEOUT_ERROR);this.setState("TERMINATED");this.sipStack.removeTransaction(this)}else{if("COMPLETED"==this.getRealState()&&!this.isInviteTransaction()){this.setState("TERMINATED");this.sipStack.removeTransaction(this)}else{if("CONFIRMED"==this.getRealState()&&this.isInviteTransaction()){this.setState("TERMINATED");this.sipStack.removeTransaction(this)}else{if(!isInviteTransaction()&&("COMPLETED"==this.getRealState()||"CONFIRMED"==this.getRealState())){this.setState("TERMINATED")}else{if(isInviteTransaction()&&"TERMINATED"==this.getRealState()){this.raiseErrorEvent(this.TIMEOUT_ERROR);if(a!=null){a.setState(this.TERMINATED_STATE)}}}}}}};SIPServerTransaction.prototype.getLastResponse=function(){return this.lastResponse};SIPServerTransaction.prototype.sendResponseSRT=function(a){this.getMessageChannel().sendMessage(a);this.startTransactionTimer()};SIPServerTransaction.prototype.sendResponse=function(e){var g=e;var h=this.dialog;if(e==null){console.error("SIPServerTransaction:sendResponse(): null response argument");throw"SIPServerTransaction:sendResponse(): null response argument"}try{g.checkHeaders()}catch(i){console.error("SIPServerTransaction:sendMessage(): catched exception:"+i);throw"SIPServerTransaction:sendResponse(): catched exception:"+i}if(g.getCSeq().getMethod()!=this.getMethod()){console.error("SIPServerTransaction:sendResponse(): CSeq method does not match Request method of request that created the tx.");throw"SIPServerTransaction:sendResponse(): CSeq method does not match Request method of request that created the tx."}if(this.getMethod()==("SUBSCRIBE")&&e.getStatusCode()/100==2){if(e.getHeader(this.ExpiresHeader)==null){console.error("SIPServerTransaction:sendResponse(): Expires header is mandatory in 2xx response of SUBSCRIBE");throw"SIPServerTransaction:sendResponse(): Expires header is mandatory in 2xx response of SUBSCRIBE"}else{var f=this.getOriginalRequest().getExpires();var b=e.getExpires();if(f!=null&&b.getExpires()>f.getExpires()){console.error("SIPServerTransaction:sendResponse(): response Expires time exceeds request Expires time : See RFC 3265 3.1.1");throw"SIPServerTransaction:sendResponse():Response Expires time exceeds request Expires time : See RFC 3265 3.1.1"}}}if(g.getStatusCode()==200&&g.getCSeq().getMethod()=="INVITE"&&g.getHeader(this.ContactHeader)==null){console.error("SIPServerTransaction:sendResponse(): Contact Header is mandatory for the OK to the INVITE");throw"SIPServerTransaction:sendResponse(): Contact Header is mandatory for the OK to the INVITE"}if(!this.isMessagePartOfTransaction(e)){console.error("SIPServerTransaction:sendResponse(): response does not belong to this transaction.");throw"SIPServerTransaction:sendResponse(): response does not belong to this transaction."}try{if(h!=null){if(g.getStatusCode()/100==2&&this.sipStack.isDialogCreated(g.getCSeq().getMethod())){if(h.getLocalTag()==null&&g.getTo().getTag()==null){g.getTo().setTag(Utils.prototype.generateTag())}else{if(h.getLocalTag()!=null&&g.getToTag()==null){g.setToTag(h.getLocalTag())}else{if(h.getLocalTag()!=null&&g.getToTag()!=null&&h.getLocalTag()!=g.getToTag()){console.error("SIPServerTransaction:sendResponse(): tag mismatch dialogTag is "+h.getLocalTag()+" responseTag is "+g.getToTag());throw"SIPServerTransaction:sendResponse(): tag mismatch dialogTag is "+h.getLocalTag()+" responseTag is "+g.getToTag()}}}}if(g.getCallId().getCallId()!=h.getCallId().getCallId()){console.error("SIPServerTransaction:sendResponse(): dialog mismatch!");throw"SIPServerTransaction:sendResponse(): dialog mismatch!"}}var c=this.getRequest().getFrom().getTag();if(c!=null&&g.getFromTag()!=null&&g.getFromTag()!=c){console.error("SIPServerTransaction:sendResponse(): from tag of request does not match response from tag");throw"SIPServerTransaction:sendResponse(): from tag of request does not match response from tag"}else{if(c!=null){g.getFrom().setTag(c)}}if(h!=null&&e.getStatusCode()!=100){h.setResponseTags(g);var d=h.getState();h.setLastResponse(this,e);if(d==null&&h.getState()=="TERMINATED"){var a=new DialogTerminatedEvent(h.getSipProvider(),h);h.getSipProvider().handleEvent(a,this)}}this.sendMessage(e)}catch(i){this.setState("TERMINATED");this.raiseErrorEvent(this.TRANSPORT_ERROR);console.error("SIPServerTransaction:sendMessage(): catched exception:"+i)}};SIPServerTransaction.prototype.getRealState=function(){return SIPTransaction.prototype.getState.call(this)};SIPServerTransaction.prototype.getState=function(){if(this.isInviteTransaction()&&"TRYING"==SIPTransaction.prototype.getState.call(this)){return"PROCEEDING"}else{return SIPTransaction.prototype.getState.call(this)}};SIPServerTransaction.prototype.setState=function(a){if(a=="TERMINATED"&&this.isReliable()){this.collectionTime=this.TIMER_J}SIPTransaction.prototype.setState.call(this,a)};SIPServerTransaction.prototype.startTransactionTimer=function(){if(this.transactionTimerStarted==false){this.transactionTimerStarted=true}if(this.transactionTimerStarted){if(this.timer==null){var a=this;this.timer=setInterval(function(){if(!a.isTerminated()){a.fireTimer()}},this.BASE_TIMER_INTERVAL)}}};SIPServerTransaction.prototype.getDialog=function(){return this.dialog};SIPServerTransaction.prototype.setDialog=function(b,a){this.dialog=b;if(a!=null){this.dialog.setAssigned()}};SIPServerTransaction.prototype.terminate=function(){this.setState("TERMINATED")};SIPServerTransaction.prototype.setAckSeen=function(){this.isAckSeen=true};SIPServerTransaction.prototype.ackSeen=function(){return this.isAckSeen};SIPServerTransaction.prototype.setMapped=function(a){this.isMapped=true};SIPServerTransaction.prototype.setPendingSubscribe=function(a){this.pendingSubscribeTransaction=a};SIPServerTransaction.prototype.setInviteTransaction=function(a){this.inviteTransaction=a};SIPServerTransaction.prototype.getCanceledInviteTransaction=function(){return this.inviteTransaction};SIPServerTransaction.prototype.scheduleAckRemoval=function(){if(this.getMethod()==null||this.getMethod()!="ACK"){console.error("SIPServerTransaction:scheduleAckRemoval():  method is null["+(this.getMethod()==null)+"] or method is not ACK["+this.getMethod()+"]");throw"SIPServerTransaction:scheduleAckRemoval():  method is null["+(this.getMethod()==null)+"] or method is not ACK["+this.getMethod()+"]"}this.startTransactionTimer()};SIPServerTransaction.prototype.map=function(){var a=this.getRealState();if(a==null||a=="TRYING"){this.isMapped=true}this.sipStack.removePendingTransaction(this)};function Utils(){this.classname="Utils"}Utils.prototype.BRANCH_MAGIC_COOKIE="z9hG4bK";Utils.prototype.callIDCounter=0;Utils.prototype.counter=0;Utils.prototype.toHex=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];Utils.prototype.rand=Math.random();Utils.prototype.toHexString=function(a){var e="";for(var d=0;d<a.length;d++){e=e+Utils.prototype.toHex[(a[d]>>4)&15];e=e+Utils.prototype.toHex[a[d]&15]}return e};Utils.prototype.getQuotedString=function(a){return'"'+a.replace('"','\\"')+'"'};Utils.prototype.generateCallIdentifier=function(c){var d=new Date().getTime()+Utils.prototype.callIDCounter+Math.round(Utils.prototype.rand*100000000000000000000);Utils.prototype.callIDCounter++;var a=new String(Utils.prototype.getBytes(d.toString()));var e=Utils.prototype.digest(a);var b=e;return b+"@"+c};Utils.prototype.generateTag=function(){var a=Math.round(Utils.prototype.rand*10000000000);return a.toString(16)};Utils.prototype.generateBranchId=function(){var d=new Date().getTime();var a=Math.round(Utils.prototype.rand*1000000000);var c=a+Utils.prototype.counter+d;Utils.prototype.counter++;var b=Utils.prototype.digest(new String(Utils.prototype.getBytes(c.toString())));return Utils.prototype.BRANCH_MAGIC_COOKIE+"-"+Utils.prototype.signature+"-"+b};Utils.prototype.responseBelongsToUs=function(c){var b=c.getTopmostVia();var f=b.getBranch();var a=f.length-1;var d=0;for(var e=Utils.prototype.signature.length-1;e>=0;e--){if(Utils.prototype.signature[e]==f[a]){d=d+1;a=a-1}}if(f!=null&&d==Utils.prototype.signature.length){return true}else{return false}};Utils.prototype.getSignature=function(){return Utils.prototype.signature};Utils.prototype.randomString=function(a){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";var c="";for(var d=0;d<a;d++){var b=Math.floor(Math.random()*e.length);c+=e.substring(b,b+1)}return c};Utils.prototype.getBytes=function(b){var c=new Array();b=new String(b);for(var a=0;a<b.length;a++){c[a]=b.charCodeAt(a)}return c};Utils.prototype.signature=Utils.prototype.toHexString(Utils.prototype.getBytes(Math.round(Utils.prototype.rand*1000).toString()));Utils.prototype.digest=function(t){function M(b,a){return(b<<a)|(b>>>(32-a))}function L(k,b){var F,a,d,x,c;d=(k&2147483648);x=(b&2147483648);F=(k&1073741824);a=(b&1073741824);c=(k&1073741823)+(b&1073741823);if(F&a){return(c^2147483648^d^x)}if(F|a){if(c&1073741824){return(c^3221225472^d^x)}else{return(c^1073741824^d^x)}}else{return(c^d^x)}}function s(a,c,b){return(a&c)|((~a)&b)}function r(a,c,b){return(a&b)|(c&(~b))}function q(a,c,b){return(a^c^b)}function n(a,c,b){return(c^(a|(~b)))}function v(G,F,ad,ac,k,H,I){G=L(G,L(L(s(F,ad,ac),k),I));return L(M(G,H),F)}function f(G,F,ad,ac,k,H,I){G=L(G,L(L(r(F,ad,ac),k),I));return L(M(G,H),F)}function E(G,F,ad,ac,k,H,I){G=L(G,L(L(q(F,ad,ac),k),I));return L(M(G,H),F)}function u(G,F,ad,ac,k,H,I){G=L(G,L(L(n(F,ad,ac),k),I));return L(M(G,H),F)}function e(k){var G;var d=k.length;var c=d+8;var b=(c-(c%64))/64;var F=(b+1)*16;var H=Array(F-1);var a=0;var x=0;while(x<d){G=(x-(x%4))/4;a=(x%4)*8;H[G]=(H[G]|(k.charCodeAt(x)<<a));x++}G=(x-(x%4))/4;a=(x%4)*8;H[G]=H[G]|(128<<a);H[F-2]=d<<3;H[F-1]=d>>>29;return H}function C(c){var b="",d="",k,a;for(a=0;a<=3;a++){k=(c>>>(a*8))&255;d="0"+k.toString(16);b=b+d.substr(d.length-2,2)}return b}function K(b){b=b.replace(/\r\n/g,"\n");var a="";for(var k=0;k<b.length;k++){var d=b.charCodeAt(k);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a}var D=Array();var S,h,J,w,g,ab,aa,Z,Y;var V=7,T=12,P=17,N=22;var B=5,A=9,z=14,y=20;var p=4,m=11,l=16,j=23;var X=6,W=10,U=15,R=21;t=K(t);D=e(t);ab=1732584193;aa=4023233417;Z=2562383102;Y=271733878;for(S=0;S<D.length;S+=16){h=ab;J=aa;w=Z;g=Y;ab=v(ab,aa,Z,Y,D[S+0],V,3614090360);Y=v(Y,ab,aa,Z,D[S+1],T,3905402710);Z=v(Z,Y,ab,aa,D[S+2],P,606105819);aa=v(aa,Z,Y,ab,D[S+3],N,3250441966);ab=v(ab,aa,Z,Y,D[S+4],V,4118548399);Y=v(Y,ab,aa,Z,D[S+5],T,1200080426);Z=v(Z,Y,ab,aa,D[S+6],P,2821735955);aa=v(aa,Z,Y,ab,D[S+7],N,4249261313);ab=v(ab,aa,Z,Y,D[S+8],V,1770035416);Y=v(Y,ab,aa,Z,D[S+9],T,2336552879);Z=v(Z,Y,ab,aa,D[S+10],P,4294925233);aa=v(aa,Z,Y,ab,D[S+11],N,2304563134);ab=v(ab,aa,Z,Y,D[S+12],V,1804603682);Y=v(Y,ab,aa,Z,D[S+13],T,4254626195);Z=v(Z,Y,ab,aa,D[S+14],P,2792965006);aa=v(aa,Z,Y,ab,D[S+15],N,1236535329);ab=f(ab,aa,Z,Y,D[S+1],B,4129170786);Y=f(Y,ab,aa,Z,D[S+6],A,3225465664);Z=f(Z,Y,ab,aa,D[S+11],z,643717713);aa=f(aa,Z,Y,ab,D[S+0],y,3921069994);ab=f(ab,aa,Z,Y,D[S+5],B,3593408605);Y=f(Y,ab,aa,Z,D[S+10],A,38016083);Z=f(Z,Y,ab,aa,D[S+15],z,3634488961);aa=f(aa,Z,Y,ab,D[S+4],y,3889429448);ab=f(ab,aa,Z,Y,D[S+9],B,568446438);Y=f(Y,ab,aa,Z,D[S+14],A,3275163606);Z=f(Z,Y,ab,aa,D[S+3],z,4107603335);aa=f(aa,Z,Y,ab,D[S+8],y,1163531501);ab=f(ab,aa,Z,Y,D[S+13],B,2850285829);Y=f(Y,ab,aa,Z,D[S+2],A,4243563512);Z=f(Z,Y,ab,aa,D[S+7],z,1735328473);aa=f(aa,Z,Y,ab,D[S+12],y,2368359562);ab=E(ab,aa,Z,Y,D[S+5],p,4294588738);Y=E(Y,ab,aa,Z,D[S+8],m,2272392833);Z=E(Z,Y,ab,aa,D[S+11],l,1839030562);aa=E(aa,Z,Y,ab,D[S+14],j,4259657740);ab=E(ab,aa,Z,Y,D[S+1],p,2763975236);Y=E(Y,ab,aa,Z,D[S+4],m,1272893353);Z=E(Z,Y,ab,aa,D[S+7],l,4139469664);aa=E(aa,Z,Y,ab,D[S+10],j,3200236656);ab=E(ab,aa,Z,Y,D[S+13],p,681279174);Y=E(Y,ab,aa,Z,D[S+0],m,3936430074);Z=E(Z,Y,ab,aa,D[S+3],l,3572445317);aa=E(aa,Z,Y,ab,D[S+6],j,76029189);ab=E(ab,aa,Z,Y,D[S+9],p,3654602809);Y=E(Y,ab,aa,Z,D[S+12],m,3873151461);Z=E(Z,Y,ab,aa,D[S+15],l,530742520);aa=E(aa,Z,Y,ab,D[S+2],j,3299628645);ab=u(ab,aa,Z,Y,D[S+0],X,4096336452);Y=u(Y,ab,aa,Z,D[S+7],W,1126891415);Z=u(Z,Y,ab,aa,D[S+14],U,2878612391);aa=u(aa,Z,Y,ab,D[S+5],R,4237533241);ab=u(ab,aa,Z,Y,D[S+12],X,1700485571);Y=u(Y,ab,aa,Z,D[S+3],W,2399980690);Z=u(Z,Y,ab,aa,D[S+10],U,4293915773);aa=u(aa,Z,Y,ab,D[S+1],R,2240044497);ab=u(ab,aa,Z,Y,D[S+8],X,1873313359);Y=u(Y,ab,aa,Z,D[S+15],W,4264355552);Z=u(Z,Y,ab,aa,D[S+6],U,2734768916);aa=u(aa,Z,Y,ab,D[S+13],R,1309151649);ab=u(ab,aa,Z,Y,D[S+4],X,4149444226);Y=u(Y,ab,aa,Z,D[S+11],W,3174756917);Z=u(Z,Y,ab,aa,D[S+2],U,718787259);aa=u(aa,Z,Y,ab,D[S+9],R,3951481745);ab=L(ab,h);aa=L(aa,J);Z=L(Z,w);Y=L(Y,g)}var i=C(ab)+C(aa)+C(Z)+C(Y);return i.toLowerCase()};function EventWrapper(a,b){this.classname="EventWrapper";this.sipEvent=a;this.transaction=b}function EventScanner(a){this.classname="EventScanner";this.isStopped=null;this.refCount=null;this.pendingEvents=new Array();this.eventMutex=new Array();this.eventMutex[0]=0;this.sipStack=a}EventScanner.prototype.BRANCH_MAGIC_COOKIE="z9hG4bK";EventScanner.prototype.incrementRefcount=function(){};EventScanner.prototype.addEvent=function(a){this.pendingEvents.push(a)};EventScanner.prototype.stop=function(){if(this.refCount>0){this.refCount--}if(this.refCount==0){this.isStopped=true}};EventScanner.prototype.forceStop=function(){this.isStopped=true;this.refCount=0};EventScanner.prototype.deliverEvent=function(j){var g=j.sipEvent;var d=this.sipStack.getSipListener();if(g instanceof RequestEvent){var h=g.getRequest();var c=this.sipStack.findTransaction(h,true);if(c!=null&&!c.passToListener()){return}else{if(this.sipStack.findPendingTransaction(h)!=null){return}else{var k=j.transaction;this.sipStack.putPendingTransaction(k)}}h.setTransaction(j.transaction);if(d!=null){d.processRequest(g)}if(j.transaction!=null){var i=j.transaction.getDialog();if(i!=null){i.requestConsumed()}}if(j.transaction!=null){this.sipStack.removePendingTransaction(j.transaction)}if(j.transaction.getOriginalRequest().getMethod()=="ACK"){j.transaction.setState("TERMINATED")}}else{if(g instanceof ResponseEvent){var a=g;var f=a.getResponse();var b=a.getDialog();if(d!=null){c=j.transaction;if(c!=null){c.setPassToListener()}d.processResponse(g)}if((b!=null&&(b.getState()==null||b.getState()!="TERMINATED"))&&(f.getStatusCode()==481||f.getStatusCode()==408)){b.doDeferredDelete()}if(f.getCSeq().getMethod()=="INVITE"&&b!=null&&f.getStatusCode()==200){b.doDeferredDeleteIfNoAckSent(f.getCSeq().getSeqNumber())}var e=j.transaction;if(e!=null&&"COMPLETED"==e.getState()&&e.getOriginalRequest()!=null&&e.getOriginalRequest().getMethod()!="INVITE"){e.clearState()}}else{if(g instanceof TimeoutEvent){if(d!=null){d.processTimeout(g)}}else{if(g instanceof DialogTimeoutEvent){if(d!=null){d.processDialogTimeout(g)}}else{if(g instanceof TransactionTerminatedEvent){if(d!=null){d.processTransactionTerminated(g)}}else{if(g instanceof DialogTerminatedEvent){if(d!=null){d.processDialogTerminated(g)}}}}}}}};EventScanner.prototype.run=function(){while(true){var a=null;var b;while(this.pendingEvents.length==0){if(this.isStopped){return}try{}catch(d){console.error("EventScanner:run(): catched exception:"+d);return}}b=this.pendingEvents;this.pendingEvents=new Array();for(var c=0;c<b.length;c++){a=b[c];this.deliverEvent(a)}}};function DialogTerminatedEvent(b,a){this.classname="DialogTerminatedEvent";this.mDialog=a;this.source=b}DialogTerminatedEvent.prototype.getDialog=function(){return this.mDialog};function DialogTimeoutEvent(b,a,c){this.classname="DialogTimeoutEvent";this.source=b;this.m_dialog=a;this.m_reason=c}DialogTimeoutEvent.prototype.AckNotReceived="AckNotReceived";DialogTimeoutEvent.prototype.AckNotSent="AckNotSent";DialogTimeoutEvent.prototype.ReInviteTimeout="ReInviteTimeout";DialogTimeoutEvent.prototype.getDialog=function(){return this.m_dialog};DialogTimeoutEvent.prototype.getReason=function(){return this.m_reason};function TransactionTerminatedEvent(){this.classname="TransactionTerminatedEvent";this.mTimeout=null;this.mIsServerTransaction=null;this.mServerTransaction=null;this.mClientTransaction=null;this.source=null;if(arguments[1] instanceof SIPServerTransaction){var c=arguments[0];var b=arguments[1];this.source=c;this.mServerTransaction=b;this.mIsServerTransaction=true}else{if(arguments[1] instanceof SIPClientTransaction){c=arguments[0];var a=arguments[1];this.source=c;this.mClientTransaction=a;this.mIsServerTransaction=false}}}TransactionTerminatedEvent.prototype.isServerTransaction=function(){return this.mIsServerTransaction};TransactionTerminatedEvent.prototype.getClientTransaction=function(){return this.mClientTransaction};TransactionTerminatedEvent.prototype.getServerTransaction=function(){return this.mServerTransaction};function RequestEvent(d,c,a,b){this.classname="RequestEvent";this.mDialog=a;this.mRequest=b;this.mServerTransaction=c;this.source=d}RequestEvent.prototype.getDialog=function(){return this.mDialog};RequestEvent.prototype.getRequest=function(){return this.mRequest};RequestEvent.prototype.getServerTransaction=function(){return this.mServerTransaction};function TimeoutEvent(){this.classname="TimeoutEvent";this.mTimeout=null;this.mIsServerTransaction=null;this.mServerTransaction=null;this.mClientTransaction=null;this.source=null;if(arguments[1] instanceof SIPServerTransaction){var d=arguments[0];var c=arguments[1];var b=arguments[2];this.source=d;this.mTimeout=b;this.mServerTransaction=c;this.mIsServerTransaction=true}else{if(arguments[1] instanceof SIPClientTransaction){d=arguments[0];var a=arguments[1];b=arguments[2];this.source=d;this.mTimeout=b;this.mClientTransaction=a;this.mIsServerTransaction=false}}}TimeoutEvent.prototype=new TransactionTerminatedEvent();TimeoutEvent.prototype.constructor=TimeoutEvent;TimeoutEvent.prototype.getTimeout=function(){return this.mTimeout};function TransactionTerminatedEvent(){this.classname="TransactionTerminatedEvent";this.mTimeout=null;this.mIsServerTransaction=null;this.mServerTransaction=null;this.mClientTransaction=null;this.source=null;if(arguments[1] instanceof SIPServerTransaction){var c=arguments[0];var b=arguments[1];this.source=c;this.mServerTransaction=b;this.mIsServerTransaction=true}else{if(arguments[1] instanceof SIPClientTransaction){c=arguments[0];var a=arguments[1];this.source=c;this.mClientTransaction=a;this.mIsServerTransaction=false}}}TransactionTerminatedEvent.prototype.isServerTransaction=function(){return this.mIsServerTransaction};TransactionTerminatedEvent.prototype.getClientTransaction=function(){return this.mClientTransaction};TransactionTerminatedEvent.prototype.getServerTransaction=function(){return this.mServerTransaction};function DefaultAddressResolver(){this.classname="DefaultAddressResolver"}DefaultAddressResolver.prototype.resolveAddress=function(a){if(a.getPort()!=-1){return a}else{var b=new MessageProcessor();return new HopImpl(a.getHost(),b.getDefaultPort(),a.getTransport())}};function ResponseEvent(d,c,b,a){this.classname="ResponseEvent";this.mDialog=b;this.mResponse=a;this.mServerTransaction=c;this.source=d}ResponseEvent.prototype.getDialog=function(){return this.mDialog};ResponseEvent.prototype.getResponse=function(){return this.mResponse};ResponseEvent.prototype.getClientTransaction=function(){return this.mClientTransaction};function ResponseEventExt(d,b,c,a){this.classname="ResponseEventExt";this.mDialog=c;this.mResponse=a;this.mServerTransaction=b;this.source=d;this.m_originalTransaction=b}ResponseEventExt.prototype=new ResponseEvent();ResponseEventExt.prototype.constructor=ResponseEventExt;ResponseEventExt.prototype.isForkedResponse=function(){return this.mServerTransaction==null&&this.m_originalTransaction!=null};ResponseEventExt.prototype.setOriginalTransaction=function(a){this.m_originalTransaction=a};ResponseEventExt.prototype.getOriginalTransaction=function(){return this.m_originalTransaction};function DialogFilter(a){this.classname="DialogFilter";this.sipStack=a;this.transactionChannel=null;this.listeningPoint=null}DialogFilter.prototype.processResponse=function(){if(arguments.length==2){var e=arguments[0];var d=arguments[1];this.processResponseargu2(e,d)}else{var a=arguments[0];var c=arguments[1];var b=arguments[2];this.processResponseargu3(a,c,b)}};DialogFilter.prototype.processResponseargu2=function(j,l){var f=j.getDialogId(false);var h=this.sipStack.getDialog(f);var a=j.getCSeq().getMethod();if(this.sipStack.checkBranchId&&!Utils.prototype.responseBelongsToUs(j)){return}if(this.listeningPoint==null){return}var b=this.listeningPoint.getProvider();if(b==null){return}if(b.getSipListener()==null){return}var d=this.transactionChannel;if(h==null&&d!=null){h=d.getDialog(f);if(h!=null&&h.getState()=="TERMINATED"){h=null}}if(this.transactionChannel!=null){var e=this.transactionChannel.getRequest().getFromTag();if(e==null^j.getFrom().getTag()==null){return}if(e!=null&&e.toLowerCase()!=j.getFrom().getTag().toLowerCase()){return}}if(this.sipStack.isDialogCreated(a)&&j.getStatusCode()!=100&&j.getFrom().getTag()!=null&&j.getTo().getTag()!=null&&h==null){if(b.isAutomaticDialogSupportEnabled()){if(this.transactionChannel!=null){if(h==null){h=this.sipStack.createDialog(this.transactionChannel,j);this.transactionChannel.setDialog(h,j.getDialogId(false))}}else{h=this.sipStack.createDialog(b,j)}}}else{if(h!=null&&d==null&&h.getState()!="TERMINATED"){if(h.getState()=="TERMINATED"&&(j.getStatusCode()>=200||j.getStatusCode()<=299)){if((j.getStatusCode()>=200||j.getStatusCode()<=299)&&j.getCSeq().getMethod()=="INVITE"){var g=h.createAck(j.getCSeq().getSeqNumber());h.sendAck(g)}return}else{var k=false;if(h.isAckSeen()&&h.getLastAckSent()!=null){if(h.getLastAckSent().getCSeq().getSeqNumber()==j.getCSeq().getSeqNumber()&&j.getDialogId(false)==h.getLastAckSent().getDialogId(false)){k=true}}if(k&&j.getCSeq().getMethod()==h.getMethod()){h.resendAck();return}}}}if(h!=null&&j.getStatusCode()!=100&&j.getTo().getTag()!=null){h.setLastResponse(d,j)}var c=new ResponseEventExt(b,d,h,j);if(j.getCSeq().getMethod()=="INVITE"){var i=this.sipStack.getForkedTransaction(j.getTransactionId());c.setOriginalTransaction(i)}b.handleEvent(c,d)};DialogFilter.prototype.processResponseargu3=function(e,a,g){if(this.listeningPoint==null){return}if(this.sipStack.checkBranchId&&!Utils.prototype.responseBelongsToUs(e)){return}var b=this.listeningPoint.getProvider();if(b==null){return}if(b.getSipListener()==null){return}var d=this.transactionChannel;if(d==null){if(g!=null){if(e.getStatusCode()<200||e.getStatusCode()>299){return}else{if(g.getState()=="TERMINATED"){return}else{var i=false;if(g.isAckSeen()&&g.getLastAckSent()!=null){if(g.getLastAckSent().getCSeq().getSeqNumber()==e.getCSeq().getSeqNumber()){i=true}}if(i&&e.getCSeq().getMethod()==g.getMethod()){g.resendAck();return}}}}var f=new ResponseEventExt(b,d,g,e);if(e.getCSeqHeader().getMethod()=="INVITE"){var h=this.sipStack.getForkedTransaction(e.getTransactionId());f.setOriginalTransaction(h)}b.handleEvent(f,d);return}var c=null;c=new ResponseEventExt(b,d,g,e);if(e.getCSeqHeader().getMethod()=="INVITE"){c.setOriginalTransaction(d)}if(g!=null&&e.getStatusCode()!=100){g.setLastResponse(d,e);d.setDialog(g,g.getDialogId())}b.handleEvent(c,d)};DialogFilter.prototype.getSipStack=function(){return this.sipStack};DialogFilter.prototype.sendBadRequestResponse=function(b,d,c){var e=b.createResponse(400);if(c!=null){e.setReasonPhrase(c)}var a=MessageFactoryImpl.prototype.getDefaultServerHeader();if(a!=null){e.setHeader(a)}if(b.getMethod()=="INVITE"){this.sipStack.addTransactionPendingAck(d)}d.sendResponse(e)};DialogFilter.prototype.sendCallOrTransactionDoesNotExistResponse=function(b,c){var d=b.createResponse(481);var a=MessageFactoryImpl.prototype.getDefaultServerHeader();if(a!=null){d.setHeader(a)}if(b.getMethod()=="INVITE"){this.sipStack.addTransactionPendingAck(c)}c.sendResponse(d)};DialogFilter.prototype.sendLoopDetectedResponse=function(b,c){var d=b.createResponse(482);var a=MessageFactoryImpl.prototype.getDefaultServerHeader();if(a!=null){d.setHeader(a)}this.sipStack.addTransactionPendingAck(c);c.sendResponse(d)};DialogFilter.prototype.processRequest=function(k,i){if(this.listeningPoint==null){return}var s=this.transactionChannel.getSIPStack();var c=this.listeningPoint.getProvider();if(c==null){return}var m=this.transactionChannel;var q=k.getDialogId(true);var n=s.getDialog(q);if(n!=null&&c!=n.getSipProvider()){var l=n.getMyContactHeader();if(l!=null){var b=l.getAddress().getURI();var j=b.getHost();var e=b.getPort();if(e==-1){e=5060}if(j!=null&&(j!=this.listeningPoint.getHostAddress()||e!=this.listeningPoint.getPort())){n=null}}}if(c.isAutomaticDialogSupportEnabled()&&c.isDialogErrorsAutomaticallyHandled()&&k.getToTag()==null){var r=s.findMergedTransaction(k);if(r!=null){this.sendLoopDetectedResponse(k,m);return}}if(k.getMethod()=="ACK"){if(n==null){var f=s.findTransactionPendingAck(k);if(f!=null){f.setAckSeen();s.removeTransaction(f);s.removeTransactionPendingAck(f);return}}else{if(!n.handleAck(m)){f=s.findTransactionPendingAck(k);if(f!=null){f.setAckSeen();s.removeTransaction(f);s.removeTransactionPendingAck(f)}return}else{m.passToListener();n.addTransaction(m);n.addRoute(k);m.setDialog(n,q);if(k.getMethod()=="INVITE"&&c.isDialogErrorsAutomaticallyHandled()){s.putInMergeTable(m,k)}if(s.deliverTerminatedEventForAck){s.addTransaction(m);m.scheduleAckRemoval()}else{m.setMapped(true)}}}}else{if(k.getMethod()=="BYE"){if(n!=null&&!n.isRequestConsumable(k)){if(n.getRemoteSeqNumber()>=k.getCSeq().getSeqNumber()&&m.getState()=="TRYING"){this.sendServerInternalErrorResponse(k,m)}if(m!=null){s.removeTransaction(m)}return}else{if(n==null&&c.isAutomaticDialogSupportEnabled()){var a=k.createResponse(481);a.setReasonPhrase("Dialog Not Found");m.sendResponse(a);if(m!=null){s.removeTransaction(m);m=null}return}}if(m!=null&&n!=null){if(c==n.getSipProvider()){s.addTransaction(m);n.addTransaction(m);m.setDialog(n,q)}}}else{if(k.getMethod()=="CANCEL"){var h=s.findCancelTransaction(k,true);if(k.getMethod()=="CANCEL"){if(h!=null&&h.getState()=="TERMINATED"){m.sendResponse(k.createResponse("OK"));return}}if(m!=null&&h!=null&&h.getDialog()!=null){m.setDialog(h.getDialog(),q);n=h.getDialog()}else{if(h==null&&c.isAutomaticDialogSupportEnabled()&&m!=null){a=k.createResponse(481);c.sendResponse(a);if(m!=null){s.removeTransaction(m)}return}}if(h!=null){if(m!=null){s.addTransaction(m);m.setPassToListener();m.setInviteTransaction(h)}}}else{if(k.getMethod()=="INVITE"){var g=n==null?null:n.getInviteTransaction();if(n!=null&&m!=null&&g!=null&&k.getCSeq().getSeqNumber()>g.getCSeq()&&g instanceof SIPServerTransaction&&c.isDialogErrorsAutomaticallyHandled()&&n.isSequnceNumberValidation()&&g.isInviteTransaction()&&g.getState()!="COMPLETED"&&g.getState()!="TERMINATED"&&g.getState()!="CONFIRMED"){this.sendServerInternalErrorResponse(k,m);return}g=(n==null?null:n.getLastTransaction());if(n!=null&&c.isDialogErrorsAutomaticallyHandled()&&g!=null&&g.isInviteTransaction()&&g instanceof SIPClientTransaction&&g.getLastResponse()!=null&&g.getLastResponse().getStatusCode()==200&&!n.isAckSent(g.getLastResponse().getCSeq().getSeqNumber())){return}if(n!=null&&g!=null&&c.isDialogErrorsAutomaticallyHandled()&&g.isInviteTransaction()&&g instanceof SIPServerTransaction&&!n.isAckSeen()){return}}}}}if(n!=null&&m!=null&&k.getMethod()!="BYE"&&k.getMethod()!="CANCEL"&&k.getMethod()!="ACK"){if(!n.isRequestConsumable(k)){if(Number(n.getRemoteSeqNumber())>=Number(k.getCSeq().getSeqNumber())&&c.isDialogErrorsAutomaticallyHandled()&&(m.getState()=="TRYING"||m.getState()=="PROCEEDING")){this.sendServerInternalErrorResponse(k,m)}return}try{if(c==n.getSipProvider()){s.addTransaction(m);n.addTransaction(m);n.addRoute(k);m.setDialog(n,q)}}catch(p){console.error("DialogFilter:processRequest(): catched exception:"+p);s.removeTransaction(m);return}}var d;if(m!=null){d=new RequestEvent(c,m,n,k)}else{d=new RequestEvent(c,null,n,k)}c.handleEvent(d,m)};DialogFilter.prototype.sendServerInternalErrorResponse=function(a,b){console.error("DialogFilter:sendServerInternalErrorResponse(): ",a)};DialogFilter.prototype.getProcessingInfo=function(){return null};function ListeningPointImpl(b,a){this.classname="ListeningPointImpl";this.sipStack=b;this.messageProcessor=a;this.sipProvider=null}ListeningPointImpl.prototype.makeKey=function(a,b){return(""+a+"/"+b).toLowerCase()};ListeningPointImpl.prototype.getKey=function(){return this.makeKey(this.sipStack.getHostAddress(),this.messageProcessor.getTransport())};ListeningPointImpl.prototype.setSipProvider=function(a){this.sipProvider=a};ListeningPointImpl.prototype.removeSipProvider=function(){this.sipProvider=null};ListeningPointImpl.prototype.getTransport=function(){return this.messageProcessor.getTransport()};ListeningPointImpl.prototype.getProvider=function(){return this.sipProvider};ListeningPointImpl.prototype.setSentBy=function(a){this.messageProcessor.setSentBy(a)};ListeningPointImpl.prototype.getSentBy=function(){return this.messageProcessor.getSentBy()};ListeningPointImpl.prototype.isSentBySet=function(){return this.messageProcessor.isSentBySet()};ListeningPointImpl.prototype.getViaHeader=function(){return this.messageProcessor.getViaHeader()};ListeningPointImpl.prototype.getMessageProcessor=function(){return this.messageProcessor};ListeningPointImpl.prototype.createContactHeader=function(e){try{var c=this.sipStack.getHostAddress();var f=new SipUri();f.setHost_String(c);f.setUser(e);f.setTransportParam(this.messageProcessor.getTransport());var a=new Contact();var b=new AddressImpl();b.setURI(f);a.setAddress(b);return a}catch(d){console.error("ListeningPointImpl:createContactHeader(): catched exception:"+d);return null}};ListeningPointImpl.prototype.sendHeartbeat=function(c){var a=this.messageProcessor.createMessageChannel(c);var b=new SIPRequest();b.setNullRequest();a.sendMessage(b)};ListeningPointImpl.prototype.getPort=function(){return this.messageProcessor.getPort()};ListeningPointImpl.prototype.getHostAddress=function(){return this.sipStack.getHostAddress()};function NistSipMessageFactoryImpl(a){this.classname="NistSipMessageFactoryImpl";this.sipStack=a}NistSipMessageFactoryImpl.prototype.newSIPServerRequest=function(d,c){if(c==null||d==null){console.error("NistSipMessageFactoryImpl:newSIPServerRequest(): null Arg!");throw"NistSipMessageFactoryImpl:newSIPServerRequest(): null Arg!"}var b=c.getSIPStack();var a=new DialogFilter(b);if(c instanceof SIPTransaction){a.transactionChannel=c}a.listeningPoint=c.getMessageProcessor().getListeningPoint();if(a.listeningPoint==null){return null}return a};NistSipMessageFactoryImpl.prototype.newSIPServerResponse=function(e,c){var b=c.getSIPStack();var d=b.findTransaction(e,false);if(d!=null){if(d.getState()==null){return null}else{if("COMPLETED"==d.getState()&&e.getStatusCode()/100==1){return null}}}var a=new DialogFilter(this.sipStack);a.transactionChannel=d;a.listeningPoint=c.getMessageProcessor().getListeningPoint();return a};function SipProviderImpl(a){this.classname="SipProviderImpl";this.sipListener=null;this.sipStack=null;this.listeningPoints=new Array();this.eventScanner=null;this.address=null;this.port=null;this.automaticDialogSupportEnabled=null;this.dialogErrorsAutomaticallyHandled=true;this.sipStack=a;this.eventScanner=a.getEventScanner();this.eventScanner.incrementRefcount();this.listeningPoints=new Array();this.automaticDialogSupportEnabled=this.sipStack.isAutomaticDialogSupportEnabledFunction();this.dialogErrorsAutomaticallyHandled=this.sipStack.isAutomaticDialogErrorHandlingEnabledFunction()}SipProviderImpl.prototype.getListeningPoint=function(b){for(var a=0;a<this.listeningPoints.length;a++){if(this.listeningPoints[a][0]==b.toUpperCase()){return this.listeningPoints[a][1]}}return null};SipProviderImpl.prototype.isAutomaticDialogSupportEnabled=function(){return this.automaticDialogSupportEnabled};SipProviderImpl.prototype.handleEvent=function(b,c){var a=new EventWrapper(b,c);if(!this.sipStack.reEntrantListener){this.eventScanner.addEvent(a)}else{this.eventScanner.deliverEvent(a)}};SipProviderImpl.prototype.addSipListener=function(a){if(this.sipStack.sipListener==null){this.sipStack.sipListener=a}else{if(this.sipStack.sipListener!=a){console.error("SipProviderImpl:addSipListener(): stack already has a listener. Only one listener per stack allowed");throw"SipProviderImpl:addSipListener(): stack already has a listener. Only one listener per stack allowed"}}this.sipListener=a};SipProviderImpl.prototype.setListeningPoint=function(b){if(b==null){console.error("SipProviderImpl:setListeningPoint(): null listeningPoint argument");throw"SipProviderImpl:setListeningPoint(): null listeningPoint argument "}var a=b;a.sipProvider=this;var d=a.getTransport().toUpperCase();this.address=b.getHostAddress();this.port=b.getPort();this.listeningPoints=new Array();var c=new Array();c[0]=d;c[1]=b;this.listeningPoints.push(c)};SipProviderImpl.prototype.getSipListener=function(){return this.sipListener};SipProviderImpl.prototype.stop=function(){for(var a=0;a<this.listeningPoints.length;a++){var b=this.listeningPoints[a][1];b.removeSipProvider()}this.eventScanner.stop()};SipProviderImpl.prototype.getNewCallId=function(){var b=Utils.prototype.generateCallIdentifier(this.getListeningPoint().getHostAddress());var a=new CallID();a.setCallId(b);return a};SipProviderImpl.prototype.getNewClientTransaction=function(g){if(g==null){console.error("SipProviderImpl:getNewClientTransaction(): null request argument");throw"SipProviderImpl:getNewClientTransaction(): null request argument "}if(!this.sipStack.isAlive()){console.error("SipProviderImpl:getNewClientTransaction(): stack is stopped");throw"SipProviderImpl:getNewClientTransaction(): stack is stopped"}if(g.getTransaction()!=null){console.error("SipProviderImpl:getNewClientTransaction(): transaction already assigned to request");throw"SipProviderImpl:getNewClientTransaction(): transaction already assigned to request"}if(g.getMethod()=="ACK"){console.error("SipProviderImpl:getNewClientTransaction(): cannot create client transaction for  ACK");throw"SipProviderImpl:getNewClientTransaction(): cannot create client transaction for  ACK"}var a=null;a=this.sipStack.getNextHop(g);if(a==null){console.error("SipProviderImpl:getNewClientTransaction(): cannot resolve next hop -- transaction unavailable");throw"SipProviderImpl:getNewClientTransaction(): cannot resolve next hop -- transaction unavailable"}var d=a.getTransport();if(d==null){d="WSS"}if(g.getTopmostVia()==null){var n=this.getListeningPoint(d);if(n==null){n=this.getListeningPoints()[0]}g.setHeader(n.getViaHeader())}try{g.checkHeaders()}catch(l){console.error("SipProviderImpl:getNewClientTransaction(): catched exception: "+l);throw"SipProviderImpl:getNewClientTransaction(): catched exception: "+l}var c=null;if(g.getTopmostVia().getBranch().substring(0,7)=="z9hG4bK"){c=true}else{c=false}if(g.getTopmostVia().getBranch()!=null&&c&&this.sipStack.findTransaction(g,false)!=null){console.error("SipProviderImpl:getNewClientTransaction(): transaction already exists!");throw"SipProviderImpl:getNewClientTransaction(): transaction already exists!"}if(g.getMethod().toUpperCase()=="CANCEL"){var j=this.sipStack.findCancelTransaction(g,false);if(j!=null){var b=this.sipStack.createClientTransaction(g,j.getMessageChannel());b.addEventListener(this);this.sipStack.addTransaction(b);if(j.getDialog()!=null){b.setDialog(j.getDialog(),g.getDialogId(false))}return b}}var m=g.getDialogId(false);var k=this.sipStack.getDialog(m);if(k!=null&&k.getState()=="TERMINATED"){this.sipStack.removeDialog(k)}var i=new Number(g.getCSeq().getSeqNumber());g.getCSeq().setSeqNumber(i+1);if(k!=null){k.incrementLocalSequenceNumber()}var e=null;c=null;if(g.getTopmostVia().getBranch().substring(0,7)!="z9hG4bK"){c=true}else{c=false}if(g.getTopmostVia().getBranch()==null||c||this.sipStack.checkBranchIdFunction()){e=Utils.prototype.generateBranchId();g.getTopmostVia().setBranch(e)}var h=g.getTopmostVia();if(h.getTransport()==null){h.setTransport(d)}e=g.getTopmostVia().getBranch();j=this.sipStack.createTransaction(g,this.sipStack.getChannel(),a);if(j==null){console.error("SipProviderImpl:getNewClientTransaction(): cannot create transaction");throw"SipProviderImpl:getNewClientTransaction(): cannot create transaction"}j.setNextHop(a);j.setOriginalRequest(g);j.setBranch(e);if(this.sipStack.isDialogCreated(g.getMethod())){if(k!=null){j.setDialog(k,g.getDialogId(false))}else{if(this.isAutomaticDialogSupportEnabled()){var f=this.sipStack.createDialog(j);j.setDialog(f,g.getDialogId(false))}}}else{if(k!=null){j.setDialog(k,g.getDialogId(false))}}j.addEventListener(this);return j};SipProviderImpl.prototype.getNewServerTransaction=function(f){if(!this.sipStack.isAlive()){console.error("SipProviderImpl:getNewServerTransaction(): stack is stopped");throw"SipProviderImpl:getNewServerTransaction(): stack is stopped"}var h=null;var e=f;try{e.checkHeaders()}catch(d){console.error("SipProviderImpl:getNewServerTransaction(): catched exception:"+d);throw"SipProviderImpl:getNewServerTransaction(): catched exception:"+d}if(f.getMethod()=="ACK"){console.error("SipProviderImpl:getNewServerTransaction(): cannot create Server transaction for  ACK");throw"SipProviderImpl:getNewServerTransaction(): cannot Server client transaction for  ACK"}if(e.getMethod()=="NOTIFY"&&e.getFromTag()!=null&&e.getToTag()==null){var c=this.sipStack.findSubscribeTransaction(e,this.getListeningPoint(f.getTopmostVia().getTransport()));if(c==null&&!this.sipStack.deliverUnsolicitedNotify){console.error("SipProviderImpl:getNewServerTransaction(): cannot find matching Subscription (and gov.nist.javax.sip.DELIVER_UNSOLICITED_NOTIFY not set)");throw"SipProviderImpl:getNewServerTransaction(): cannot find matching Subscription (and gov.nist.javax.sip.DELIVER_UNSOLICITED_NOTIFY not set)"}}if(this.sipStack.isDialogCreated(e.getMethod())){if(this.sipStack.findTransaction(f,true)!=null){console.error("SipProviderImpl:getNewServerTransaction(): server transaction already exists!");throw"SipProviderImpl:getNewServerTransaction(): server transaction already exists!)"}h=f.getTransaction();if(h==null){console.error("SipProviderImpl:getNewServerTransaction(): transaction not available");throw"SipProviderImpl:getNewServerTransaction(): transaction not available"}if(h.getOriginalRequest()==null){h.setOriginalRequest(e)}try{this.sipStack.addTransaction(h)}catch(d){console.error("SipProviderImpl:getNewServerTransaction(): catched exception:"+d);throw"SipProviderImpl:getNewServerTransaction(): catched exception:"+d}h.addEventListener(this);if(this.isAutomaticDialogSupportEnabled()){var a=e.getDialogId(true);var b=this.sipStack.getDialog(a);if(b==null){b=this.sipStack.createDialog(h)}h.setDialog(b,e.getDialogId(true));if(e.getMethod()=="INVITE"&&this.isDialogErrorsAutomaticallyHandled()){this.sipStack.putInMergeTable(h,e)}b.addRoute(e);if(b.getRemoteTag()!=null&&b.getLocalTag()!=null){this.sipStack.putDialog(b)}b.setInviteTransaction(h);b.setState(b.EARLY_STATE)}}else{if(this.isAutomaticDialogSupportEnabled()){h=this.sipStack.findTransaction(f,true);if(h!=null){console.error("SipProviderImpl:getNewServerTransaction(): transaction exists!");throw"SipProviderImpl:getNewServerTransaction(): transaction exists!"}h=f.getTransaction();if(h==null){console.error("SipProviderImpl:getNewServerTransaction(): transaction not available");throw"SipProviderImpl:getNewServerTransaction():transaction not available"}if(h.getOriginalRequest()==null){h.setOriginalRequest(e)}try{this.sipStack.addTransaction(h)}catch(d){console.error("SipProviderImpl:getNewServerTransaction(): catched exception:"+d);throw"SipProviderImpl:getNewServerTransaction():  catched exception:"+d}a=e.getDialogId(true);b=this.sipStack.getDialog(a);if(b!=null){b.addTransaction(h);b.addRoute(e);h.setDialog(b,e.getDialogId(true))}}else{h=this.sipStack.findTransaction(f,true);if(h!=null){console.error("SipProviderImpl:getNewServerTransaction(): transaction exists!");throw"SipProviderImpl:getNewServerTransaction(): transaction exists!"}h=f.getTransaction();if(h!=null){if(h.getOriginalRequest()==null){h.setOriginalRequest(e)}this.sipStack.mapTransaction(h);a=e.getDialogId(true);b=this.sipStack.getDialog(a);if(b!=null){b.addTransaction(h);b.addRoute(e);h.setDialog(b,e.getDialogId(true))}return h}else{var g=e.getMessageChannel();h=this.sipStack.createServerTransaction(g);if(h==null){console.error("SipProviderImpl:getNewServerTransaction(): transaction unavailable -- too many servrer transactions");throw"SipProviderImpl:getNewServerTransaction(): transaction unavailable -- too many servrer transactions"}h.setOriginalRequest(e);this.sipStack.mapTransaction(h);a=e.getDialogId(true);b=this.sipStack.getDialog(a);if(b!=null){b.addTransaction(h);b.addRoute(e);h.setDialog(b,e.getDialogId(true))}return h}}}return h};SipProviderImpl.prototype.getSipStack=function(){return this.sipStack};SipProviderImpl.prototype.removeSipListener=function(b){if(b==this.getSipListener()){this.sipListener=null}var e=false;var d=this.sipStack.getSipProviders();for(var a=0;a<d.length;a++){var c=d[a];if(c.getSipListener()!=null){e=true}}if(!e){this.sipStack.sipListener=null}};SipProviderImpl.prototype.sendRequest=function(h){if(!this.sipStack.isAlive()){console.error("SipProviderImpl:sendRequest(): stack is stopped");throw"SipProviderImpl:sendRequest(): stack is stopped"}var a=this.sipStack.getRouter(h).getNextHop(h);if(a==null){console.error("SipProviderImpl:sendRequest(): could not determine next hop!");throw"SipProviderImpl:sendRequest():  could not determine next hop!"}var g=h;if((!g.isNullRequest())&&g.getTopmostVia()==null){console.error("SipProviderImpl:sendRequest(): invalid SipRequest -- no via header!");throw"SipProviderImpl:sendRequest(): invalid SipRequest -- no via header!"}if(!g.isNullRequest()){var c=g.getTopmostVia();var e=c.getBranch();if(e==null||e.length()==0){c.setBranch(g.getTransactionId())}}var f=null;var b=null;for(var d=0;d<this.listeningPoints.length;d++){if(a.getTransport().toUpperCase()==this.listeningPoints[d][0]){b=d}}if(b!=null){b=true}else{b=false}if(b){f=this.sipStack.createRawMessageChannel()}if(f!=null){f.sendMessage(g)}else{console.error("SipProviderImpl:sendRequest(): could not create a message channel for "+a.toString());throw"SipProviderImpl:sendRequest(): could not create a message channel for "+a.toString()}};SipProviderImpl.prototype.sendResponse=function(a){if(!this.sipStack.isAlive()){console.error("SipProviderImpl:sendResponse(): stack is stopped");throw"SipProviderImpl:sendResponse(): stack is stopped"}var g=a;var c=g.getTopmostVia();if(c==null){console.error("SipProviderImpl:sendResponse(): no via header in response!");throw"SipProviderImpl:sendResponse(): no via header in response!"}var b=this.sipStack.findTransaction(a,true);if(b!=null&&b.getState()!="TERMINATED"&&this.isAutomaticDialogSupportEnabled()){console.error("SipProviderImpl:sendResponse(): transaction exists -- cannot send response statelessly");throw"SipProviderImpl:sendResponse(): transaction exists -- cannot send response statelessly"}try{var e=this.getListeningPoint();if(e==null){console.error("SipProviderImpl:sendResponse(): whoopsa daisy! no listening point found for transport "+transport);throw"SipProviderImpl:sendResponse(): whoopsa daisy! no listening point found for transport "+transport}var f=this.sipStack.getChannel();f.sendMessage(g)}catch(d){console.error("SipProviderImpl:sendResponse(): catched exception: "+d);throw"SipProviderImpl:sendResponse(): catched exception:"+d}};SipProviderImpl.prototype.getNewDialog=function(a){if(a==null){console.error("SipProviderImpl:sendResponse(): null transaction!");throw"SipProviderImpl:sendResponse():  null transaction!"}if(!this.sipStack.isAlive()){console.error("SipProviderImpl:sendResponse(): stack is stopped");throw"SipProviderImpl:sendResponse(): stack is stopped"}if(this.isAutomaticDialogSupportEnabled()){console.error("SipProviderImpl:sendResponse(): error - AUTOMATIC_DIALOG_SUPPORT is on");throw"SipProviderImpl:sendResponse(): error - AUTOMATIC_DIALOG_SUPPORT is on"}if(!this.sipStack.isDialogCreated(a.getRequest().getMethod())){console.error("SipProviderImpl:sendResponse(): dialog cannot be created for this method "+a.getRequest().getMethod());throw"SipProviderImpl:sendResponse(): dialog cannot be created for this method "+a.getRequest().getMethod()}var g=null;var d=a;if(a instanceof SIPServerTransaction){var h=a;var b=h.getLastResponse();if(b!=null){if(b.getStatusCode()!=100){console.error("SipProviderImpl:sendResponse(): cannot set dialog after response has been sent");throw"SipProviderImpl:sendResponse(): cannot set dialog after response has been sent"}}var f=a.getRequest();var i=f.getDialogId(true);g=this.sipStack.getDialog(i);if(g==null){g=this.sipStack.createDialog(a);g.addTransaction(d);g.addRoute(f);d.setDialog(g,null)}else{d.setDialog(g,f.getDialogId(true))}if(f.getMethod()=="INVITE"&&this.isDialogErrorsAutomaticallyHandled()){this.sipStack.putInMergeTable(h,f)}}else{var e=a;b=e.getLastResponse();if(b==null){var c=e.getRequest();i=c.getDialogId(false);g=this.sipStack.getDialog(i);if(g!=null){console.error("SipProviderImpl:sendResponse(): dialog already exists!");throw"SipProviderImpl:sendResponse(): dialog already exists!"}else{g=this.sipStack.createDialog(d)}e.setDialog(g,null)}else{console.error("SipProviderImpl:sendResponse(): cannot call this method after response is received!");throw"SipProviderImpl:sendResponse(): cannot call this method after response is received!"}}g.addEventListener(this);return g};SipProviderImpl.prototype.transactionErrorEvent=function(d){var h=d.getSource();if(d.getErrorID()==2){var f=d.getSource();var g="TRANSACTION";var e=null;if(f instanceof SIPServerTransaction){e=new TimeoutEvent(this,f,g)}else{var c=f;var b=c.getNextHop();e=new TimeoutEvent(this,f,g)}this.handleEvent(e,f)}else{if(d.getErrorID()==1){f=d.getSource();g="TRANSACTION";e=null;if(f instanceof SIPServerTransaction){e=new TimeoutEvent(this,f,g)}else{c=f;b=c.getNextHop();e=new TimeoutEvent(this,f,g)}this.handleEvent(e,f)}else{if(d.getErrorID()==3){f=d.getSource();var a=f;g=Timeout.RETRANSMIT;e=null;if(f instanceof SIPServerTransaction){e=new TimeoutEvent(this,f,g)}else{e=new TimeoutEvent(this,f,g)}this.handleEvent(e,f)}}}};SipProviderImpl.prototype.dialogErrorEvent=function(b){var a=b.getSource();var d="AckNotReceived";if(b.getErrorID()==2){d="AckNotSent"}else{if(b.getErrorID()==3){d="ReInviteTimeout"}}var c=new DialogTimeoutEvent(this,a,d);this.handleEvent(c,null)};SipProviderImpl.prototype.getListeningPoints=function(){var a=new Array();for(var b=0;b<this.listeningPoints.length;b++){a[b]=this.listeningPoints[b][1]}return a};SipProviderImpl.prototype.addListeningPoint=function(e){var d=e;if(d.sipProvider!=null&&d.sipProvider!=this){console.error("SipProviderImpl:addListeningPoint(): listening point assigned to another provider");throw"SipProviderImpl:addListeningPoint(): listening point assigned to another provider"}var h=d.getTransport().toUpperCase();if(this.listeningPoints.length==0){this.address=e.getHostAddress();this.port=e.getPort()}else{if((this.address!=e.getHostAddress())||this.port!=e.getPort()){console.error("SipProviderImpl:addListeningPoint(): provider already has different IP Address associated");throw"SipProviderImpl:addListeningPoint(): provider already has different IP Address associated"}}var b=null;var a=null;for(var c=0;c<this.listeningPoints.length;c++){if(h==this.listeningPoints[c][0]){b=c;a=c}}if(b!=null){b=true}else{b=false}if(a!=null){var f=this.listeningPoints[a][1]}if(b&&f!=e){console.error("SipProviderImpl:addListeningPoint(): listening point already assigned for transport!");throw"SipProviderImpl:addListeningPoint(): listening point already assigned for transport!"}d.sipProvider=this;var g=new Array();g[0]=h;g[1]=d;this.listeningPoints.push(g)};SipProviderImpl.prototype.removeListeningPoint=function(d){var c=d;var a=null;for(var b=0;b<this.listeningPoints.length;b++){if(c.getTransport().toUpperCase()==this.listeningPoints[b][0]){a=b}}this.listeningPoints.splice(a,1)};SipProviderImpl.prototype.removeListeningPoints=function(){for(var b=0;b<this.listeningPoints.length;b++){var a=this.listeningPoints[b][1];a.messageProcessor.stop()}this.listeningPoints=new Array()};SipProviderImpl.prototype.setAutomaticDialogSupportEnabled=function(a){this.automaticDialogSupportEnabled=a;if(this.automaticDialogSupportEnabled){this.dialogErrorsAutomaticallyHandled=true}};SipProviderImpl.prototype.setDialogErrorsAutomaticallyHandled=function(){this.dialogErrorsAutomaticallyHandled=true};SipProviderImpl.prototype.isDialogErrorsAutomaticallyHandled=function(){return this.dialogErrorsAutomaticallyHandled};function SipStackImpl(c,b,a){this.classname="SipStackImpl";this.stackName=null;this.serverTransactionTable=new Array();this.clientTransactionTable=new Array();this.earlyDialogTable=new Array();this.isBackToBackUserAgent=false;this.eventScanner=new EventScanner(this);this.listeningPoints=new Array();this.sipProviders=new Array();this.sipListener=null;this.setNon2XXAckPassedToListener(false);this.isAutomaticDialogSupportEnabled=true;this.isAutomaticDialogErrorHandlingEnabled=true;this.messageChannel=null;this.userAgentName=c;this.lastTransaction=null;this.reEntrantListener=true;this.setHostAddress(Utils.prototype.randomString(12)+".invalid");this.sipMessageFactory=new NistSipMessageFactoryImpl(this);this.DEFAULT_WS_TRANSPORT=a;this.defaultRouter=new DefaultRouter(this,this.stackAddress,b,a)}SipStackImpl.prototype=new SIPTransactionStack();SipStackImpl.prototype.constructor=SipStackImpl;SipStackImpl.prototype.MAX_DATAGRAM_SIZE=8*1024;SipStackImpl.prototype.DEFAULT_WS_TRANSPORT="WSS";SipStackImpl.prototype.isAutomaticDialogSupportEnabledFunction=function(){return this.isAutomaticDialogSupportEnabled};SipStackImpl.prototype.isAutomaticDialogErrorHandlingEnabledFunction=function(){return this.isAutomaticDialogErrorHandlingEnabled};SipStackImpl.prototype.getEventScanner=function(){return this.eventScanner};SipStackImpl.prototype.getSipListener=function(){return this.sipListener};SipStackImpl.prototype.createSipProvider=function(a){if(a==null){console.error("SipProviderImpl:createSipProvider(): null listeningPoint argument");throw"SipProviderImpl:createSipProvider(): null listeningPoint argument"}if(a.sipProvider!=null){console.error("SipProviderImpl:createSipProvider(): provider already attached!");throw"SipProviderImpl:createSipProvider(): provider already attached!"}var b=new SipProviderImpl(this);b.setListeningPoint(a);a.setSipProvider(b);this.sipProviders.push(b);return b};SipStackImpl.prototype.createListeningPoint=function(e){if(!this.isAlive()){this.toExit=false;this.reInitialize()}var g;if(e.toLowerCase().indexOf("ws://")==0){g="WS"}else{if(e.toLowerCase().indexOf("wss://")==0){g="WSS"}else{throw"WSMessageChannel:createWebSocket(): bad Websocket Url";console.warn("WSMessageChannel:createWebSocket(): bad Websocket Url")}}var c=ListeningPointImpl.prototype.makeKey(this.stackAddress,g);for(var b=0;b<this.listeningPoints.length;b++){if(this.listeningPoints[b]==c){return this.listeningPoints[b][1]}}var a=new WSMessageProcessor(this,e);this.addMessageProcessor(a);var d=new ListeningPointImpl(this,a);a.setListeningPoint(d);var f=new Array();f[0]=c;f[1]=d;this.listeningPoints.push(f);this.messageChannel=a.getMessageChannel();return d};SipStackImpl.prototype.reInitialize=function(){this.reInit();this.eventScanner=new EventScanner(this);this.listeningPoints=new Array();this.sipProviders=new Array();this.sipListener=null};SipStackImpl.prototype.getUserAgent=function(){return this.userAgentName};SipStackImpl.prototype.deleteListeningPoint=function(c){if(c==null){console.error("SipProviderImpl:deleteListeningPoint(): null listeningPoint arg");throw"SipProviderImpl:deleteListeningPoint(): null listeningPoint arg"}this.removeMessageProcessor(c.messageProcessor);var b=c.getKey();for(var a=0;a<this.listeningPoints.length;a++){if(this.listeningPoints[a][0]==b){this.listeningPoints.splice(a,1);break}}};SipStackImpl.prototype.deleteSipProvider=function(b){if(b==null){console.error("SipProviderImpl:deleteSipProvider(): null provider arg");throw"SipProviderImpl:deleteSipProvider(): null provider arg"}if(b.getSipListener()!=null){console.error("SipProviderImpl:deleteSipProvider(): sipProvider still has an associated SipListener!");throw"SipProviderImpl:deleteSipProvider(): sipProvider still has an associated SipListener!"}b.removeListeningPoints();b.stop();for(var a=0;a<this.sipProviders.length;a++){if(this.sipProviders[a]==b){this.sipProviders.splice(a,1);break}}if(this.sipProviders.length==0){this.stopStack()}};SipStackImpl.prototype.getListeningPoints=function(){return this.listeningPoints};SipStackImpl.prototype.getSipProviders=function(){return this.sipProviders};SipStackImpl.prototype.getStackName=function(){return this.stackName};SipStackImpl.prototype.finalize=function(){this.stopStack()};SipStackImpl.prototype.stop=function(){this.stopStack();this.sipProviders=new Array();this.listeningPoints=new Array();if(this.eventScanner!=null){this.eventScanner.forceStop()}this.eventScanner=null};SipStackImpl.prototype.start=function(){if(this.eventScanner==null){this.eventScanner=new EventScanner(this)}};SipStackImpl.prototype.getSipListener=function(){return this.sipListener};SipStackImpl.prototype.setEnabledCipherSuites=function(a){this.cipherSuites=a};SipStackImpl.prototype.getEnabledCipherSuites=function(){return this.cipherSuites};SipStackImpl.prototype.setEnabledProtocols=function(a){this.enabledProtocols=a};SipStackImpl.prototype.getEnabledProtocols=function(){return this.enabledProtocols};SipStackImpl.prototype.setIsBackToBackUserAgent=function(a){this.isBackToBackUserAgent=a};SipStackImpl.prototype.isBackToBackUserAgent=function(){return this.isBackToBackUserAgent};SipStackImpl.prototype.isAutomaticDialogErrorHandlingEnabled=function(){return this.isAutomaticDialogErrorHandlingEnabled};SipStackImpl.prototype.getChannel=function(){return this.messageChannel};SipStackImpl.prototype.newSIPServerRequest=function(f,a){var g=null;var h=null;var j=f.getTransactionId();f.setMessageChannel(a);var d=null;for(var e=0;e<this.serverTransactionTable.length;e++){if(this.serverTransactionTable[e][0]==j){d=e}}if(d!=null){h=this.serverTransactionTable[d][1]}if(h==null||!h.isMessagePartOfTransaction(f)){h=null;var b=this.BRANCH_MAGIC_COOKIE_LOWER_CASE.length;var c=j.toLowerCase().substr(0,b-1);if(c!=this.BRANCH_MAGIC_COOKIE_LOWER_CASE){for(e=0;(e<this.serverTransactionTable.length)&&(h==null);e++){g=this.serverTransactionTable[e][1];if(g.isMessagePartOfTransaction(f)){h=g}}}if(h==null){h=this.findPendingTransaction(f);if(h!=null){f.setTransaction(h);if(h!=null){return h}else{return null}}h=this.createServerTransaction(a);h.setOriginalRequest(f);f.setTransaction(h);if(f.getMethod()!="ACK"){h=a.messageProcessor.listeningPoint.sipProvider.getNewServerTransaction(f)}}}if(h!=null){h.setRequestInterface(this.sipMessageFactory.newSIPServerRequest(f,h))}if(f.getMethod()=="ACK"){h=this.lastTransaction}else{this.lastTransaction=h}return h};SipStackImpl.prototype.newSIPServerResponse=function(c,j){var f=null;var g=null;var k=c.getTransactionId();var d=null;for(var e=0;e<this.clientTransactionTable.length;e++){if(this.clientTransactionTable[e][0]==k){d=e}}if(d!=null){g=this.clientTransactionTable[d][1]}var a=this.BRANCH_MAGIC_COOKIE_LOWER_CASE.length;var b=k.toLowerCase().substr(0,a-1);if(g==null||(!g.isMessagePartOfTransaction(c)&&b!=this.BRANCH_MAGIC_COOKIE_LOWER_CASE)){for(e=0;(e<this.clientTransactionTable.length)&&(g==null);e++){f=this.clientTransactionTable[e][1];if(f.isMessagePartOfTransaction(c)){g=f}}if(g==null){return this.sipMessageFactory.newSIPServerResponse(c,j)}}var h=this.sipMessageFactory.newSIPServerResponse(c,g);if(h!=null){g.setResponseInterface(h)}else{return null}return g};SipStackImpl.prototype.createServerTransaction=function(a){return new SIPServerTransaction(this,a)};SipStackImpl.prototype.removeTransaction=function(f){if(f instanceof SIPServerTransaction){var c=f.getTransactionId();var g=null;var a=null;for(var b=0;b<this.serverTransactionTable.length;b++){if(c==this.serverTransactionTable[b]){a=b;g=this.serverTransactionTable[b][1]}}this.serverTransactionTable.splice(a,1);var h=f.getMethod();this.removePendingTransaction(f);this.removeTransactionPendingAck(f);if(h.toUpperCase()=="INVITE"){this.removeFromMergeTable(f)}var e=f.getSipProvider();if(g!=null&&f.testAndSetTransactionTerminatedEvent()){var d=new TransactionTerminatedEvent(e,f);e.handleEvent(d,f)}}else{c=f.getTransactionId();var a=null;for(var b=0;b<this.clientTransactionTable.length;b++){if(this.clientTransactionTable[b][0]==c){a=b}}if(a!=null){g=this.clientTransactionTable[a][1];this.clientTransactionTable.splice(a,1)}if(g!=null&&f.testAndSetTransactionTerminatedEvent()){e=f.getSipProvider();d=new TransactionTerminatedEvent(e,f);e.handleEvent(d,f)}}};function SipListener(){}SipListener.prototype.processDialogTerminated=function(a){};SipListener.prototype.processIOException=function(a){};SipListener.prototype.processRequest=function(a){};SipListener.prototype.processResponse=function(a){};SipListener.prototype.processTimeout=function(a){};SipListener.prototype.processTransactionTerminated=function(a){};SipListener.prototype.processConnected=function(){};SipListener.prototype.processDisconnected=function(){};SipListener.prototype.processConnectionError=function(){};function SipFactory(){this.classname="SipFactory"}SipFactory.prototype.createSipStack=function(b,d,c){try{return new SipStackImpl(b,d,c)}catch(a){console.error("SipFactory:createAddressFactory(): failed to create SipStackImpl");throw"SipFactory:createAddressFactory(): failed to create SipStackImpl"}};SipFactory.prototype.createAddressFactory=function(){try{return new AddressFactoryImpl()}catch(a){console.error("SipFactory:createAddressFactory(): failed to create AddressFactory");throw"SipFactory:createAddressFactory(): failed to create AddressFactory"}};SipFactory.prototype.createHeaderFactory=function(){try{return new HeaderFactoryImpl()}catch(a){console.error("SipFactory:createHeaderFactory(): failed to create HeaderFactory");throw"SipFactory:createHeaderFactory(): failed to create HeaderFactory"}};SipFactory.prototype.createMessageFactory=function(){try{return new MessageFactoryImpl()}catch(a){console.error("SipFactory:createMessageFactory(): failed to create MessageFactory");throw"SipFactory:createMessageFactory():failed to create MessageFactory"}};